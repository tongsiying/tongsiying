<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/hedgehog.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/hedgehog.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tongsiying.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","b2t":true,"scrollpercent":true,"padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="article">
<meta property="og:title" content="001-Linux前世今生">
<meta property="og:url" content="https://tongsiying.github.io/2022/05/17/linux/Linux/index.html">
<meta property="og:site_name" content="tongsiying">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://camo.githubusercontent.com/c34cfd7b6eb5a2d59b77833a3474706167f20c18554172d87df7b23dc5b18bd0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f696d6167652d32303139313230393030323831383632362e706e67">
<meta property="og:image" content="https://camo.githubusercontent.com/583a9fa22ad7bd7e6363bb5d0ee6e3d8855bf9e9f621fb7770b048d846a1e0b0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f39323439313463302d363630632d346534612d626263302d3164663131343665373531362e6a7067">
<meta property="og:image" content="https://camo.githubusercontent.com/ef731735c863748c05564618e14cb889be527e3ddde5f354b046626b928a2351/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66396632613136622d343834332d343464312d393735392d6337343537373265396263662e6a7067">
<meta property="og:image" content="https://camo.githubusercontent.com/7410f2df371abf5e7110b78e54344180cb06fe9411f39d053a07e0160cb37c77/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66303537343032352d633531342d343966352d613539312d3664366137316632373166372e6a7067">
<meta property="og:image" content="https://camo.githubusercontent.com/3abaffd665a4b9e910bb7b6cec8b47ddfd8d814b6bff0a8a1fd69eeb26fe6de7/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36373239626161302d353764372d343831372d623361612d3531386362636366383234632e6a7067">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584948682984-1585553407634.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584948967541-1585553611037.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584948981764-1585553611038.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584948995283-1585553611038.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584949016403-1585553611038.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584949025247-1585553611038.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/847059-20170708180732940-2132354928.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584950864092-1585551848364.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584950877483-1585551867171.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584950901855-1585551881417.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584950916178-1585551894581.png">
<meta property="og:image" content="https://tongsiying.github.io/2022/05/17/linux/Linux/Linux%5C1584950933865-1585551912922.png">
<meta property="og:image" content="https://camo.githubusercontent.com/67df9e7198b4078778b3d9d782bae2b104c626d8c9898587ee638c21859d7fbb/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f475549445f506172746974696f6e5f5461626c655f536368656d652e7376672e706e67">
<meta property="og:image" content="https://camo.githubusercontent.com/b84becd8165f5cca61ae77ad3319a3e19abe5ddb4a771ea7903027a3fc86763d/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f35303833316136662d323737372d343665612d613537312d3239663233633835636332312e6a7067">
<meta property="og:image" content="https://camo.githubusercontent.com/f2aa270d96a0bb98df4393e2abe4214a318ff444033f1c5a062bc75a3426a430/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66393030663236362d613332332d343262322d626334332d3231386664623838313161382e6a7067">
<meta property="og:image" content="https://camo.githubusercontent.com/c6f99088c61435a2a5a3736e501a3333c52eb5e584bdd7be466ec633202f7999/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f4253445f6469736b2e706e67">
<meta property="og:image" content="https://camo.githubusercontent.com/5ea44f61c614c1fc9253d0229d364bbdb3345194bde7860c1d07554d355921f1/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31326136356363362d323065302d343730362d396665362d3362613439343133643766362e706e67">
<meta property="og:image" content="https://camo.githubusercontent.com/f4a1c1c15682fed01e0a3e8be8f592e4fce14c2d270a2a1429453b86e5195080/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f35623731386538362d373130322d346262362d386361352d6431646437393135333063352e706e67">
<meta property="og:image" content="https://camo.githubusercontent.com/36335e16eb28652bb66ca46edba6040f1bcfcabce0b3fbcdf1d18111ffc52b28/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f696e6f64655f776974685f7369676e6174757265732e6a7067">
<meta property="og:image" content="https://camo.githubusercontent.com/c89a9597946ed0c7f045dd31df0ee669d2851e73f9d502f37c4694192dc7d1f8/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f6c696e75782d66696c6573797374656d2e706e67">
<meta property="og:image" content="https://camo.githubusercontent.com/2b0c839d61700c8ef2caf3190cb6d42e66a1277b266f695190cecc9a244034e2/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31653436666430332d306364612d346436302d396231632d3063323536656461663662322e706e67">
<meta property="og:image" content="https://camo.githubusercontent.com/317f225c0a18a9fd9d62ebaa0279b2377f8a1030aa562ef6132d474db8cf7506/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36353866633565372d373963302d343234372d393434352d6436396266313934633533392e706e67">
<meta property="og:image" content="https://camo.githubusercontent.com/ae6622fbe9bed2d92a67e2cac0bbcb86fcf5e015a789aab89faf6b5e0fdb41e5/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f32626162343132372d336537642d343863632d393134652d3433366265383539666230352e706e67">
<meta property="article:published_time" content="2022-05-17T10:37:19.000Z">
<meta property="article:modified_time" content="2022-03-22T12:03:17.468Z">
<meta property="article:author" content="tongsiying">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://camo.githubusercontent.com/c34cfd7b6eb5a2d59b77833a3474706167f20c18554172d87df7b23dc5b18bd0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f696d6167652d32303139313230393030323831383632362e706e67">

<link rel="canonical" href="https://tongsiying.github.io/2022/05/17/linux/Linux/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>001-Linux前世今生 | tongsiying</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
<!-- 加入APlayer音乐播放器 -->
<link rel="stylesheet" href="/dist/APlayer.min.css">
<div id="aplayer"></div>
<script type="text/javascript" src="/dist/APlayer.min.js"></script>
<script type="text/javascript" src="/dist/music.js"></script>
  <div class="container use-motion">
    <div class="headband"></div>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

	<!-- catalog/ -->
	<!--     <a href="/" class="brand" rel="start"> -->
	
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">tongsiying</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">阅读|运动|自律</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tongsiying.github.io/2022/05/17/linux/Linux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/gutianle.gif">
      <meta itemprop="name" content="tongsiying">
      <meta itemprop="description" content="问渠那得清如许？为有源头活水来。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tongsiying">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          001-Linux前世今生
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-17 18:37:19" itemprop="dateCreated datePublished" datetime="2022-05-17T18:37:19+08:00">2022-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-22 20:03:17" itemprop="dateModified" datetime="2022-03-22T20:03:17+08:00">2022-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>81k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:14</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p class="description"></p>
<a id="more"></a>

<h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><ul>
<li>Linux<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#前言" target="_blank" rel="noopener external nofollow noreferrer">前言</a></li>
<li>一、常用操作以及概念<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#快捷键" target="_blank" rel="noopener external nofollow noreferrer">快捷键</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#求助" target="_blank" rel="noopener external nofollow noreferrer">求助</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#关机" target="_blank" rel="noopener external nofollow noreferrer">关机</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#path" target="_blank" rel="noopener external nofollow noreferrer">PATH</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#sudo" target="_blank" rel="noopener external nofollow noreferrer">sudo</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#包管理工具" target="_blank" rel="noopener external nofollow noreferrer">包管理工具</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#发行版" target="_blank" rel="noopener external nofollow noreferrer">发行版</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#vim-三个模式" target="_blank" rel="noopener external nofollow noreferrer">VIM 三个模式</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#gnu" target="_blank" rel="noopener external nofollow noreferrer">GNU</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#开源协议" target="_blank" rel="noopener external nofollow noreferrer">开源协议</a></li>
</ul>
</li>
<li>二、磁盘<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#磁盘接口" target="_blank" rel="noopener external nofollow noreferrer">磁盘接口</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#磁盘的文件名" target="_blank" rel="noopener external nofollow noreferrer">磁盘的文件名</a></li>
</ul>
</li>
<li>三、分区<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#分区表" target="_blank" rel="noopener external nofollow noreferrer">分区表</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#开机检测程序" target="_blank" rel="noopener external nofollow noreferrer">开机检测程序</a></li>
</ul>
</li>
<li>四、文件系统<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#分区与文件系统" target="_blank" rel="noopener external nofollow noreferrer">分区与文件系统</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#组成" target="_blank" rel="noopener external nofollow noreferrer">组成</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#文件读取" target="_blank" rel="noopener external nofollow noreferrer">文件读取</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#磁盘碎片" target="_blank" rel="noopener external nofollow noreferrer">磁盘碎片</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#block" target="_blank" rel="noopener external nofollow noreferrer">block</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#inode" target="_blank" rel="noopener external nofollow noreferrer">inode</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#目录" target="_blank" rel="noopener external nofollow noreferrer">目录</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#日志" target="_blank" rel="noopener external nofollow noreferrer">日志</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#挂载" target="_blank" rel="noopener external nofollow noreferrer">挂载</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#目录配置" target="_blank" rel="noopener external nofollow noreferrer">目录配置</a></li>
</ul>
</li>
<li>五、文件<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#文件属性" target="_blank" rel="noopener external nofollow noreferrer">文件属性</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#文件与目录的基本操作" target="_blank" rel="noopener external nofollow noreferrer">文件与目录的基本操作</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#修改权限" target="_blank" rel="noopener external nofollow noreferrer">修改权限</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#默认权限" target="_blank" rel="noopener external nofollow noreferrer">默认权限</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#目录的权限" target="_blank" rel="noopener external nofollow noreferrer">目录的权限</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#链接" target="_blank" rel="noopener external nofollow noreferrer">链接</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#获取文件内容" target="_blank" rel="noopener external nofollow noreferrer">获取文件内容</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#指令与文件搜索" target="_blank" rel="noopener external nofollow noreferrer">指令与文件搜索</a></li>
</ul>
</li>
<li>六、压缩与打包<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#压缩文件名" target="_blank" rel="noopener external nofollow noreferrer">压缩文件名</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#压缩指令" target="_blank" rel="noopener external nofollow noreferrer">压缩指令</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#打包" target="_blank" rel="noopener external nofollow noreferrer">打包</a></li>
</ul>
</li>
<li>七、Bash<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#特性" target="_blank" rel="noopener external nofollow noreferrer">特性</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#变量操作" target="_blank" rel="noopener external nofollow noreferrer">变量操作</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#指令搜索顺序" target="_blank" rel="noopener external nofollow noreferrer">指令搜索顺序</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#数据流重定向" target="_blank" rel="noopener external nofollow noreferrer">数据流重定向</a></li>
</ul>
</li>
<li>八、管道指令<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#提取指令" target="_blank" rel="noopener external nofollow noreferrer">提取指令</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#排序指令" target="_blank" rel="noopener external nofollow noreferrer">排序指令</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#双向输出重定向" target="_blank" rel="noopener external nofollow noreferrer">双向输出重定向</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#字符转换指令" target="_blank" rel="noopener external nofollow noreferrer">字符转换指令</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#分区指令" target="_blank" rel="noopener external nofollow noreferrer">分区指令</a></li>
</ul>
</li>
<li>九、正则表达式<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#grep" target="_blank" rel="noopener external nofollow noreferrer">grep</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#printf" target="_blank" rel="noopener external nofollow noreferrer">printf</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#awk" target="_blank" rel="noopener external nofollow noreferrer">awk</a></li>
</ul>
</li>
<li>十、进程管理<ul>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#查看进程" target="_blank" rel="noopener external nofollow noreferrer">查看进程</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#进程状态" target="_blank" rel="noopener external nofollow noreferrer">进程状态</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#sigchld" target="_blank" rel="noopener external nofollow noreferrer">SIGCHLD</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#wait" target="_blank" rel="noopener external nofollow noreferrer">wait()</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#waitpid" target="_blank" rel="noopener external nofollow noreferrer">waitpid()</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#孤儿进程" target="_blank" rel="noopener external nofollow noreferrer">孤儿进程</a></li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#僵尸进程" target="_blank" rel="noopener external nofollow noreferrer">僵尸进程</a></li>
</ul>
</li>
<li><a href="https://github.com/CyC2018/CS-Notes/blob/master/notes/Linux.md#参考资料" target="_blank" rel="noopener external nofollow noreferrer">参考资料</a></li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>为了便于理解，本文从常用操作和概念开始讲起。虽然已经尽量做到简化，但是涉及到的内容还是有点多。在面试中，Linux 知识点相对于网络和操作系统等知识点而言不是那么重要，只需要重点掌握一些原理和命令即可。为了方便大家准备面试，在此先将一些比较重要的知识点列出来：</p>
<ul>
<li><p>能简单使用 cat，grep，cut 等命令进行一些操作；</p>
</li>
<li><p>文件系统相关的原理，inode 和 block 等概念，数据恢复；</p>
</li>
<li><p>硬链接与软链接；</p>
</li>
<li><p>进程管理相关，僵尸进程与孤儿进程，SIGCHLD 。</p>
</li>
</ul>
<h2 id="一、常用操作以及概念"><a href="#一、常用操作以及概念" class="headerlink" title="一、常用操作以及概念"></a>一、常用操作以及概念</h2><h3 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h3><ul>
<li>Tab：命令和文件名补全；</li>
<li>Ctrl+C：中断正在运行的程序；</li>
<li>Ctrl+D：结束键盘输入（End Of File，EOF）</li>
</ul>
<h3 id="求助"><a href="#求助" class="headerlink" title="求助"></a>求助</h3><h4 id="1-–help"><a href="#1-–help" class="headerlink" title="1. –help"></a>1. –help</h4><p>指令的基本用法与选项介绍。</p>
<h4 id="2-man"><a href="#2-man" class="headerlink" title="2. man"></a>2. man</h4><p>man 是 manual 的缩写，将指令的具体信息显示出来。</p>
<p>当执行 <code>man date</code> 时，有 DATE(1) 出现，其中的数字代表指令的类型，常用的数字及其类型如下：</p>
<table>
<thead>
<tr>
<th>代号</th>
<th>类型</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>用户在 shell 环境中可以操作的指令或者可执行文件</td>
</tr>
<tr>
<td>5</td>
<td>配置文件</td>
</tr>
<tr>
<td>8</td>
<td>系统管理员可以使用的管理指令</td>
</tr>
</tbody></table>
<h4 id="3-info"><a href="#3-info" class="headerlink" title="3. info"></a>3. info</h4><p>info 与 man 类似，但是 info 将文档分成一个个页面，每个页面可以跳转。</p>
<h4 id="4-doc"><a href="#4-doc" class="headerlink" title="4. doc"></a>4. doc</h4><p>/usr/share/doc 存放着软件的一整套说明文件。</p>
<h3 id="关机"><a href="#关机" class="headerlink" title="关机"></a>关机</h3><h4 id="1-who"><a href="#1-who" class="headerlink" title="1. who"></a>1. who</h4><p>在关机前需要先使用 who 命令查看有没有其它用户在线。</p>
<h4 id="2-sync"><a href="#2-sync" class="headerlink" title="2. sync"></a>2. sync</h4><p>为了加快对磁盘文件的读写速度，位于内存中的文件数据不会立即同步到磁盘，因此关机之前需要先进行 sync 同步操作。</p>
<h4 id="3-shutdown"><a href="#3-shutdown" class="headerlink" title="3. shutdown"></a>3. shutdown</h4><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## shutdown [-krhc] 时间 [信息]</span></span><br><span class="line"><span class="literal">-k ： 不会关机，只是发送警告信息，通知所有在线的用户</span></span><br><span class="line"><span class="literal">-r ： 将系统的服务停掉后就重新启动</span></span><br><span class="line"><span class="literal">-h ： 将系统的服务停掉后就立即关机</span></span><br><span class="line"><span class="literal">-c ： 取消已经在进行的 shutdown</span></span><br></pre></td></tr></table></figure>

<h3 id="PATH"><a href="#PATH" class="headerlink" title="PATH"></a>PATH</h3><p>可以在环境变量 PATH 中声明可执行文件的路径，路径之间用 : 分隔。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/bin:/</span>usr<span class="regexp">/bin:/</span>usr<span class="regexp">/local/</span><span class="string">sbin:</span><span class="regexp">/usr/</span><span class="string">sbin:</span><span class="regexp">/home/</span>dmtsai<span class="regexp">/.local/</span><span class="string">bin:</span><span class="regexp">/home/</span>dmtsai/bin</span><br></pre></td></tr></table></figure>

<h3 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h3><p>sudo 允许一般用户使用 root 可执行的命令，不过只有在 /etc/sudoers 配置文件中添加的用户才能使用该指令。</p>
<h3 id="包管理工具"><a href="#包管理工具" class="headerlink" title="包管理工具"></a>包管理工具</h3><p>RPM 和 DPKG 为最常见的两类软件包管理工具：</p>
<ul>
<li>RPM 全称为 Redhat Package Manager，最早由 Red Hat 公司制定实施，随后被 GNU 开源操作系统接受并成为许多 Linux 系统的既定软件标准。YUM 基于 RPM，具有依赖管理和软件升级功能。</li>
<li>与 RPM 竞争的是基于 Debian 操作系统的 DEB 软件包管理工具 DPKG，全称为 Debian Package，功能方面与 RPM 相似。</li>
</ul>
<h3 id="发行版"><a href="#发行版" class="headerlink" title="发行版"></a>发行版</h3><p>Linux 发行版是 Linux 内核及各种应用软件的集成版本。</p>
<table>
<thead>
<tr>
<th>基于的包管理工具</th>
<th>商业发行版</th>
<th>社区发行版</th>
</tr>
</thead>
<tbody><tr>
<td>RPM</td>
<td>Red Hat</td>
<td>Fedora / CentOS</td>
</tr>
<tr>
<td>DPKG</td>
<td>Ubuntu</td>
<td>Debian</td>
</tr>
</tbody></table>
<h3 id="VIM-三个模式"><a href="#VIM-三个模式" class="headerlink" title="VIM 三个模式"></a>VIM 三个模式</h3><p><a href="https://camo.githubusercontent.com/c34cfd7b6eb5a2d59b77833a3474706167f20c18554172d87df7b23dc5b18bd0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f696d6167652d32303139313230393030323831383632362e706e67" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/c34cfd7b6eb5a2d59b77833a3474706167f20c18554172d87df7b23dc5b18bd0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f696d6167652d32303139313230393030323831383632362e706e67" alt="img"></a></p>
<ul>
<li>一般指令模式（Command mode）：VIM 的默认模式，可以用于移动游标查看内容；</li>
<li>编辑模式（Insert mode）：按下 “i” 等按键之后进入，可以对文本进行编辑；</li>
<li>指令列模式（Bottom-line mode）：按下 “:” 按键之后进入，用于保存退出等操作。</li>
</ul>
<p>在指令列模式下，有以下命令用于离开或者保存文件。</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>:w</td>
<td>写入磁盘</td>
</tr>
<tr>
<td>:w!</td>
<td>当文件为只读时，强制写入磁盘。到底能不能写入，与用户对该文件的权限有关</td>
</tr>
<tr>
<td>:q</td>
<td>离开</td>
</tr>
<tr>
<td>:q!</td>
<td>强制离开不保存</td>
</tr>
<tr>
<td>:wq</td>
<td>写入磁盘后离开</td>
</tr>
<tr>
<td>:wq!</td>
<td>强制写入磁盘后离开</td>
</tr>
</tbody></table>
<h3 id="GNU"><a href="#GNU" class="headerlink" title="GNU"></a>GNU</h3><p>GNU 计划，译为革奴计划，它的目标是创建一套完全自由的操作系统，称为 GNU，其内容软件完全以 GPL 方式发布。其中 GPL 全称为 GNU 通用公共许可协议（GNU General Public License），包含了以下内容：</p>
<ul>
<li>以任何目的运行此程序的自由；</li>
<li>再复制的自由；</li>
<li>改进此程序，并公开发布改进的自由。</li>
</ul>
<h3 id="开源协议"><a href="#开源协议" class="headerlink" title="开源协议"></a>开源协议</h3><ul>
<li><a href="https://choosealicense.com/" target="_blank" rel="noopener external nofollow noreferrer">Choose an open source license</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2011/05/how_to_choose_free_software_licenses.html" target="_blank" rel="noopener external nofollow noreferrer">如何选择开源许可证？</a></li>
</ul>
<h2 id="二、磁盘"><a href="#二、磁盘" class="headerlink" title="二、磁盘"></a>二、磁盘</h2><h3 id="磁盘接口"><a href="#磁盘接口" class="headerlink" title="磁盘接口"></a>磁盘接口</h3><h4 id="1-IDE"><a href="#1-IDE" class="headerlink" title="1. IDE"></a>1. IDE</h4><p>IDE（ATA）全称 Advanced Technology Attachment，接口速度最大为 133MB/s，因为并口线的抗干扰性太差，且排线占用空间较大，不利电脑内部散热，已逐渐被 SATA 所取代。</p>
<p><a href="https://camo.githubusercontent.com/583a9fa22ad7bd7e6363bb5d0ee6e3d8855bf9e9f621fb7770b048d846a1e0b0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f39323439313463302d363630632d346534612d626263302d3164663131343665373531362e6a7067" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/583a9fa22ad7bd7e6363bb5d0ee6e3d8855bf9e9f621fb7770b048d846a1e0b0/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f39323439313463302d363630632d346534612d626263302d3164663131343665373531362e6a7067" alt="img"></a></p>
<h4 id="2-SATA"><a href="#2-SATA" class="headerlink" title="2. SATA"></a>2. SATA</h4><p>SATA 全称 Serial ATA，也就是使用串口的 ATA 接口，抗干扰性强，且对数据线的长度要求比 ATA 低很多，支持热插拔等功能。SATA-II 的接口速度为 300MB/s，而 SATA-III 标准可达到 600MB/s 的传输速度。SATA 的数据线也比 ATA 的细得多，有利于机箱内的空气流通，整理线材也比较方便。</p>
<p><a href="https://camo.githubusercontent.com/ef731735c863748c05564618e14cb889be527e3ddde5f354b046626b928a2351/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66396632613136622d343834332d343464312d393735392d6337343537373265396263662e6a7067" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/ef731735c863748c05564618e14cb889be527e3ddde5f354b046626b928a2351/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66396632613136622d343834332d343464312d393735392d6337343537373265396263662e6a7067" alt="img"></a></p>
<h4 id="3-SCSI"><a href="#3-SCSI" class="headerlink" title="3. SCSI"></a>3. SCSI</h4><p>SCSI 全称是 Small Computer System Interface（小型机系统接口），SCSI 硬盘广为工作站以及个人电脑以及服务器所使用，因此会使用较为先进的技术，如碟片转速 15000rpm 的高转速，且传输时 CPU 占用率较低，但是单价也比相同容量的 ATA 及 SATA 硬盘更加昂贵。</p>
<p><a href="https://camo.githubusercontent.com/7410f2df371abf5e7110b78e54344180cb06fe9411f39d053a07e0160cb37c77/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66303537343032352d633531342d343966352d613539312d3664366137316632373166372e6a7067" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/7410f2df371abf5e7110b78e54344180cb06fe9411f39d053a07e0160cb37c77/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66303537343032352d633531342d343966352d613539312d3664366137316632373166372e6a7067" alt="img"></a></p>
<h4 id="4-SAS"><a href="#4-SAS" class="headerlink" title="4. SAS"></a>4. SAS</h4><p>SAS（Serial Attached SCSI）是新一代的 SCSI 技术，和 SATA 硬盘相同，都是采取序列式技术以获得更高的传输速度，可达到 6Gb/s。此外也通过缩小连接线改善系统内部空间等。</p>
<p><a href="https://camo.githubusercontent.com/3abaffd665a4b9e910bb7b6cec8b47ddfd8d814b6bff0a8a1fd69eeb26fe6de7/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36373239626161302d353764372d343831372d623361612d3531386362636366383234632e6a7067" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/3abaffd665a4b9e910bb7b6cec8b47ddfd8d814b6bff0a8a1fd69eeb26fe6de7/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36373239626161302d353764372d343831372d623361612d3531386362636366383234632e6a7067" alt="img"></a></p>
<h3 id="磁盘的文件名"><a href="#磁盘的文件名" class="headerlink" title="磁盘的文件名"></a>磁盘的文件名</h3><p>Linux 中每个硬件都被当做一个文件，包括磁盘。磁盘以磁盘接口类型进行命名，常见磁盘的文件名如下：</p>
<ul>
<li>IDE 磁盘：/dev/hd[a-d]</li>
<li>SATA/SCSI/SAS 磁盘：/dev/sd[a-p]</li>
</ul>
<p>其中文件名后面的序号的确定与系统检测到磁盘的顺序有关，而与磁盘所插入的插槽位置无关。</p>
<h3 id="查看磁盘分区UUID的四种方法"><a href="#查看磁盘分区UUID的四种方法" class="headerlink" title="查看磁盘分区UUID的四种方法"></a>查看磁盘分区UUID的四种方法</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1、使用/dev/disk/by-uuid目录</span><br><span class="line">[root@server ~]# ls -l /dev/disk/by-uuid</span><br><span class="line">总用量 0</span><br><span class="line">lrwxrwxrwx. 1 root root 10 8月 19 00:45 bec50c5d-090c-47ad-83d5-25328b4ab7ec -&gt; <span class="built_in">..</span>/<span class="built_in">..</span>/sda1</span><br><span class="line"></span><br><span class="line">2、使用blkid命令</span><br><span class="line">[root@<span class="built_in"> server </span>~]# blkid -s UUID /dev/sda1</span><br><span class="line">/dev/sda1: <span class="attribute">UUID</span>=<span class="string">"bec50c5d-090c-47ad-83d5-25328b4ab7ec"</span></span><br><span class="line"></span><br><span class="line">3、使用tune2fs命令</span><br><span class="line">[root@<span class="built_in"> server </span>~]# tune2fs -l /dev/sda1 |grep <span class="string">'UUID'</span></span><br><span class="line">Filesystem UUID: bec50c5d-090c-47ad-83d5-25328b4ab7ec</span><br><span class="line"></span><br><span class="line">4、使用dumpe2fs命令</span><br><span class="line">[root@<span class="built_in"> server </span>~]# dumpe2fs /dev/sda1 |grep <span class="string">'UUID'</span></span><br><span class="line">dumpe2fs 1.41.12 (17-May-2010)</span><br><span class="line">Filesystem UUID: bec50c5d-090c-47ad-83d5-25328b4ab7ec</span><br></pre></td></tr></table></figure>

<h3 id="如何关闭硬盘写缓存（Write-Cache）"><a href="#如何关闭硬盘写缓存（Write-Cache）" class="headerlink" title="如何关闭硬盘写缓存（Write Cache）"></a>如何关闭硬盘写缓存（Write Cache）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">http://ilinuxkernel.com/?p=897</span><br><span class="line">如何关闭硬盘写缓存（Write <span class="keyword">Cache</span>）</span><br><span class="line">AUG17</span><br><span class="line"><span class="number">2011</span> <span class="number">1</span> <span class="keyword">COMMENT</span> WRITTEN <span class="keyword">BY</span> CHEN</span><br><span class="line">在Linux中，有时我们希望打开或关闭硬盘写缓存（Write <span class="keyword">Cache</span>），此时可以用hdparm命令来实现。</span><br><span class="line"></span><br><span class="line">建议下载最新hdparm版本，网址为：</span><br><span class="line"><span class="keyword">http</span>://sourceforge.net/projects/hdparm/</span><br><span class="line"></span><br><span class="line">查看当前硬盘写<span class="keyword">Cache</span>状态</span><br><span class="line">root@ubuntu:~/hdparm<span class="number">-9.37</span><span class="comment"># hdparm -W  /dev/sda</span></span><br><span class="line"></span><br><span class="line">关闭硬盘的写<span class="keyword">Cache</span></span><br><span class="line">root@ubuntu:~/hdparm<span class="number">-9.37</span><span class="comment"># hdparm -W  0 /dev/sda</span></span><br><span class="line"></span><br><span class="line">打开硬盘的写<span class="keyword">Cache</span></span><br><span class="line">root@ubuntu:~/hdparm<span class="number">-9.37</span><span class="comment"># hdparm -W  1 /dev/sda</span></span><br><span class="line"></span><br><span class="line">hdparm其他参数详细说明如下：</span><br><span class="line">root@ubuntu:~/hdparm<span class="number">-9.37</span><span class="comment"># ./hdparm -h</span></span><br><span class="line">hdparm – <span class="keyword">get</span>/<span class="keyword">set</span> hard disk <span class="keyword">parameters</span> – <span class="keyword">version</span> v9<span class="number">.37</span>, <span class="keyword">by</span> Mark Lord.</span><br><span class="line"><span class="keyword">Usage</span>:  hdparm  [options] [device …]</span><br><span class="line">Options:</span><br><span class="line"> -a   <span class="keyword">Get</span>/<span class="keyword">set</span> fs readahead</span><br><span class="line"> -A   <span class="keyword">Get</span>/<span class="keyword">set</span> the drive look-ahead flag (<span class="number">0</span>/<span class="number">1</span>)</span><br><span class="line"> -b   <span class="keyword">Get</span>/<span class="keyword">set</span> bus state (<span class="number">0</span> == <span class="keyword">off</span>, <span class="number">1</span> == <span class="keyword">on</span>, <span class="number">2</span> == tristate)</span><br><span class="line"> -B   <span class="keyword">Set</span> <span class="keyword">Advanced</span> <span class="keyword">Power</span> <span class="keyword">Management</span> setting (<span class="number">1</span><span class="number">-255</span>)</span><br><span class="line"> -c   <span class="keyword">Get</span>/<span class="keyword">set</span> IDE <span class="number">32</span>-<span class="built_in">bit</span> IO setting</span><br><span class="line"> -C   <span class="keyword">Check</span> drive <span class="keyword">power</span> <span class="keyword">mode</span> <span class="keyword">status</span></span><br><span class="line"> -d   <span class="keyword">Get</span>/<span class="keyword">set</span> using_dma flag</span><br><span class="line"> -D   <span class="keyword">Enable</span>/<span class="keyword">disable</span> drive defect <span class="keyword">management</span></span><br><span class="line"> -E   <span class="keyword">Set</span> cd/dvd drive speed</span><br><span class="line"> -f   <span class="keyword">Flush</span> buffer <span class="keyword">cache</span> <span class="keyword">for</span> device <span class="keyword">on</span> <span class="keyword">exit</span></span><br><span class="line"> -F   <span class="keyword">Flush</span> drive write <span class="keyword">cache</span></span><br><span class="line"> -g   Display drive geometry</span><br><span class="line"> -h   Display terse <span class="keyword">usage</span> information</span><br><span class="line"> -H   <span class="keyword">Read</span> temperature <span class="keyword">from</span> drive (Hitachi <span class="keyword">only</span>)</span><br><span class="line"> -i   Display drive identification</span><br><span class="line"> -I   Detailed/<span class="keyword">current</span> information directly <span class="keyword">from</span> drive</span><br><span class="line"> -k   <span class="keyword">Get</span>/<span class="keyword">set</span> keep_settings_over_reset flag (<span class="number">0</span>/<span class="number">1</span>)</span><br><span class="line"> -K   <span class="keyword">Set</span> drive keep_features_over_reset flag (<span class="number">0</span>/<span class="number">1</span>)</span><br><span class="line"> -L   <span class="keyword">Set</span> drive doorlock (<span class="number">0</span>/<span class="number">1</span>) (removable harddisks <span class="keyword">only</span>)</span><br><span class="line"> -m   <span class="keyword">Get</span>/<span class="keyword">set</span> multiple sector <span class="keyword">count</span></span><br><span class="line"> -M   <span class="keyword">Get</span>/<span class="keyword">set</span> acoustic <span class="keyword">management</span> (<span class="number">0</span><span class="number">-254</span>, <span class="number">128</span>: quiet, <span class="number">254</span>: <span class="keyword">fast</span>)</span><br><span class="line"> -n   <span class="keyword">Get</span>/<span class="keyword">set</span> <span class="keyword">ignore</span>-write-<span class="keyword">errors</span> flag (<span class="number">0</span>/<span class="number">1</span>)</span><br><span class="line"> -N   <span class="keyword">Get</span>/<span class="keyword">set</span> <span class="keyword">max</span> <span class="keyword">visible</span> <span class="built_in">number</span> <span class="keyword">of</span> sectors (HPA) (VERY DANGEROUS)</span><br><span class="line"> -p   <span class="keyword">Set</span> PIO <span class="keyword">mode</span> <span class="keyword">on</span> IDE <span class="keyword">interface</span> chipset (<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,…)</span><br><span class="line"> -P   <span class="keyword">Set</span> drive prefetch <span class="keyword">count</span></span><br><span class="line"> -q   <span class="keyword">Change</span> <span class="keyword">next</span> setting quietly</span><br><span class="line"> -Q   <span class="keyword">Get</span>/<span class="keyword">set</span> DMA queue_depth (<span class="keyword">if</span> supported)</span><br><span class="line"> -r   <span class="keyword">Get</span>/<span class="keyword">set</span> device readonly flag (DANGEROUS <span class="keyword">to</span> <span class="keyword">set</span>)</span><br><span class="line"> -R   Obsolete</span><br><span class="line"> -s   <span class="keyword">Set</span> <span class="keyword">power</span>-up <span class="keyword">in</span> <span class="keyword">standby</span> flag (<span class="number">0</span>/<span class="number">1</span>) (DANGEROUS)</span><br><span class="line"> -S   <span class="keyword">Set</span> <span class="keyword">standby</span> (spindown) <span class="keyword">timeout</span></span><br><span class="line"> -t   Perform device <span class="keyword">read</span> timings</span><br><span class="line"> -T   Perform <span class="keyword">cache</span> <span class="keyword">read</span> timings</span><br><span class="line"> -u   <span class="keyword">Get</span>/<span class="keyword">set</span> unmaskirq flag (<span class="number">0</span>/<span class="number">1</span>)</span><br><span class="line"> -U   Obsolete</span><br><span class="line"> -v   <span class="keyword">Use</span> <span class="keyword">defaults</span>; same as -acdgkmur for IDE drives</span><br><span class="line"> -V   Display program version and exit immediately</span><br><span class="line"> -w   Perform device <span class="keyword">reset</span> (DANGEROUS)</span><br><span class="line"> -W   <span class="keyword">Get</span>/<span class="keyword">set</span> drive write-<span class="keyword">caching</span> flag (<span class="number">0</span>/<span class="number">1</span>)</span><br><span class="line"> -x   Obsolete</span><br><span class="line"> -X   <span class="keyword">Set</span> IDE xfer <span class="keyword">mode</span> (DANGEROUS)</span><br><span class="line"> -y   Put drive <span class="keyword">in</span> <span class="keyword">standby</span> <span class="keyword">mode</span></span><br><span class="line"> -Y   Put drive <span class="keyword">to</span> <span class="keyword">sleep</span></span><br><span class="line"> -z   Re-<span class="keyword">read</span> <span class="keyword">partition</span> <span class="keyword">table</span></span><br><span class="line"> -Z   <span class="keyword">Disable</span> Seagate <span class="keyword">auto</span>-powersaving <span class="keyword">mode</span></span><br><span class="line"> –dco-freeze      Freeze/<span class="keyword">lock</span> <span class="keyword">current</span> device configuration <span class="keyword">until</span> <span class="keyword">next</span> <span class="keyword">power</span> <span class="keyword">cycle</span></span><br><span class="line"> –dco-identify    <span class="keyword">Read</span>/dump device configuration identify <span class="keyword">data</span></span><br><span class="line"> –dco-<span class="keyword">restore</span>     <span class="keyword">Reset</span> device configuration back <span class="keyword">to</span> factory <span class="keyword">defaults</span></span><br><span class="line"> –direct          <span class="keyword">Use</span> O_DIRECT <span class="keyword">to</span> bypass page <span class="keyword">cache</span> <span class="keyword">for</span> timings</span><br><span class="line"> –drq-hsm-<span class="keyword">error</span>   Crash <span class="keyword">system</span> <span class="keyword">with</span> a “stuck DRQ” <span class="keyword">error</span> (VERY DANGEROUS)</span><br><span class="line"> –fallocate       <span class="keyword">Create</span> a <span class="keyword">file</span> <span class="keyword">without</span> writing <span class="keyword">data</span> <span class="keyword">to</span> disk</span><br><span class="line"> –fibmap          <span class="keyword">Show</span> device extents (<span class="keyword">and</span> fragmentation) <span class="keyword">for</span> a <span class="keyword">file</span></span><br><span class="line"> –fwdownload            Download firmware <span class="keyword">file</span> <span class="keyword">to</span> drive (EXTREMELY DANGEROUS)</span><br><span class="line"> –fwdownload-mode3      Download firmware <span class="keyword">using</span> <span class="keyword">min</span>-<span class="keyword">size</span> segments (EXTREMELY DANGEROUS)</span><br><span class="line"> –fwdownload-mode3-<span class="keyword">max</span>  Download firmware <span class="keyword">using</span> <span class="keyword">max</span>-<span class="keyword">size</span> segments (EXTREMELY DANGEROUS)</span><br><span class="line"> –fwdownload-mode7      Download firmware <span class="keyword">using</span> a single <span class="keyword">segment</span> (EXTREMELY DANGEROUS)</span><br><span class="line"> –idle-<span class="keyword">immediate</span>  Idle drive immediately</span><br><span class="line"> –idle-unload     Idle immediately <span class="keyword">and</span> unload heads</span><br><span class="line"> –Istdin          <span class="keyword">Read</span> identify <span class="keyword">data</span> <span class="keyword">from</span> stdin <span class="keyword">as</span> <span class="keyword">ASCII</span> <span class="keyword">hex</span></span><br><span class="line"> –Istdout         Write identify <span class="keyword">data</span> <span class="keyword">to</span> stdout <span class="keyword">as</span> <span class="keyword">ASCII</span> <span class="keyword">hex</span></span><br><span class="line"> –make-bad-sector Deliberately corrupt a sector directly <span class="keyword">on</span> the media (VERY DANGEROUS)</span><br><span class="line"> –<span class="keyword">offset</span>          <span class="keyword">use</span> <span class="keyword">with</span> -t, <span class="keyword">to</span> <span class="keyword">begin</span> timings <span class="keyword">at</span> given <span class="keyword">offset</span> (<span class="keyword">in</span> GiB) <span class="keyword">from</span> <span class="keyword">start</span> <span class="keyword">of</span> drive</span><br><span class="line"> –prefer-ata12    <span class="keyword">Use</span> <span class="number">12</span>-<span class="keyword">byte</span> (instead <span class="keyword">of</span> <span class="number">16</span>-<span class="keyword">byte</span>) SAT commands <span class="keyword">when</span> possible</span><br><span class="line"> –<span class="keyword">read</span>-sector     <span class="keyword">Read</span> <span class="keyword">and</span> dump (<span class="keyword">in</span> <span class="keyword">hex</span>) a sector directly <span class="keyword">from</span> the media</span><br><span class="line"> –<span class="keyword">security</span>-<span class="keyword">help</span>   Display <span class="keyword">help</span> <span class="keyword">for</span> ATA <span class="keyword">security</span> commands</span><br><span class="line"> –<span class="keyword">trim</span>-sector-ranges        Tell SSD firmware <span class="keyword">to</span> discard unneeded <span class="keyword">data</span> sectors: lba:<span class="keyword">count</span> ..</span><br><span class="line"> –<span class="keyword">trim</span>-sector-ranges-stdin  Same <span class="keyword">as</span> above, but <span class="keyword">reads</span> lba:<span class="keyword">count</span> pairs <span class="keyword">from</span> stdin</span><br><span class="line"> –verbose         Display extra <span class="keyword">diagnostics</span> <span class="keyword">from</span> <span class="keyword">some</span> commands</span><br><span class="line"> –write-sector    <span class="keyword">Repair</span>/overwrite a (possibly bad) sector directly <span class="keyword">on</span> the media (VERY DANGEROUS)</span><br><span class="line"></span><br><span class="line">root@ubuntu:~/hdparm<span class="number">-9.37</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="Linux创建虚拟块设备并格式化为文件系统"><a href="#Linux创建虚拟块设备并格式化为文件系统" class="headerlink" title="Linux创建虚拟块设备并格式化为文件系统"></a>Linux创建虚拟块设备并格式化为文件系统</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span><span class="comment">//blog.csdn.net/q1449516487/article/details/100518520</span></span><br><span class="line">dd一个文件映射成一个盘</span><br><span class="line"><span class="symbol">https:</span><span class="comment">//blog.csdn.net/q1449516487/article/details/100518520</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//www.cnblogs.com/xuyaowen/archive/2019/07/10/lustre-loop-device.html</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//www.cnblogs.com/MrVolleyball/p/9993137.html</span></span><br><span class="line">环境</span><br><span class="line">    为了方便学习文件系统的原理和原始数据的分析，需要创建虚拟块设备并格式化为ext4文件系统；</span><br><span class="line">Linux创建虚拟块设备</span><br><span class="line">    losetup命令</span><br><span class="line">    -a 显示所有已经使用的回环设备状态</span><br><span class="line">    -d 卸除回环设备</span><br><span class="line">    -f 寻找第一个未使用的回环设备</span><br><span class="line">    -e <span class="params">&lt;加密选项&gt;</span> 启动加密编码</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>制作块文件 <span class="number">3</span> 个</span><br><span class="line">[root@localhost yaoxu]<span class="meta"># dd <span class="meta-keyword">if</span>=/dev/zero of=loop.img bs=10M count=10000</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>创建回环设备</span><br><span class="line">[root@localhost yaoxu]<span class="meta"># losetup /dev/loop1 /home/yaoxu/loop.img</span></span><br><span class="line">或者</span><br><span class="line">[root@localhost yaoxu]<span class="meta">#losetup -f /home/yaoxu/loop.img</span></span><br><span class="line"></span><br><span class="line">[root@localhost yaoxu]<span class="meta"># ls /dev/loo*</span></span><br><span class="line"><span class="meta-keyword">/dev/</span>loop0  <span class="meta-keyword">/dev/</span>loop1  <span class="meta-keyword">/dev/</span>loop-control</span><br><span class="line">[root@localhost yaoxu]<span class="meta"># losetup -a</span></span><br><span class="line"><span class="meta-keyword">/dev/</span>loop1: [<span class="number">64770</span>]:<span class="number">3558</span> (<span class="meta-keyword">/home/</span>yaoxu/loop.img)</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 创建lustre文件系统，并挂载</span><br></pre></td></tr></table></figure>

<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">关于回环设备是什么可以参考如下解释：</span><br><span class="line">回环设备（ <span class="string">'loopback device'</span>）允许用户以一个普通磁盘文件虚拟一个块设备。设想一个磁盘设备，对它的所有读写操作都将被重定向到读写一个名为 disk-<span class="keyword">image</span> 的普通文件而非操作实际磁盘或分区的轨道和扇区。（当然，disk-<span class="keyword">image</span> 必须存在于一个实际的磁盘上，而这个磁盘必须比虚拟的磁盘容量更大。）回环设备允许你这样使用一个普通文件。</span><br><span class="line"></span><br><span class="line">回环设备以 /dev/loop0、/dev/loop1 等命名。每个设备可虚拟一个块设备。注意只有超级用户才有权限设置回环设备。</span><br><span class="line"></span><br><span class="line">回环设备的使用与其它任何块设备相同。特别是，你可以在这个设备上创建文件系统并像普通的磁盘一样将它挂载在系统中。这样的一个将全部内容保存在一个普通文件中的文件系统，被称为虚拟文件系统（virtual <span class="keyword">file</span> <span class="keyword">system</span>）（译者注：这个用法并不常见。VFS 通常另有所指，如指代 Linux 内核中有关文件系统抽象的代码层次等）。</span><br></pre></td></tr></table></figure>

<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 什么是<span class="keyword">loop</span>设备？</span><br><span class="line"></span><br><span class="line"><span class="keyword">loop</span>设备是一种伪设备，是使用文件来模拟块设备的一种技术，文件模拟成块设备后, 就像一个磁盘或光盘一样使用。在使用之前，一个 <span class="keyword">loop</span> 设备必须要和一个文件进行连接。这种结合方式给用户提供了一个替代块特殊文件的接口。因此，如果这个文件包含有一个完整的文件系统，那么这个文件就可以像一个磁盘设备一样被 mount 起来。之所以叫<span class="keyword">loop</span>设备（回环），其实是从文件系统这一层来考虑的，因为这种被 mount 起来的镜像文件它本身也包含有文件系统，通过<span class="keyword">loop</span>设备把它mount起来，它就像是文件系统之上再绕了一圈的文件系统，所以称为 <span class="keyword">loop</span>。</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> <span class="keyword">loop</span>设备的使用</span><br><span class="line"></span><br><span class="line">一般在linux中会有<span class="number">8</span>个<span class="keyword">loop</span>设备，一般是/dev/loop0~loop7，可用通过losetup <span class="params">-a</span>查看所有的<span class="keyword">loop</span>设备，如果命令没有输出就说明所有的<span class="keyword">loop</span>设备都没有被占用，你可以按照以下步骤创建自己的<span class="keyword">loop</span>设备。</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>）创建一个文件</span><br><span class="line">dd <span class="keyword">if</span>=/dev/zero of=/<span class="built_in">var</span>/<span class="keyword">loop</span>.img bs=<span class="number">1</span>M count=<span class="number">10240</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>）使用losetup将文件转化为块设备</span><br><span class="line">losetup /dev/loop0 /<span class="built_in">var</span>/<span class="keyword">loop</span>.img</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>）通过lsblk查看刚刚创建的块设备</span><br><span class="line">lsblk |grep loop0</span><br><span class="line">losetup <span class="params">-a</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span>）当然，你也可以将这个块设备格式化并创建其他的文件系统，然后再mount到某个目录，有点多余啊，一般人不这么干。</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>）要删除这个<span class="keyword">loop</span>设备可以执行以下命令</span><br><span class="line">losetup <span class="params">-d</span> /dev/loop0</span><br><span class="line">也能参考如下链接：</span><br><span class="line">https:<span class="comment">//blog.csdn.net/baimafujinji/article/details/78810042</span></span><br><span class="line">https:<span class="comment">//cocos.iteye.com/blog/1068619</span></span><br><span class="line">https:<span class="comment">//blog.csdn.net/scaleqiao/article/details/46777811</span></span><br><span class="line">https:<span class="comment">//www.cnblogs.com/zhanghaiyublog/p/3611507.html</span></span><br></pre></td></tr></table></figure>

<h3 id="惰性初始化"><a href="#惰性初始化" class="headerlink" title="惰性初始化"></a>惰性初始化</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mount的时候：</span><br><span class="line">测试一：惰性初始化</span><br><span class="line">$ time mke2fs -t ext4 <span class="regexp">/dev/</span>sdm1      <span class="regexp">//</span>惰性初始化（默认）</span><br><span class="line">测试二：关闭惰性初始化</span><br><span class="line">$ time mke2fs -t ext4 -E lazy_itable_init=<span class="number">0</span>,lazy_journal_init=<span class="number">0</span> <span class="regexp">/dev/</span>sdm1  <span class="regexp">//</span>关闭惰性初始化</span><br><span class="line">惰性初始化的好处就是能迅速的创建文件系统，尽量把初始化的工作推迟到挂载后进行。 </span><br><span class="line">不建议在benchmark的时候打开该选项，尤其是与其他文件系统做性能测试对比时，会影响测试结果的公允性。 </span><br><span class="line"></span><br><span class="line">惰性格式化磁盘：</span><br><span class="line">mke2fs -t ext4 -E lazy_itable_init=<span class="number">0</span> <span class="regexp">/dev/</span>vdb</span><br><span class="line"></span><br><span class="line">块设备磁盘挂载报：wrong fs type,bad option,bad supe</span><br><span class="line"></span><br><span class="line">解决：</span><br><span class="line">fsck -y <span class="regexp">/dev/</span>sdxxxx     最终执行的是这个修复命令</span><br><span class="line"></span><br><span class="line">ext4系统调优：</span><br><span class="line">mke2fs -t ext4 -m <span class="number">0</span> -b <span class="number">4096</span> -O bigalloc,dir_index,extent,extra_isize,flex_bg -E stride=<span class="number">4096</span>,stripe-width=<span class="number">4096</span> <span class="regexp">/dev/</span>sde</span><br><span class="line">mount -t ext4 -o max_batch_time=<span class="number">0</span>,discard,data=writeback,stripe=<span class="number">4096</span>,commit=<span class="number">1</span>,journal_async_commit,noatime,nodiratime,inode_readahead_blks=<span class="number">1024</span> <span class="regexp">/dev/</span>sde <span class="regexp">/mnt/</span>test</span><br><span class="line">echo <span class="number">256</span> &gt; <span class="regexp">/sys/</span>block<span class="regexp">/sde/</span>queue<span class="regexp">/iosched/</span>fifo_batch</span><br><span class="line">echo <span class="number">400</span> &gt; <span class="regexp">/sys/</span>block<span class="regexp">/sde/</span>queue<span class="regexp">/iosched/</span>read_expire</span><br><span class="line">echo <span class="number">800</span> &gt; <span class="regexp">/sys/</span>block<span class="regexp">/sde/</span>queue<span class="regexp">/iosched/</span>write_expire</span><br><span class="line"></span><br><span class="line">echo <span class="number">10</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/vm/</span>swappiness</span><br><span class="line">echo <span class="number">60</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/vm/</span>dirty_ratio</span><br><span class="line">echo <span class="number">500</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/vm/</span>dirty_expire_centisecs</span><br><span class="line">echo <span class="number">20</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/vm/</span>dirty_background_ratio</span><br><span class="line">echo <span class="number">300</span> &gt; <span class="regexp">/proc/</span>sys<span class="regexp">/vm/</span>dirty_writeback_centisecs</span><br><span class="line">浪潮EXT4下流量波动的说明 及调优的情况，@全体成员 ，看下参数调整是否可以用于实际应用</span><br></pre></td></tr></table></figure>



<h3 id="raid卡"><a href="#raid卡" class="headerlink" title="raid卡"></a>raid卡</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参考博客：</span><br><span class="line"><span class="symbol">https:</span><span class="comment">//www.cnblogs.com/luxiaodai/p/9878747.html</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//www.cnblogs.com/liuxing0007/p/10912444.html</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">raid卡是提高性能的</span><br><span class="line">lvm是增加容量的</span><br></pre></td></tr></table></figure>

<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">查看是否带raid卡：udevadm test-builtin blkid "$device" <span class="number">2</span>&gt;/dev/<span class="keyword">null</span> | grep -q "^ID_FS_USAGE=raid"</span><br><span class="line"></span><br><span class="line">关于buffer，<span class="keyword">cache</span>，wb，wt，clean，inv，flush，以及其他</span><br><span class="line"><span class="number">1.</span> 有时候需要区分buffer和<span class="keyword">cache</span>：buffer解决CPU写的问题，比如将多次写操作buffer起来一次性更新；<span class="keyword">cache</span>解决CPU读的问题，将数据<span class="keyword">cache</span>起来在下次读的时候快速取用。</span><br><span class="line"><span class="number">2.</span> <span class="keyword">cache</span>有两种更新策略：write back和write through。writeback是将待写入memory的数据先放在<span class="keyword">cache</span>中，直到<span class="keyword">cache</span>位置将被替换时writeback到memory；write through是将数据同时写入<span class="keyword">cache</span>和memory。</span><br><span class="line"><span class="number">3.</span> invalidate：将<span class="keyword">cache</span>数据设置为无效（即discard <span class="keyword">cache</span>中的数据），不会将<span class="keyword">cache</span>数据写入memory；clean（write back）：将<span class="keyword">cache</span>数据写进memory；flush：clean and invalidate。</span><br><span class="line"><span class="number">4.</span> 对于DMA <span class="keyword">From</span> Device <span class="keyword">to</span> Memory来说，invalidate range未必对其到<span class="keyword">cache</span> line，这时需要首先将非对齐部分clean到memory，然后invalidate <span class="keyword">cache</span>。</span><br></pre></td></tr></table></figure>

<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line">/opt/zabbix/lldscripts/MegaRAID/MegaCli/MegaCli64 -AdpAllInfo -a0|grep Policy</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、查看某个盘是否是write through还是write back：【Raid设置直通还是非直通】</span><br><span class="line">cat /sys/block/sdm/device/scsi_disk/<span class="number">0</span>\:<span class="number">2</span>\:<span class="number">0</span>\:<span class="number">0</span>/cache_type</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、lsscsi -s命令可以看出是否是直通模式：【查看系统设置直通还是非直通】</span><br><span class="line">直通模式：原因：[<span class="number">0</span>:<span class="number">0</span>:<span class="number">30</span>:<span class="number">0</span>]是<span class="number">0</span>:<span class="number">0</span>:x:x开头的</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">30</span>:<span class="number">0</span>]   disk    ATA      INTEL SSDSC2KB96 <span class="number">0100</span>  /dev/sda    <span class="number">960</span>GB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">31</span>:<span class="number">0</span>]   disk    ATA      INTEL SSDSC2KB96 <span class="number">0100</span>  /dev/sdb    <span class="number">960</span>GB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">32</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sdc   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">33</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sdd   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">34</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sde   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">35</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sdf   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">36</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sdg   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">37</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sdh   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">38</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sdi   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">39</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sdj   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">40</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sdk   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">41</span>:<span class="number">0</span>]   disk    ATA      ST4000NM0035<span class="number">-1</span>V4 TN05  /dev/sdl   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">0</span>:<span class="number">0</span>]    disk    AVAGO    MR-SAS3316       <span class="number">4.74</span>  /dev/sdm   <span class="number">53.6</span>GB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">1</span>:<span class="number">0</span>]    disk    AVAGO    MR-SAS3316       <span class="number">4.74</span>  /dev/sdn    <span class="number">545</span>GB</span><br><span class="line"></span><br><span class="line">非直通模式：原因：[<span class="number">0</span>:<span class="number">2</span>:<span class="number">0</span>:<span class="number">0</span>]是<span class="number">0</span>:<span class="number">2</span>:x:x开头的</span><br><span class="line">[<span class="symbol">root@</span>host102442549 ~]# lsscsi -s</span><br><span class="line">[<span class="number">0</span>:<span class="number">0</span>:<span class="number">8</span>:<span class="number">0</span>]    enclosu PMCSIERA SXP <span class="number">24</span>Sx12G      RevB  -               -</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">0</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sda   <span class="number">53.6</span>GB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">1</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sdb    <span class="number">245</span>GB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">2</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sdc    <span class="number">959</span>GB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">3</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sdd   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">4</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sde   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">5</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sdf   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">6</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sdg   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">7</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sdh   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">8</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sdi   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">9</span>:<span class="number">0</span>]    disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sdj   <span class="number">4.00</span>TB</span><br><span class="line">[<span class="number">0</span>:<span class="number">2</span>:<span class="number">10</span>:<span class="number">0</span>]   disk    AVAGO    INSPUR           <span class="number">4.67</span>  /dev/sdk   <span class="number">4.00</span>TB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、单盘的wt/wb模式：</span><br><span class="line">这个应该是单盘raid0，wt/wb要用raid卡命令看：</span><br><span class="line">/opt/MegaRAID/storcli/storcli64 /c0 show</span><br><span class="line"></span><br><span class="line">[<span class="symbol">root@</span>host10242491 ~]# /opt/MegaRAID/storcli/storcli64 /c0 show</span><br><span class="line">Generating detailed summary of the adapter, it may take a <span class="keyword">while</span> to complete.</span><br><span class="line"></span><br><span class="line">Controller = <span class="number">0</span></span><br><span class="line">Status = Success</span><br><span class="line">Description = None</span><br><span class="line"></span><br><span class="line">Product Name = INSPUR <span class="number">3108</span>MR<span class="number">-2</span>GB</span><br><span class="line">Serial Number = RAH516GV0274A30</span><br><span class="line">SAS Address =  <span class="number">56</span>c92bf000697634</span><br><span class="line">PCI Address = <span class="number">00</span>:<span class="number">04</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">System Time = <span class="number">09</span>/<span class="number">25</span>/<span class="number">2019</span> <span class="number">09</span>:<span class="number">39</span>:<span class="number">19</span></span><br><span class="line">Mfg. Date = <span class="number">12</span>/<span class="number">01</span>/<span class="number">17</span></span><br><span class="line">Controller Time = <span class="number">09</span>/<span class="number">25</span>/<span class="number">2019</span> <span class="number">09</span>:<span class="number">39</span>:<span class="number">17</span></span><br><span class="line">FW Package Build = <span class="number">24.12</span><span class="number">.0</span><span class="number">-0025</span></span><br><span class="line">BIOS Version = <span class="number">6.30</span><span class="number">.03</span><span class="number">.0</span>_4<span class="number">.17</span><span class="number">.08</span><span class="number">.00</span>_0x06130200</span><br><span class="line">FW Version = <span class="number">4.620</span><span class="number">.00</span><span class="number">-6101</span></span><br><span class="line">Driver Name = megaraid_sas</span><br><span class="line">Driver Version = <span class="number">06.803</span><span class="number">.01</span><span class="number">.00</span>-rh1</span><br><span class="line">Vendor Id = <span class="number">0x1000</span></span><br><span class="line">Device Id = <span class="number">0x5D</span></span><br><span class="line">SubVendor Id = <span class="number">0x1BD4</span></span><br><span class="line">SubDevice Id = <span class="number">0x14</span></span><br><span class="line">Host Interface = PCI-E</span><br><span class="line">Device Interface = SAS<span class="number">-12</span>G</span><br><span class="line">Bus Number = <span class="number">4</span></span><br><span class="line">Device Number = <span class="number">0</span></span><br><span class="line">Function Number = <span class="number">0</span></span><br><span class="line">Drive Groups = <span class="number">12</span></span><br><span class="line"></span><br><span class="line">TOPOLOGY :</span><br><span class="line">========</span><br><span class="line"></span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">DG Arr Row EID:Slot DID Type  State BT       Size PDC  PI SED DS3  FSpace TR</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"><span class="number">0</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">0</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">0</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">0</span>     <span class="number">46</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line"><span class="number">1</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">1</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">1</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">1</span>     <span class="number">54</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line"><span class="number">2</span> -   -   -        -   RAID0 Optl  N  <span class="number">446.625</span> GB dflt N  N   dflt N      N  </span><br><span class="line"><span class="number">2</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N  <span class="number">446.625</span> GB dflt N  N   dflt N      N  </span><br><span class="line"><span class="number">2</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">2</span>     <span class="number">47</span>  DRIVE Onln  N  <span class="number">446.625</span> GB dflt N  N   dflt -      N  </span><br><span class="line"><span class="number">3</span> -   -   -        -   RAID0 Optl  N  <span class="number">446.625</span> GB dflt N  N   dflt N      N  </span><br><span class="line"><span class="number">3</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N  <span class="number">446.625</span> GB dflt N  N   dflt N      N  </span><br><span class="line"><span class="number">3</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">3</span>     <span class="number">56</span>  DRIVE Onln  N  <span class="number">446.625</span> GB dflt N  N   dflt -      N  </span><br><span class="line"><span class="number">4</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">4</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">4</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">4</span>     <span class="number">48</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line"><span class="number">5</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">5</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">5</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">5</span>     <span class="number">55</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line"><span class="number">6</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">6</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">6</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">6</span>     <span class="number">49</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line"><span class="number">7</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">7</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">7</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">7</span>     <span class="number">52</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line"><span class="number">8</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">8</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">8</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">8</span>     <span class="number">50</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line"><span class="number">9</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">9</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">9</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">9</span>     <span class="number">57</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line"><span class="number">10</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">10</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">10</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">10</span>    <span class="number">53</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line"><span class="number">11</span> -   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">11</span> <span class="number">0</span>   -   -        -   RAID0 Optl  N    <span class="number">3.637</span> TB enbl N  N   dflt N      N  </span><br><span class="line"><span class="number">11</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">45</span>:<span class="number">11</span>    <span class="number">51</span>  DRIVE Onln  N    <span class="number">3.637</span> TB enbl N  N   dflt -      N  </span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">DG=Disk Group Index|Arr=Array Index|Row=Row Index|EID=Enclosure Device ID</span><br><span class="line">DID=Device ID|Type=Drive Type|Onln=Online|Rbld=Rebuild|Dgrd=Degraded</span><br><span class="line">Pdgd=Partially degraded|Offln=Offline|BT=Background Task Active</span><br><span class="line">PDC=PD Cache|PI=Protection Info|SED=Self Encrypting Drive|Frgn=Foreign</span><br><span class="line">DS3=Dimmer Switch <span class="number">3</span>|dflt=Default|Msng=Missing|FSpace=Free Space Present</span><br><span class="line">TR=Transport Ready</span><br><span class="line"></span><br><span class="line">Virtual Drives = <span class="number">12</span></span><br><span class="line"></span><br><span class="line">VD LIST :</span><br><span class="line">=======</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------</span><br><span class="line">DG/VD TYPE  State Access Consist Cache Cac sCC       Size Name</span><br><span class="line">---------------------------------------------------------------</span><br><span class="line"><span class="number">0</span>/<span class="number">0</span>   RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line"><span class="number">1</span>/<span class="number">1</span>   RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line"><span class="number">2</span>/<span class="number">2</span>   RAID0 Optl  RW     Yes     RAWBC -   ON  <span class="number">446.625</span> GB      </span><br><span class="line"><span class="number">3</span>/<span class="number">3</span>   RAID0 Optl  RW     Yes     RAWBD -   ON  <span class="number">446.625</span> GB      </span><br><span class="line"><span class="number">4</span>/<span class="number">4</span>   RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line"><span class="number">5</span>/<span class="number">5</span>   RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line"><span class="number">6</span>/<span class="number">6</span>   RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line"><span class="number">7</span>/<span class="number">7</span>   RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line"><span class="number">8</span>/<span class="number">8</span>   RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line"><span class="number">9</span>/<span class="number">9</span>   RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line"><span class="number">10</span>/<span class="number">10</span> RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line"><span class="number">11</span>/<span class="number">11</span> RAID0 Optl  RW     Yes     RAWBC -   ON    <span class="number">3.637</span> TB      </span><br><span class="line">---------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Cac=CacheCade|Rec=Recovery|OfLn=OffLine|Pdgd=Partially Degraded|Dgrd=Degraded</span><br><span class="line">Optl=Optimal|RO=Read Only|RW=Read Write|HD=Hidden|TRANS=TransportReady|B=Blocked|</span><br><span class="line">Consist=Consistent|R=Read Ahead Always|NR=No Read Ahead|WB=WriteBack|</span><br><span class="line">AWB=Always WriteBack|WT=WriteThrough|C=Cached IO|D=Direct IO|sCC=Scheduled</span><br><span class="line">Check Consistency</span><br><span class="line"></span><br><span class="line">#表示raid 是wb模式</span><br><span class="line"></span><br><span class="line">Physical Drives = <span class="number">12</span></span><br><span class="line"></span><br><span class="line">PD LIST :</span><br><span class="line">=======</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line">EID:Slt DID State DG       Size Intf Med SED PI SeSz Model               Sp Type</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"><span class="number">45</span>:<span class="number">0</span>     <span class="number">46</span> Onln   <span class="number">0</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">1</span>     <span class="number">54</span> Onln   <span class="number">1</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">2</span>     <span class="number">47</span> Onln   <span class="number">2</span> <span class="number">446.625</span> GB SATA SSD N   N  <span class="number">512</span>B INTEL SSDSC2BB480G6 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">3</span>     <span class="number">56</span> Onln   <span class="number">3</span> <span class="number">446.625</span> GB SATA SSD N   N  <span class="number">512</span>B INTEL SSDSC2BB480G6 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">4</span>     <span class="number">48</span> Onln   <span class="number">4</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">5</span>     <span class="number">55</span> Onln   <span class="number">5</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">6</span>     <span class="number">49</span> Onln   <span class="number">6</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">7</span>     <span class="number">52</span> Onln   <span class="number">7</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">8</span>     <span class="number">50</span> Onln   <span class="number">8</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">9</span>     <span class="number">57</span> Onln   <span class="number">9</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">10</span>    <span class="number">53</span> Onln  <span class="number">10</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line"><span class="number">45</span>:<span class="number">11</span>    <span class="number">51</span> Onln  <span class="number">11</span>   <span class="number">3.637</span> TB SATA HDD N   N  <span class="number">512</span>B ST4000NM0035<span class="number">-1</span>V4107 U  -    </span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">EID-Enclosure Device ID|Slt-Slot No.|DID-Device ID|DG-DriveGroup</span><br><span class="line">DHS-Dedicated Hot Spare|UGood-Unconfigured Good|GHS-Global Hotspare</span><br><span class="line">UBad-Unconfigured Bad|Onln-Online|Offln-Offline|Intf-Interface</span><br><span class="line">Med-Media Type|SED-Self Encryptive Drive|PI-Protection Info</span><br><span class="line">SeSz-Sector Size|Sp-Spun|U-Up|D-Down|T-Transition|F-Foreign</span><br><span class="line">UGUnsp-Unsupported|UGShld-UnConfigured shielded|HSPShld-Hotspare shielded</span><br><span class="line">CFShld-Configured shielded|Cpybck-CopyBack|CBShld-Copyback Shielded</span><br><span class="line"></span><br><span class="line">http:<span class="comment">//ilinuxkernel.com/?p=897</span></span><br><span class="line">如何关闭硬盘写缓存（Write Cache）</span><br></pre></td></tr></table></figure>

<p><img src="/2022/05/17/linux/Linux/Linux%5C1584948682984-1585553407634.png" alt="1584948682984"></p>
<p> 应该是内核开的，我记得以前默认都是关闭的，<br>厂家回复：</p>
<h3 id="storcli64"><a href="#storcli64" class="headerlink" title="storcli64"></a>storcli64</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">、简介（软件见附件）</span></span><br><span class="line"><span class="string">MegaCli</span> <span class="string">是LSI公司官方提供的SCSI卡管理工具，由于LSI被收购变成了现在的Broadcom，所以现在想下载MegaCli，</span></span><br><span class="line"><span class="string">需要去Broadcom官网查找Legacy产品支持，搜索MegaRAID即可。</span></span><br><span class="line"> </span><br><span class="line"><span class="string">现在官方有storcli，storcli已经基本代替了megacli，整合了LSI和3ware所有产品。</span></span><br><span class="line"> </span><br><span class="line"><span class="string">安装方面比较简单，megacli还要Lib_Utils的支持，而storcli只用一个rpm包就可以下载，</span></span><br><span class="line"><span class="string">去Broadcom官网去找就行了：https://www.broadcom.com/site-search?q=storcli</span>  <span class="string">【附件有】</span></span><br><span class="line"> </span><br><span class="line"><span class="string">storcli支持json格式输出，信息解析更加方便。</span></span><br><span class="line"> </span><br><span class="line"><span class="string">我个人推荐使用这个软件，因为megacli</span> <span class="string">工具需要安装额外的软件包，有些服务器客户不允许安装其他的软件包，所以比较麻烦。</span></span><br><span class="line"><span class="string">这个工具直接安装了之后就可以用。</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="number">1.1</span><span class="string">服务器信息：</span></span><br><span class="line"><span class="string">[root@xgto01n010244025044</span> <span class="string">v1]#</span> <span class="string">dmidecode</span> <span class="string">-t</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># dmidecode 3.0</span></span><br><span class="line"><span class="string">Getting</span> <span class="string">SMBIOS</span> <span class="string">data</span> <span class="string">from</span> <span class="string">sysfs.</span></span><br><span class="line"><span class="string">SMBIOS</span> <span class="number">3.0</span> <span class="string">present.</span></span><br><span class="line"></span><br><span class="line"><span class="string">Handle</span> <span class="number">0x0001</span><span class="string">,</span> <span class="string">DMI</span> <span class="string">type</span> <span class="number">1</span><span class="string">,</span> <span class="number">27</span> <span class="string">bytes</span></span><br><span class="line"><span class="string">System</span> <span class="string">Information</span></span><br><span class="line">	<span class="attr">Manufacturer:</span> <span class="string">Sugon</span></span><br><span class="line">	<span class="attr">Product Name:</span> <span class="string">I620-G20</span></span><br><span class="line">	<span class="attr">Version:</span> <span class="string">Grantley-EP</span></span><br><span class="line">	<span class="attr">Serial Number:</span> <span class="number">6100655700926742</span></span><br><span class="line">	<span class="attr">UUID:</span> <span class="string">B409F860-C021-11D3-991D-107B44B05C08</span></span><br><span class="line">	<span class="attr">Wake-up Type:</span> <span class="string">Power</span> <span class="string">Switch</span></span><br><span class="line">	<span class="attr">SKU Number:</span>  </span><br><span class="line">	<span class="attr">Family:</span> <span class="string">Rack</span></span><br><span class="line">	</span><br><span class="line"><span class="number">1.2</span><span class="string">系统信息：</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">cat</span> <span class="string">/etc/redhat-release</span></span><br><span class="line"><span class="string">Red</span> <span class="string">Hat</span> <span class="string">Enterprise</span> <span class="string">Linux</span> <span class="string">Server</span> <span class="string">release</span> <span class="number">6.4</span> <span class="string">(Santiago)</span></span><br><span class="line"> </span><br><span class="line"><span class="number">1.3</span> <span class="string">安装storcli</span></span><br><span class="line"><span class="string">rpm</span> <span class="string">-ivh</span>  <span class="string">storcli-1.03.11-1.noarch.rpm</span></span><br><span class="line"><span class="string">目录：</span> <span class="string">/opt/Mega/storcli</span></span><br><span class="line"><span class="string">注意版本问题</span></span><br><span class="line"><span class="string">我这台服务器是DELL</span>  <span class="string">R720xd，2012年上线的，所以我用的是storcli.1.03.11版本。</span></span><br><span class="line"><span class="string">我用的新版本安装之后，执行命令没有输出，所以这一点需要注意。</span></span><br><span class="line"> </span><br><span class="line"><span class="number">1.4</span><span class="string">一些参数定义：</span></span><br><span class="line"><span class="string">/cx</span> <span class="string">=</span> <span class="string">Controller</span> <span class="string">ID</span></span><br><span class="line"><span class="string">/vx</span> <span class="string">=</span> <span class="string">Virtual</span> <span class="string">Drive</span> <span class="string">Number.</span></span><br><span class="line"><span class="string">/ex</span> <span class="string">=</span> <span class="string">Enclosure</span> <span class="string">ID</span></span><br><span class="line"><span class="string">/sx</span> <span class="string">=</span> <span class="string">Slot</span> <span class="string">ID</span></span><br><span class="line"> </span><br><span class="line"><span class="number">1.5</span><span class="string">为了管理方便，建立软连接</span></span><br><span class="line"><span class="string">ln</span> <span class="string">-s</span> <span class="string">/opt/MegaRAID/storcli/storcli64</span> <span class="string">/bin/storcli</span></span><br><span class="line"><span class="string">ln</span> <span class="string">-s</span> <span class="string">/opt/MegaRAID/storcli/storcli64</span>    <span class="string">/sbin/storcli</span></span><br><span class="line"> </span><br><span class="line"><span class="string">如果不想建立软连接，就在/opt/MegaRAID/storcli</span> <span class="string">目录下</span> <span class="string">执行./storcli64</span> <span class="string">指令</span></span><br><span class="line"> </span><br><span class="line"><span class="number">2</span><span class="string">、查看当前设备raid控制器相关信息</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">./storcli64</span> <span class="string">show</span> <span class="string">all</span>    <span class="string">可以看到只有一个控制器</span></span><br><span class="line"><span class="string">Status</span> <span class="string">Code</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">Status</span> <span class="string">=</span> <span class="string">Success</span></span><br><span class="line"><span class="string">Description</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Number</span> <span class="string">of</span> <span class="string">Controllers</span> <span class="string">=</span> <span class="number">1</span></span><br><span class="line"><span class="string">Host</span> <span class="string">Name</span> <span class="string">=</span> <span class="string">localhost.localdomain</span></span><br><span class="line"><span class="string">Operating</span> <span class="string">System</span>  <span class="string">=</span> <span class="string">Linux2.6.32-358.el6.x86_64</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">System Overview :</span></span><br><span class="line"><span class="string">===============</span></span><br><span class="line"> </span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line"><span class="string">Ctl</span> <span class="string">Model</span> <span class="string">Ports</span> <span class="string">PDs</span> <span class="string">DGs</span> <span class="string">DNOpt</span> <span class="string">VDs</span> <span class="string">VNOpt</span> <span class="string">BBU</span> <span class="string">sPR</span> <span class="string">DS</span> <span class="string">EHS</span> <span class="string">ASOs</span></span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line">  <span class="number">0</span> <span class="string">Mini</span>      <span class="number">8</span>  <span class="number">14</span>   <span class="number">3</span>     <span class="number">0</span>   <span class="number">3</span>     <span class="number">0</span> <span class="string">Opt</span> <span class="string">On</span>  <span class="number">3</span>  <span class="string">N</span>      <span class="number">0</span>      <span class="string">【只看到一个控制器】</span></span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Ctl=Controller</span> <span class="string">Index|DGs=Drive</span> <span class="string">groups|VDs=Virtual</span> <span class="string">drives|Fld=Failed</span></span><br><span class="line"><span class="string">PDs=Physical</span> <span class="string">drives|DNOpt=DG</span> <span class="string">NotOptimal|VNOpt=VD</span> <span class="string">NotOptimal|Opt=Optimal</span></span><br><span class="line"><span class="string">Msng=Missing|Dgd=Degraded|NdAtn=Need</span> <span class="string">Attention|Unkwn=Unknown</span></span><br><span class="line"><span class="string">sPR=Scheduled</span> <span class="string">Patrol</span> <span class="string">Read|DS=DimmerSwitch|EHS=Emergency</span> <span class="string">Hot</span> <span class="string">Spare</span></span><br><span class="line"><span class="string">Y=Yes|N=No|ASOs=Advanced</span> <span class="string">Software</span> <span class="string">Options|BBU=Battery</span> <span class="string">backup</span> <span class="string">unit</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">ASO :</span></span><br><span class="line"><span class="string">===</span></span><br><span class="line"></span><br><span class="line"><span class="string">----</span></span><br><span class="line"><span class="string">Ctl</span></span><br><span class="line"><span class="string">----</span></span><br><span class="line">  <span class="number">0</span></span><br><span class="line"><span class="string">----</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Cl=Cluster|MD=Max</span> <span class="string">Disks|WC=Wide</span> <span class="string">Cache|SS=Safe</span> <span class="string">Store|FP=Fast</span> <span class="string">Path|Re=Recovery</span></span><br><span class="line"><span class="string">CR=CacheCade(Read)|RF=Reduced</span> <span class="string">Feature</span> <span class="string">Set|CO=Cache</span> <span class="string">Offload</span></span><br><span class="line"><span class="string">CW=CacheCade(Read/Write)|X=Not</span> <span class="string">Available/Not</span> <span class="string">Installed|U=Unlimited|T=Trial</span></span><br><span class="line"> </span><br><span class="line"><span class="number">3</span><span class="string">、查看控制器c0的相关信息</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">./storcli64</span>  <span class="string">/c0</span> <span class="string">show</span></span><br><span class="line"><span class="string">Controller</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">Status</span> <span class="string">=</span> <span class="string">Success</span></span><br><span class="line"><span class="string">Description</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Product</span> <span class="string">Name</span> <span class="string">=</span> <span class="string">PERC</span> <span class="string">H710P</span> <span class="string">Mini【控制器型号】</span></span><br><span class="line"><span class="string">Serial</span> <span class="string">Number</span> <span class="string">=</span> <span class="string">26300UP</span></span><br><span class="line"><span class="string">SAS</span> <span class="string">Address</span> <span class="string">=</span>  <span class="string">5d4ae520a6bcbc00</span></span><br><span class="line"><span class="string">Mfg.</span> <span class="string">Date</span> <span class="string">=</span> <span class="number">06</span><span class="string">/04/12</span></span><br><span class="line"><span class="string">System</span> <span class="string">Time</span> <span class="string">=</span> <span class="number">05</span><span class="string">/22/2019</span> <span class="number">16</span><span class="string">:22:28</span></span><br><span class="line"><span class="string">Controller</span> <span class="string">Time</span> <span class="string">=</span> <span class="number">05</span><span class="string">/22/2019</span> <span class="number">08</span><span class="string">:22:28</span></span><br><span class="line"><span class="string">FW</span> <span class="string">Package</span> <span class="string">Build</span> <span class="string">=</span> <span class="number">21.0</span><span class="number">.2</span><span class="number">-0001</span></span><br><span class="line"><span class="string">BIOS</span> <span class="string">Version</span> <span class="string">=</span> <span class="number">5.30</span><span class="string">.00_4.12.05.00_0x05110000</span></span><br><span class="line"><span class="string">FW</span> <span class="string">Version</span> <span class="string">=</span> <span class="number">3.130</span><span class="number">.05</span><span class="number">-1587</span></span><br><span class="line"><span class="string">Driver</span> <span class="string">Name</span> <span class="string">=</span> <span class="string">megaraid_sas</span></span><br><span class="line"><span class="string">Driver</span> <span class="string">Version</span> <span class="string">=</span> <span class="number">06.504</span><span class="number">.01</span><span class="number">.00</span><span class="string">-rh1</span></span><br><span class="line"><span class="string">Controller</span> <span class="string">Bus</span> <span class="string">Type</span> <span class="string">=</span> <span class="string">N/A</span></span><br><span class="line"><span class="string">PCI</span> <span class="string">Slot</span> <span class="string">=</span> <span class="string">N/A</span></span><br><span class="line"><span class="string">PCI</span> <span class="string">Bus</span> <span class="string">Number</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">PCI</span> <span class="string">Device</span> <span class="string">Number</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">PCI</span> <span class="string">Function</span> <span class="string">Number</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">Drive</span> <span class="string">Groups</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">TOPOLOGY :</span></span><br><span class="line"><span class="string">========</span></span><br><span class="line"> </span><br><span class="line"><span class="string">--------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">DG</span> <span class="string">Arr</span> <span class="string">Row</span> <span class="string">EID:Slot</span> <span class="string">DID</span> <span class="string">Type</span>  <span class="string">State</span> <span class="string">BT</span>       <span class="string">Size</span> <span class="string">PDC</span>  <span class="string">PI</span> <span class="string">SED</span> <span class="string">DS3</span>  <span class="string">FSpace</span></span><br><span class="line"><span class="string">--------------------------------------------------------------------------</span></span><br><span class="line"><span class="number">0</span> <span class="string">-</span>   <span class="string">-</span>   <span class="string">-</span>        <span class="string">-</span>   <span class="string">RAID1</span> <span class="string">Optl</span>  <span class="string">N</span>  <span class="number">278.875</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">N</span>      </span><br><span class="line"><span class="number">0</span> <span class="number">0</span>   <span class="string">-</span>   <span class="string">-</span>        <span class="string">-</span>   <span class="string">RAID1</span> <span class="string">Optl</span>  <span class="string">N</span>  <span class="number">278.875</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">N</span>      </span><br><span class="line"><span class="number">0</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">32</span><span class="string">:24</span>    <span class="number">24</span>  <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>  <span class="number">278.875</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">0</span> <span class="number">0</span>   <span class="number">1</span>   <span class="number">32</span><span class="string">:25</span>    <span class="number">25</span>  <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>  <span class="number">278.875</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">1</span> <span class="string">-</span>   <span class="string">-</span>   <span class="string">-</span>        <span class="string">-</span>   <span class="string">RAID5</span> <span class="string">Optl</span>  <span class="string">N</span>    <span class="number">4.089</span> <span class="string">TB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">N</span>      </span><br><span class="line"><span class="number">1</span> <span class="number">0</span>   <span class="string">-</span>   <span class="string">-</span>        <span class="string">-</span>   <span class="string">RAID5</span> <span class="string">Optl</span>  <span class="string">N</span>    <span class="number">4.089</span> <span class="string">TB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">N</span>      </span><br><span class="line"><span class="number">1</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">32</span><span class="string">:0</span>     <span class="number">0</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">1</span> <span class="number">0</span>   <span class="number">1</span>   <span class="number">32</span><span class="string">:1</span>     <span class="number">1</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">1</span> <span class="number">0</span>   <span class="number">2</span>   <span class="number">32</span><span class="string">:2</span>     <span class="number">2</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">1</span> <span class="number">0</span>   <span class="number">3</span>   <span class="number">32</span><span class="string">:3</span>     <span class="number">3</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">1</span> <span class="number">0</span>   <span class="number">4</span>   <span class="number">32</span><span class="string">:4</span>     <span class="number">4</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">1</span> <span class="number">0</span>   <span class="number">5</span>   <span class="number">32</span><span class="string">:5</span>     <span class="number">5</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">2</span> <span class="string">-</span>   <span class="string">-</span>   <span class="string">-</span>        <span class="string">-</span>   <span class="string">RAID5</span> <span class="string">Optl</span>  <span class="string">N</span>    <span class="number">4.089</span> <span class="string">TB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">N</span>      </span><br><span class="line"><span class="number">2</span> <span class="number">0</span>   <span class="string">-</span>   <span class="string">-</span>        <span class="string">-</span>   <span class="string">RAID5</span> <span class="string">Optl</span>  <span class="string">N</span>    <span class="number">4.089</span> <span class="string">TB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">N</span>      </span><br><span class="line"><span class="number">2</span> <span class="number">0</span>   <span class="number">0</span>   <span class="number">32</span><span class="string">:6</span>     <span class="number">6</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">2</span> <span class="number">0</span>   <span class="number">1</span>   <span class="number">32</span><span class="string">:7</span>     <span class="number">7</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">2</span> <span class="number">0</span>   <span class="number">2</span>   <span class="number">32</span><span class="string">:8</span>     <span class="number">8</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">2</span> <span class="number">0</span>   <span class="number">3</span>   <span class="number">32</span><span class="string">:9</span>     <span class="number">9</span>   <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">2</span> <span class="number">0</span>   <span class="number">4</span>   <span class="number">32</span><span class="string">:10</span>    <span class="number">10</span>  <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      </span><br><span class="line"><span class="number">2</span> <span class="number">0</span>   <span class="number">5</span>   <span class="number">32</span><span class="string">:11</span>    <span class="number">11</span>  <span class="string">DRIVE</span> <span class="string">Onln</span>  <span class="string">N</span>   <span class="number">837.75</span> <span class="string">GB</span> <span class="string">dflt</span> <span class="string">N</span>  <span class="string">N</span>   <span class="string">dflt</span> <span class="string">-</span>      <span class="string">【可以看到服务器有几个RAID，每个RAID的级别和成员盘】</span></span><br><span class="line"><span class="string">--------------------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">DG=Disk</span> <span class="string">Group</span> <span class="string">Index|Arr=Array</span> <span class="string">Index|Row=Row</span> <span class="string">Index|EID=Enclosure</span> <span class="string">Device</span> <span class="string">ID</span></span><br><span class="line"><span class="string">DID=Device</span> <span class="string">ID|Type=Drive</span> <span class="string">Type|Onln=Online|Rbld=Rebuild|Dgrd=Degraded</span></span><br><span class="line"><span class="string">Pdgd=Partially</span> <span class="string">degraded|Offln=Offline|BT=Background</span> <span class="string">Task</span> <span class="string">Active</span></span><br><span class="line"><span class="string">PDC=PD</span> <span class="string">Cache|PI=Protection</span> <span class="string">Info|SED=Self</span> <span class="string">Encrypting</span> <span class="string">Drive|Frgn=Foreign</span></span><br><span class="line"><span class="string">DS3=Dimmer</span> <span class="string">Switch</span> <span class="number">3</span><span class="string">|dflt=Default|Msng=Missing|FSpace=Free</span> <span class="string">Space</span> <span class="string">Present</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Virtual</span> <span class="string">Drives</span> <span class="string">=</span> <span class="number">3</span><span class="string">【服务器有三个RAID，两个RAID5一个RAID1】</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">VD LIST :</span></span><br><span class="line"><span class="string">=======</span></span><br><span class="line"> </span><br><span class="line"><span class="string">---------------------------------------------------------------</span></span><br><span class="line"><span class="string">DG/VD</span> <span class="string">TYPE</span>  <span class="string">State</span> <span class="string">Access</span> <span class="string">Consist</span> <span class="string">Cache</span> <span class="string">Cac</span> <span class="string">sCC</span>       <span class="string">Size</span> <span class="string">Name</span></span><br><span class="line"><span class="string">---------------------------------------------------------------</span></span><br><span class="line"><span class="number">0</span><span class="string">/0</span>   <span class="string">RAID1</span> <span class="string">Optl</span>  <span class="string">RW</span>     <span class="literal">Yes</span>     <span class="string">RaWBD</span> <span class="string">R</span>   <span class="string">OFF</span> <span class="number">278.875</span> <span class="string">GB</span>      </span><br><span class="line"><span class="number">1</span><span class="string">/1</span>   <span class="string">RAID5</span> <span class="string">Optl</span>  <span class="string">RW</span>     <span class="literal">Yes</span>     <span class="string">RaWBD</span> <span class="string">R</span>   <span class="string">OFF</span>   <span class="number">4.089</span> <span class="string">TB</span>      </span><br><span class="line"><span class="number">2</span><span class="string">/2</span>   <span class="string">RAID5</span> <span class="string">Optl</span>  <span class="string">RW</span>     <span class="literal">Yes</span>     <span class="string">RaWBD</span> <span class="string">R</span>   <span class="string">OFF</span>   <span class="number">4.089</span> <span class="string">TB</span>      </span><br><span class="line"><span class="string">---------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Cac=CacheCade|Rec=Recovery|OfLn=OffLine|Pdgd=Partially</span> <span class="string">Degraded|dgrd=Degraded</span></span><br><span class="line"><span class="string">Optl=Optimal|RO=Read</span> <span class="string">Only|RW=Read</span> <span class="string">Write|B=Blocked|Consist=Consistent|</span></span><br><span class="line"><span class="string">Ra=Read</span> <span class="string">Ahead</span> <span class="string">Adaptive|R=Read</span> <span class="string">Ahead</span> <span class="string">Always|NR=No</span> <span class="string">Read</span> <span class="string">Ahead|WB=WriteBack|</span></span><br><span class="line"><span class="string">AWB=Always</span> <span class="string">WriteBack|WT=WriteThrough|C=Cached</span> <span class="string">IO|D=Direct</span> <span class="string">IO|sCC=Scheduled</span></span><br><span class="line"><span class="string">Check</span> <span class="string">Consistency</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Physical</span> <span class="string">Drives</span> <span class="string">=</span> <span class="number">14</span><span class="string">【十四个物理磁盘】</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">PD LIST :</span></span><br><span class="line"><span class="string">=======</span></span><br><span class="line"> </span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">EID:Slt</span> <span class="string">DID</span> <span class="string">State</span> <span class="string">DG</span>       <span class="string">Size</span> <span class="string">Intf</span> <span class="string">Med</span> <span class="string">SED</span> <span class="string">PI</span> <span class="string">SeSz</span> <span class="string">Model</span>            <span class="string">Sp</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"><span class="number">32</span><span class="string">:0</span>      <span class="number">0</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:1</span>      <span class="number">1</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:2</span>      <span class="number">2</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:3</span>      <span class="number">3</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:4</span>      <span class="number">4</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:5</span>      <span class="number">5</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:6</span>      <span class="number">6</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:7</span>      <span class="number">7</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:8</span>      <span class="number">8</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:9</span>      <span class="number">9</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:10</span>    <span class="number">10</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:11</span>    <span class="number">11</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:24</span>    <span class="number">24</span> <span class="string">Onln</span>   <span class="number">0</span> <span class="number">278.875</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">ST9300603SS</span>      <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:25</span>    <span class="number">25</span> <span class="string">Onln</span>   <span class="number">0</span> <span class="number">278.875</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">ST9300605SS</span>      <span class="string">U</span>  </span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">EID-Enclosure</span> <span class="string">Device</span> <span class="string">ID|Slt-Slot</span> <span class="literal">No</span>.<span class="string">|DID-Device</span> <span class="string">ID|DG-DriveGroup</span></span><br><span class="line"><span class="string">DHS-Dedicated</span> <span class="string">Hot</span> <span class="string">Spare|UGood-Unconfigured</span> <span class="string">Good|GHS-Global</span> <span class="string">Hotspare</span></span><br><span class="line"><span class="string">UBad-Unconfigured</span> <span class="string">Bad|Onln-Online|Offln-Offline|Intf-Interface</span></span><br><span class="line"><span class="string">Med-Media</span> <span class="string">Type|SED-Self</span> <span class="string">Encryptive</span> <span class="string">Drive|PI-Protection</span> <span class="string">Info</span></span><br><span class="line"><span class="string">SeSz-Sector</span> <span class="string">Size|Sp-Spun|U-Up|D-Down|T-Transition|F-Foreign</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">BBU_Info :</span></span><br><span class="line"><span class="string">========</span></span><br><span class="line"> </span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line"><span class="string">Model</span> <span class="string">State</span>   <span class="string">RetentionTime</span> <span class="string">Temp</span> <span class="string">Mode</span> <span class="string">MfgDate</span>    <span class="string">Next</span> <span class="string">Learn</span></span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line"><span class="string">BBU</span>   <span class="string">Optimal</span> <span class="number">0</span> <span class="string">hour(s)</span>     <span class="string">30C</span>  <span class="number">0</span>    <span class="number">2011</span><span class="string">/07/18</span> <span class="string">None</span>       </span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="number">4</span><span class="string">、获取enclosure信息</span></span><br><span class="line"><span class="string">硬盘大多是附在enclosure上不是直接附在controller上。</span></span><br><span class="line"> </span><br><span class="line"><span class="string">显示所有的enclosure信息，但是系统中只有一个enclosure</span> <span class="string">，EID:32.</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">./storcli64</span> <span class="string">/c0/eall</span> <span class="string">show</span>   </span><br><span class="line"><span class="string">Controller</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">Status</span> <span class="string">=</span> <span class="string">Success</span></span><br><span class="line"><span class="string">Description</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">Properties :</span></span><br><span class="line"><span class="string">==========</span></span><br><span class="line"> </span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">EID</span> <span class="string">State</span> <span class="string">Slots</span> <span class="string">PD</span> <span class="string">PS</span> <span class="string">Fans</span> <span class="string">TSs</span> <span class="string">Alms</span> <span class="string">SIM</span> <span class="string">Port#</span>       <span class="string">ProdID</span>    <span class="string">VendorSpecific</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="number">32</span> <span class="string">OK</span>       <span class="number">26</span> <span class="number">14</span>  <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span> <span class="string">Unavailable</span> <span class="string">BP12G+EXP</span>                </span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">EID-Enclosure</span> <span class="string">Device</span> <span class="string">ID</span> <span class="string">|PD-Physical</span> <span class="string">drive</span> <span class="string">count</span> <span class="string">|PS-Power</span> <span class="string">Supply</span> <span class="string">count|</span></span><br><span class="line"><span class="string">TSs-Temperature</span> <span class="string">sensor</span> <span class="string">count</span> <span class="string">|Alms-Alarm</span> <span class="string">count</span> <span class="string">|SIM-SIM</span> <span class="string">Count</span></span><br><span class="line"> </span><br><span class="line"><span class="string">获取单个enclosure</span>  <span class="string">,e32详细信息</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">./storcli64</span> <span class="string">/c0/e32</span> <span class="string">show</span> <span class="string">all</span></span><br><span class="line"><span class="string">Controller</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">Status</span> <span class="string">=</span> <span class="string">Success</span></span><br><span class="line"><span class="string">Description</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Enclosure</span> <span class="string">/c0/e32</span>  <span class="string">:</span></span><br><span class="line"><span class="string">==================</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">Information :</span></span><br><span class="line"><span class="string">===========</span></span><br><span class="line"><span class="string">Device</span> <span class="string">ID</span> <span class="string">=</span> <span class="number">32</span></span><br><span class="line"><span class="string">Position</span> <span class="string">=</span> <span class="number">1</span></span><br><span class="line"><span class="string">Connector</span> <span class="string">Name</span> <span class="string">=</span> <span class="string">Unavailable</span></span><br><span class="line"><span class="string">Enclosure</span> <span class="string">Type</span> <span class="string">=</span> <span class="string">SES</span></span><br><span class="line"><span class="string">Status</span> <span class="string">=</span> <span class="string">OK</span></span><br><span class="line"><span class="string">FRU</span> <span class="string">Part</span> <span class="string">Number</span> <span class="string">=</span> <span class="string">N/A</span></span><br><span class="line"><span class="string">Enclosure</span> <span class="string">Serial</span> <span class="string">Number</span> <span class="string">=</span> <span class="string">N/A</span></span><br><span class="line"><span class="string">ESM</span> <span class="string">Serial</span> <span class="string">Number</span> <span class="string">=</span> <span class="string">N/A</span></span><br><span class="line"><span class="string">Enclosure</span> <span class="string">Zoning</span> <span class="string">Mode</span> <span class="string">=</span> <span class="string">N/A</span></span><br><span class="line"><span class="string">Partner</span> <span class="string">Device</span> <span class="string">ID</span> <span class="string">=</span> <span class="number">65535</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">Inquiry Data :</span></span><br><span class="line"><span class="string">============</span></span><br><span class="line"><span class="string">Vendor</span> <span class="string">Identification</span> <span class="string">=</span> <span class="string">DP</span></span><br><span class="line"><span class="string">Product</span> <span class="string">Identification</span> <span class="string">=</span> <span class="string">BP12G+EXP</span></span><br><span class="line"><span class="string">Product</span> <span class="string">Revision</span> <span class="string">Level</span> <span class="string">=</span> <span class="number">1.07</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">Properties :</span></span><br><span class="line"><span class="string">==========</span></span><br><span class="line"> </span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">EID</span> <span class="string">State</span> <span class="string">Slots</span> <span class="string">PD</span> <span class="string">PS</span> <span class="string">Fans</span> <span class="string">TSs</span> <span class="string">Alms</span> <span class="string">SIM</span> <span class="string">Port#</span>       <span class="string">ProdID</span>    <span class="string">VendorSpecific</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="number">32</span> <span class="string">OK</span>       <span class="number">26</span> <span class="number">14</span>  <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span> <span class="string">Unavailable</span> <span class="string">BP12G+EXP</span>                </span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="string">EID-Enclosure</span> <span class="string">Device</span> <span class="string">ID</span> <span class="string">|PD-Physical</span> <span class="string">drive</span> <span class="string">count</span> <span class="string">|PS-Power</span> <span class="string">Supply</span> <span class="string">count|</span></span><br><span class="line"><span class="string">TSs-Temperature</span> <span class="string">sensor</span> <span class="string">count</span> <span class="string">|Alms-Alarm</span> <span class="string">count</span> <span class="string">|SIM-SIM</span> <span class="string">Count</span></span><br><span class="line"> </span><br><span class="line"><span class="number">5</span><span class="string">、显示物理磁盘信息</span></span><br><span class="line"><span class="string">语法：storcli64</span>  <span class="string">/cx/eall/sall</span> <span class="string">show</span>　　<span class="string">显示所有物理磁盘信息</span></span><br><span class="line"> </span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">./storcli64</span> <span class="string">/c0/e32/sall</span>   <span class="string">show</span> <span class="string">【显示e32上的所有物理硬盘】</span> </span><br><span class="line"> </span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">./storcli64</span> <span class="string">/c0/eall/sall</span> <span class="string">show【显示所有enclosure下的所有物理硬盘】</span></span><br><span class="line"><span class="string">Controller</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">Status</span> <span class="string">=</span> <span class="string">Success</span></span><br><span class="line"><span class="string">Description</span> <span class="string">=</span> <span class="string">Show</span> <span class="string">Drive</span> <span class="string">Information</span> <span class="string">Succeeded.</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">Drive Information :</span></span><br><span class="line"><span class="string">=================</span></span><br><span class="line"> </span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">EID:Slt</span> <span class="string">DID</span> <span class="string">State</span> <span class="string">DG</span>       <span class="string">Size</span> <span class="string">Intf</span> <span class="string">Med</span> <span class="string">SED</span> <span class="string">PI</span> <span class="string">SeSz</span> <span class="string">Model</span>            <span class="string">Sp</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"><span class="number">32</span><span class="string">:0</span>      <span class="number">0</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:1</span>      <span class="number">1</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:2</span>      <span class="number">2</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:3</span>      <span class="number">3</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:4</span>      <span class="number">4</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:5</span>      <span class="number">5</span> <span class="string">Onln</span>   <span class="number">1</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:6</span>      <span class="number">6</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:7</span>      <span class="number">7</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:8</span>      <span class="number">8</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:9</span>      <span class="number">9</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:10</span>    <span class="number">10</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:11</span>    <span class="number">11</span> <span class="string">Onln</span>   <span class="number">2</span>  <span class="number">837.75</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">WD9001BKHG</span>       <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:24</span>    <span class="number">24</span> <span class="string">Onln</span>   <span class="number">0</span> <span class="number">278.875</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">ST9300603SS</span>      <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:25</span>    <span class="number">25</span> <span class="string">Onln</span>   <span class="number">0</span> <span class="number">278.875</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">ST9300605SS</span>      <span class="string">U</span>  </span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">EID-Enclosure</span> <span class="string">Device</span> <span class="string">ID|Slt-Slot</span> <span class="literal">No</span>.<span class="string">|DID-Device</span> <span class="string">ID|DG-DriveGroup</span></span><br><span class="line"><span class="string">DHS-Dedicated</span> <span class="string">Hot</span> <span class="string">Spare|UGood-Unconfigured</span> <span class="string">Good|GHS-Global</span> <span class="string">Hotspare【表示有热备盘，DHS专有热备，GHS全局热备】</span></span><br><span class="line"><span class="string">UBad-Unconfigured</span> <span class="string">Bad|Onln-Online|Offln-Offline|Intf-Interface</span></span><br><span class="line"><span class="string">Med-Media</span> <span class="string">Type|SED-Self</span> <span class="string">Encryptive</span> <span class="string">Drive|PI-Protection</span> <span class="string">Info</span></span><br><span class="line"><span class="string">SeSz-Sector</span> <span class="string">Size|Sp-Spun|U-Up|D-Down|T-Transition|F-Foreign</span></span><br><span class="line"> </span><br><span class="line"><span class="string">从上面信息，可以看出：</span></span><br><span class="line"></span><br><span class="line"><span class="string">只有一个控制器，id</span> <span class="string">为</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="string">EID，Enclosure</span> <span class="string">Device</span> <span class="string">ID</span> <span class="string">：32</span></span><br><span class="line"></span><br><span class="line"><span class="string">Slot</span> <span class="string">Number，能看到</span> <span class="number">0</span><span class="string">,1,2,3,4,5,6,7,8,9,10,11,24,25</span></span><br><span class="line"></span><br><span class="line"><span class="string">DG：disk</span> <span class="string">group，0,1,2</span></span><br><span class="line"></span><br><span class="line"><span class="string">size：容量，磁盘容量</span></span><br><span class="line"></span><br><span class="line"><span class="string">intf：接口，SAS</span></span><br><span class="line"></span><br><span class="line"><span class="string">Med：介质，ssd</span> <span class="string">或</span> <span class="string">hdd</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="number">6</span><span class="string">、查看raid组详细信息</span></span><br><span class="line"> </span><br><span class="line"><span class="string">查看系统里面有几个raid组：</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">./storcli64</span> <span class="string">/c0/vall</span>  <span class="string">show</span> <span class="string">【查看c0控制下的所有RAID信息】</span></span><br><span class="line"><span class="string">Controller</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">Status</span> <span class="string">=</span> <span class="string">Success</span></span><br><span class="line"><span class="string">Description</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">Virtual Drives :</span></span><br><span class="line"><span class="string">==============</span></span><br><span class="line"> </span><br><span class="line"><span class="string">---------------------------------------------------------------</span></span><br><span class="line"><span class="string">DG/VD</span> <span class="string">TYPE</span>  <span class="string">State</span> <span class="string">Access</span> <span class="string">Consist</span> <span class="string">Cache</span> <span class="string">Cac</span> <span class="string">sCC</span>       <span class="string">Size</span> <span class="string">Name</span></span><br><span class="line"><span class="string">---------------------------------------------------------------</span></span><br><span class="line"><span class="number">0</span><span class="string">/0</span>   <span class="string">RAID1</span> <span class="string">Optl</span>  <span class="string">RW</span>     <span class="literal">Yes</span>     <span class="string">RaWBD</span> <span class="string">R</span>   <span class="string">OFF</span> <span class="number">278.875</span> <span class="string">GB</span>      </span><br><span class="line"><span class="number">1</span><span class="string">/1</span>   <span class="string">RAID5</span> <span class="string">Optl</span>  <span class="string">RW</span>     <span class="literal">Yes</span>     <span class="string">RaWBD</span> <span class="string">R</span>   <span class="string">OFF</span>   <span class="number">4.089</span> <span class="string">TB</span>      </span><br><span class="line"><span class="number">2</span><span class="string">/2</span>   <span class="string">RAID5</span> <span class="string">Optl</span>  <span class="string">RW</span>     <span class="literal">Yes</span>     <span class="string">RaWBD</span> <span class="string">R</span>   <span class="string">OFF</span>   <span class="number">4.089</span> <span class="string">TB</span>      <span class="string">【显示系统有三个raid组】</span></span><br><span class="line"><span class="string">---------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Cac=CacheCade|Rec=Recovery|OfLn=OffLine|Pdgd=Partially</span> <span class="string">Degraded|dgrd=Degraded</span></span><br><span class="line"><span class="string">Optl=Optimal|RO=Read</span> <span class="string">Only|RW=Read</span> <span class="string">Write|B=Blocked|Consist=Consistent|</span></span><br><span class="line"><span class="string">Ra=Read</span> <span class="string">Ahead</span> <span class="string">Adaptive|R=Read</span> <span class="string">Ahead</span> <span class="string">Always|NR=No</span> <span class="string">Read</span> <span class="string">Ahead|WB=WriteBack|</span></span><br><span class="line"><span class="string">AWB=Always</span> <span class="string">WriteBack|WT=WriteThrough|C=Cached</span> <span class="string">IO|D=Direct</span> <span class="string">IO|sCC=Scheduled</span></span><br><span class="line"><span class="string">Check</span> <span class="string">Consistency</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="string">查看V0</span>  <span class="string">（虚拟磁盘0）</span> <span class="string">raid的详细信息</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">./storcli64</span> <span class="string">/c0/v0</span> <span class="string">show</span> <span class="string">all</span></span><br><span class="line"><span class="string">Controller</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">Status</span> <span class="string">=</span> <span class="string">Success</span></span><br><span class="line"><span class="string">Description</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="string">/c0/v0</span> <span class="string">:</span></span><br><span class="line"><span class="string">======</span></span><br><span class="line"> </span><br><span class="line"><span class="string">---------------------------------------------------------------</span></span><br><span class="line"><span class="string">DG/VD</span> <span class="string">TYPE</span>  <span class="string">State</span> <span class="string">Access</span> <span class="string">Consist</span> <span class="string">Cache</span> <span class="string">Cac</span> <span class="string">sCC</span>       <span class="string">Size</span> <span class="string">Name</span></span><br><span class="line"><span class="string">---------------------------------------------------------------</span></span><br><span class="line"><span class="number">0</span><span class="string">/0</span>   <span class="string">RAID1</span> <span class="string">Optl</span>  <span class="string">RW</span>     <span class="literal">Yes</span>     <span class="string">RaWBD</span> <span class="string">R</span>   <span class="string">OFF</span> <span class="number">278.875</span> <span class="string">GB</span>      <span class="string">【V0为RAID1】</span></span><br><span class="line"><span class="string">---------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">Cac=CacheCade|Rec=Recovery|OfLn=OffLine|Pdgd=Partially</span> <span class="string">Degraded|dgrd=Degraded</span></span><br><span class="line"><span class="string">Optl=Optimal|RO=Read</span> <span class="string">Only|RW=Read</span> <span class="string">Write|B=Blocked|Consist=Consistent|</span></span><br><span class="line"><span class="string">Ra=Read</span> <span class="string">Ahead</span> <span class="string">Adaptive|R=Read</span> <span class="string">Ahead</span> <span class="string">Always|NR=No</span> <span class="string">Read</span> <span class="string">Ahead|WB=WriteBack|</span></span><br><span class="line"><span class="string">AWB=Always</span> <span class="string">WriteBack|WT=WriteThrough|C=Cached</span> <span class="string">IO|D=Direct</span> <span class="string">IO|sCC=Scheduled</span></span><br><span class="line"><span class="string">Check</span> <span class="string">Consistency</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">PDs for VD 0 :</span></span><br><span class="line"><span class="string">============</span></span><br><span class="line"> </span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">EID:Slt</span> <span class="string">DID</span> <span class="string">State</span> <span class="string">DG</span>       <span class="string">Size</span> <span class="string">Intf</span> <span class="string">Med</span> <span class="string">SED</span> <span class="string">PI</span> <span class="string">SeSz</span> <span class="string">Model</span>            <span class="string">Sp</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"><span class="number">32</span><span class="string">:24</span>    <span class="number">24</span> <span class="string">Onln</span>   <span class="number">0</span> <span class="number">278.875</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">ST9300603SS</span>      <span class="string">U</span>  </span><br><span class="line"><span class="number">32</span><span class="string">:25</span>    <span class="number">25</span> <span class="string">Onln</span>   <span class="number">0</span> <span class="number">278.875</span> <span class="string">GB</span> <span class="string">SAS</span>  <span class="string">HDD</span> <span class="string">N</span>   <span class="string">N</span>  <span class="string">512B</span> <span class="string">ST9300605SS</span>      <span class="string">U</span>  <span class="string">【可以看到24号和25号盘组成了raid1】</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">EID-Enclosure</span> <span class="string">Device</span> <span class="string">ID|Slt-Slot</span> <span class="literal">No</span>.<span class="string">|DID-Device</span> <span class="string">ID|DG-DriveGroup</span></span><br><span class="line"><span class="string">DHS-Dedicated</span> <span class="string">Hot</span> <span class="string">Spare|UGood-Unconfigured</span> <span class="string">Good|GHS-Global</span> <span class="string">Hotspare</span></span><br><span class="line"><span class="string">UBad-Unconfigured</span> <span class="string">Bad|Onln-Online|Offln-Offline|Intf-Interface</span></span><br><span class="line"><span class="string">Med-Media</span> <span class="string">Type|SED-Self</span> <span class="string">Encryptive</span> <span class="string">Drive|PI-Protection</span> <span class="string">Info</span></span><br><span class="line"><span class="string">SeSz-Sector</span> <span class="string">Size|Sp-Spun|U-Up|D-Down|T-Transition|F-Foreign</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">VD0 Properties :</span></span><br><span class="line"><span class="string">==============</span></span><br><span class="line"><span class="string">Strip</span> <span class="string">Size</span> <span class="string">=</span> <span class="number">64</span> <span class="string">KB</span></span><br><span class="line"><span class="string">Span</span> <span class="string">Depth</span> <span class="string">=</span> <span class="number">1</span></span><br><span class="line"><span class="string">Number</span> <span class="string">of</span> <span class="string">Drives</span> <span class="string">Per</span> <span class="string">Span</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">Disk</span> <span class="string">Cache</span> <span class="string">Policy</span> <span class="string">=</span> <span class="string">Disk's</span> <span class="string">Default</span></span><br><span class="line"><span class="string">Encryption</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">Data</span> <span class="string">Protection</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">Active</span> <span class="string">Operations</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">Exposed</span> <span class="string">to</span> <span class="string">OS</span> <span class="string">=</span> <span class="literal">Yes</span></span><br><span class="line"><span class="string">Creation</span> <span class="string">Date</span> <span class="string">=</span> <span class="number">05</span><span class="number">-09</span><span class="number">-2012</span></span><br><span class="line"><span class="string">Creation</span> <span class="string">Time</span> <span class="string">=</span> <span class="number">01</span><span class="string">:38:23</span> <span class="string">PM</span></span><br><span class="line"><span class="string">Emulation</span> <span class="string">type</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"> </span><br><span class="line"><span class="number">7</span><span class="string">、磁盘状态设置</span></span><br><span class="line"><span class="string">storcli64</span>    <span class="string">/cx/ex/sx</span>    <span class="string">set</span>    <span class="string">good/offline/online/missing</span>　　<span class="string">设置某块磁盘的状态</span></span><br><span class="line"><span class="string">good</span>　　　　　 　　<span class="string">空闲</span></span><br><span class="line"><span class="string">online/offline</span>　　     <span class="string">成员盘上下线</span></span><br><span class="line"><span class="string">missing</span>　　　　        <span class="string">设置磁盘为missing状态</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="string">磁盘热备</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/ex/sx</span> <span class="string">add</span> <span class="string">hotsparedrive</span> <span class="string">dgs=x</span>　　<span class="string">设置模块磁盘为diskgroup</span> <span class="string">x</span> <span class="string">的热备盘</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/ex/sx</span> <span class="string">add</span> <span class="string">hotsparedrive</span>           <span class="string">设置全局热备</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/ex/sx</span> <span class="string">delete</span> <span class="string">hotsparedrive</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="string">磁盘rebuild</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/ex/sx</span> <span class="string">show</span> <span class="string">rebuild</span>　　<span class="string">查看rebild</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/ex/sx</span> <span class="string">start</span> <span class="string">rebuild</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/ex/sx</span> <span class="string">stop</span> <span class="string">rebuild</span></span><br><span class="line"> </span><br><span class="line"><span class="string">磁盘点灯</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/ex/sx</span> <span class="string">start</span> <span class="string">locate</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/ex/sx</span> <span class="string">stop</span> <span class="string">locate</span></span><br><span class="line"> </span><br><span class="line"><span class="string">磁盘擦除</span></span><br><span class="line"><span class="string">快速擦除：</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/ex/sx</span> <span class="string">set</span> <span class="string">good</span></span><br><span class="line"><span class="string">storcli64</span> <span class="string">/cx/fall</span> <span class="string">del|delete</span> <span class="string">[securityKey</span> <span class="string">=</span> <span class="string">xxx]</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="string">完全擦除：</span></span><br><span class="line"><span class="string">storcli</span> <span class="string">/cx[/ex]/sx</span> <span class="string">secureerase</span> <span class="string">[force]</span></span><br><span class="line"><span class="string">storcli</span> <span class="string">/cx[/ex]/sx</span> <span class="string">start</span> <span class="string">erase</span> <span class="string">[simple|</span> <span class="string">normal|</span> <span class="string">thorough</span> <span class="string">|</span> <span class="string">standard|</span> <span class="string">threepass</span> <span class="string">|</span> <span class="string">crypto]</span></span><br><span class="line"><span class="string">storcli</span> <span class="string">/cx[/ex]/sx</span> <span class="string">stop</span> <span class="string">erase</span></span><br><span class="line"><span class="string">storcli</span> <span class="string">/cx[/ex]/sx</span> <span class="string">show</span> <span class="string">erase</span></span><br><span class="line"> </span><br><span class="line"><span class="number">8</span><span class="string">、获取rebuild速率</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">storcli]#</span> <span class="string">./storcli64</span>  <span class="string">/c0</span> <span class="string">show</span> <span class="string">rebuildrate</span></span><br><span class="line"><span class="string">Controller</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="string">Status</span> <span class="string">=</span> <span class="string">Success</span></span><br><span class="line"><span class="string">Description</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">Controller Properties :</span></span><br><span class="line"><span class="string">=====================</span></span><br><span class="line"></span><br><span class="line"><span class="string">------------------</span></span><br><span class="line"><span class="string">Ctrl_Prop</span>   <span class="string">Value</span></span><br><span class="line"><span class="string">------------------</span></span><br><span class="line"><span class="string">Rebuildrate</span> <span class="number">30</span><span class="string">%</span>   </span><br><span class="line"><span class="string">------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="string">storcli64</span>   <span class="string">/c0</span>  <span class="string">set</span>  <span class="string">rebuildrate=60</span>　　<span class="string">设置rebuild速率</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="number">9</span><span class="string">、清除缓存</span></span><br><span class="line"><span class="string">清除raid卡，物理磁盘cache</span></span><br><span class="line"><span class="string">storcli64</span>   <span class="string">/c0</span>    <span class="string">flushcache</span></span><br><span class="line"><span class="string">苦难并非乐事，但能者等闲视之，人生本来就是苦中作乐，切莫长吁短叹，虚度年华。</span></span><br></pre></td></tr></table></figure>

<h3 id="MegaCli"><a href="#MegaCli" class="headerlink" title="MegaCli"></a>MegaCli</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">MegaCli使用参考文档(版本包见附件)</span></span><br><span class="line"><span class="string">安装megacli</span></span><br><span class="line"><span class="string">下载megacli时，同时包含了一个依赖包。安装megacli时需要安装该包。</span></span><br><span class="line"></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">~]#</span> <span class="string">rpm</span> <span class="string">-ivh</span> <span class="string">Lib_Utils-1.00-08.noarch.rpm</span> </span><br><span class="line"><span class="string">Preparing...</span>                <span class="comment">########################################### [100%]</span></span><br><span class="line"><span class="string">Installing....</span></span><br><span class="line">   <span class="number">1</span><span class="string">:Lib_Utils</span>              <span class="comment">########################################### [100%]</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">~]#</span> <span class="string">cd</span> <span class="string">/</span></span><br><span class="line"> <span class="string">[root@localhost</span> <span class="string">/]#</span> <span class="string">rpm</span> <span class="string">-ivh</span> <span class="string">MegaCli-8.00.23-1.i386.rpm</span> </span><br><span class="line"><span class="string">Preparing...</span>                <span class="comment">########################################### [100%]</span></span><br><span class="line">   <span class="number">1</span><span class="string">:MegaCli</span>                <span class="comment">########################################### [100%]</span></span><br><span class="line"><span class="string">注：开机自检时，使用ctrl+y也可直接进入命令行配置界面。</span></span><br><span class="line"><span class="string">megacli使用</span></span><br><span class="line"><span class="string">安装megacli后，megacli程序自动安装到/opt/MegaRAID/MegaCli目录下。</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">pwd</span></span><br><span class="line"><span class="string">/opt/MegaRAID/MegaCli</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">ls</span></span><br><span class="line"><span class="string">install.log</span>  <span class="string">MegaCli64</span></span><br><span class="line"><span class="string">查看MegaCli64是一个可以执行的程序，如不可以，使用chmod添加权限即可（chmod</span> <span class="number">755</span> <span class="string">Megacli64）。</span></span><br><span class="line"><span class="string">注意,，ctrl|+y进入命令行后需要区分大小写，系统下megacli不需要区分大小写。</span></span><br><span class="line"></span><br><span class="line"><span class="string">使用./MegaCli64</span> <span class="string">–help或者./Megacli64</span> <span class="string">–h查看命令帮助。</span></span><br><span class="line"><span class="string">查看硬盘列表</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">./MegaCli64</span> <span class="string">-PDList</span> <span class="string">-aALL</span></span><br><span class="line"> <span class="string">Adapter</span> <span class="comment">#0</span></span><br><span class="line"><span class="attr">Enclosure Device ID:</span> <span class="number">252</span><span class="string">----背板</span></span><br><span class="line"><span class="attr">Slot Number:</span> <span class="number">0</span><span class="string">-----硬盘位置</span></span><br><span class="line"><span class="attr">Device Id:</span> <span class="number">176</span></span><br><span class="line"><span class="attr">Sequence Number:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">Media Error Count:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">Other Error Count:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">Predictive Failure Count:</span> <span class="number">0</span><span class="string">----上面三行查看硬盘是否有坏道以及smart报错。</span></span><br><span class="line"><span class="attr">Last Predictive Failure Event Seq Number:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">PD Type:</span> <span class="string">SATA</span></span><br><span class="line"><span class="attr">Raw Size:</span> <span class="number">931.512</span> <span class="string">GB</span> <span class="string">[0x74706db0</span> <span class="string">Sectors]</span></span><br><span class="line"><span class="attr">Non Coerced Size:</span> <span class="number">931.012</span> <span class="string">GB</span> <span class="string">[0x74606db0</span> <span class="string">Sectors]</span></span><br><span class="line"><span class="attr">Coerced Size:</span> <span class="number">930.390</span> <span class="string">GB</span> <span class="string">[0x744c8000</span> <span class="string">Sectors]</span></span><br><span class="line"><span class="attr">Firmware state:</span> <span class="string">Unconfigured(good),</span> <span class="string">Spun</span> <span class="string">Up---显示硬盘状态，单独硬盘还是raid中，Firmware</span> <span class="attr">state:</span> <span class="string">Online,</span> <span class="string">Spun</span> <span class="string">Up（raid中）</span></span><br><span class="line"><span class="string">SAS</span> <span class="string">Address(0):</span> <span class="number">0x9281c06686c5355</span></span><br><span class="line"><span class="attr">Connected Port Number:</span> <span class="number">0</span><span class="string">(path0)</span> </span><br><span class="line"><span class="attr">Inquiry Data:</span>             <span class="string">9WK0CC10ST31000524NS</span>                            <span class="string">SN11</span>    </span><br><span class="line"><span class="attr">FDE Capable:</span> <span class="string">Not</span> <span class="string">Capable</span></span><br><span class="line"><span class="attr">FDE Enable:</span> <span class="string">Disable</span></span><br><span class="line"><span class="attr">Secured:</span> <span class="string">Unsecured</span></span><br><span class="line"><span class="attr">Locked:</span> <span class="string">Unlocked</span></span><br><span class="line"><span class="attr">Needs EKM Attention:</span> <span class="literal">No</span></span><br><span class="line"><span class="attr">Foreign State:</span> <span class="string">None</span> </span><br><span class="line"><span class="attr">Device Speed:</span> <span class="number">3.</span><span class="string">0Gb/s</span> </span><br><span class="line"><span class="attr">Link Speed:</span> <span class="number">3.</span><span class="string">0Gb/s</span> </span><br><span class="line"><span class="attr">Media Type:</span> <span class="string">Hard</span> <span class="string">Disk</span> <span class="string">Device</span></span><br><span class="line"></span><br><span class="line"><span class="string">创建raid</span></span><br><span class="line"><span class="string">./MegaCli</span> <span class="string">-CfgLdAdd</span> <span class="string">-rX[E0:S0,E1:S1,...]</span> <span class="string">[WT|WB]</span> <span class="string">[NORA|RA|ADRA]</span> <span class="string">[Direct|Cached]</span></span><br><span class="line">        <span class="string">[CachedBadBBU|NoCachedBadBBU]</span> <span class="string">[-szXXX</span> <span class="string">[-szYYY</span> <span class="string">...]]</span></span><br><span class="line">        <span class="string">[-strpszM]</span> <span class="string">[-Hsp[E0:S0,...]]</span> <span class="string">[-AfterLdX]</span> <span class="string">[-Force]|[FDE|CtrlBased]</span> <span class="string">–aN</span></span><br><span class="line"><span class="string">非红色部分，如果不填写则使用默认配置，如背板显示不出来，则使用空格代替即可。</span></span><br><span class="line"><span class="string">[-szXXX</span> <span class="string">[-szYYY</span> <span class="string">...]]</span>  <span class="string">直接写数字即可，后面省略M，本身代表M。</span></span><br><span class="line"></span><br><span class="line"><span class="string">例如使用四块硬盘创建一个raid5</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">./MegaCli64</span>  <span class="string">-CfgLdadd</span> <span class="string">-r5[252:0,252:1,252:2,</span> <span class="number">252</span><span class="string">:3]</span> <span class="string">-a0</span></span><br><span class="line">                                     </span><br><span class="line"><span class="attr">Adapter 0:</span> <span class="string">Created</span> <span class="string">VD</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Adapter 0:</span> <span class="string">Configured</span> <span class="string">the</span> <span class="string">Adapter!!</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Exit Code:</span> <span class="number">0x00</span></span><br><span class="line"><span class="string">查看raid状态</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">./MegaCli64</span>  <span class="string">-ldinfo</span> <span class="string">-lall</span> <span class="string">-a0</span></span><br><span class="line">                                     </span><br><span class="line"><span class="attr">Adapter 0 -- Virtual Drive Information:</span></span><br><span class="line"><span class="attr">Virtual Drive:</span> <span class="number">0</span> <span class="string">(Target</span> <span class="attr">Id:</span> <span class="number">0</span><span class="string">)</span></span><br><span class="line"><span class="attr">Name                :</span></span><br><span class="line"><span class="attr">RAID Level          :</span> <span class="string">Primary-5,</span> <span class="string">Secondary-0,</span> <span class="string">RAID</span> <span class="string">Level</span> <span class="string">Qualifier-3</span></span><br><span class="line"><span class="attr">Size                :</span> <span class="number">2.725</span> <span class="string">TB</span></span><br><span class="line"><span class="attr">State               :</span> <span class="string">Optimal</span></span><br><span class="line"><span class="attr">Stripe Size         :</span> <span class="number">64</span> <span class="string">KB</span></span><br><span class="line"><span class="attr">Number Of Drives    :</span> <span class="number">4</span></span><br><span class="line"><span class="attr">Span Depth          :</span> <span class="number">1</span></span><br><span class="line"><span class="attr">Default Cache Policy:</span> <span class="string">WriteBack,</span> <span class="string">ReadAheadNone,</span> <span class="string">Direct,</span> <span class="literal">No</span> <span class="string">Write</span> <span class="string">Cache</span> <span class="string">if</span> <span class="string">Bad</span> <span class="string">BBU</span></span><br><span class="line"><span class="attr">Current Cache Policy:</span> <span class="string">WriteThrough,</span> <span class="string">ReadAheadNone,</span> <span class="string">Direct,</span> <span class="literal">No</span> <span class="string">Write</span> <span class="string">Cache</span> <span class="string">if</span> <span class="string">Bad</span> <span class="string">BBU</span></span><br><span class="line"><span class="attr">Access Policy       :</span> <span class="string">Read/Write</span></span><br><span class="line"><span class="attr">Disk Cache Policy   :</span> <span class="string">Disk's</span> <span class="string">Default</span></span><br><span class="line"><span class="attr">Encryption Type     :</span> <span class="string">None</span></span><br><span class="line"><span class="attr">Exit Code:</span> <span class="number">0x00</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">./MegaCli64</span>  <span class="string">-ldinfo</span> <span class="string">-l0</span> <span class="string">-a0</span></span><br><span class="line">                                     </span><br><span class="line"><span class="attr">Adapter 0 -- Virtual Drive Information:</span></span><br><span class="line"><span class="attr">Virtual Drive:</span> <span class="number">0</span> <span class="string">(Target</span> <span class="attr">Id:</span> <span class="number">0</span><span class="string">)</span></span><br><span class="line"><span class="attr">Name                :</span></span><br><span class="line"><span class="attr">RAID Level          :</span> <span class="string">Primary-1,</span> <span class="string">Secondary-0,</span> <span class="string">RAID</span> <span class="string">Level</span> <span class="string">Qualifier-0</span></span><br><span class="line"><span class="attr">Size                :</span> <span class="number">930.390</span> <span class="string">GB</span></span><br><span class="line"><span class="attr">State               :</span> <span class="string">Optimal</span></span><br><span class="line"><span class="attr">Stripe Size         :</span> <span class="number">64</span> <span class="string">KB</span></span><br><span class="line"><span class="attr">Number Of Drives    :</span> <span class="number">2</span></span><br><span class="line"><span class="attr">Span Depth          :</span> <span class="number">1</span></span><br><span class="line"><span class="attr">Default Cache Policy:</span> <span class="string">WriteBack,</span> <span class="string">ReadAheadNone,</span> <span class="string">Direct,</span> <span class="literal">No</span> <span class="string">Write</span> <span class="string">Cache</span> <span class="string">if</span> <span class="string">Bad</span> <span class="string">BBU</span></span><br><span class="line"><span class="attr">Current Cache Policy:</span> <span class="string">WriteThrough,</span> <span class="string">ReadAheadNone,</span> <span class="string">Direct,</span> <span class="literal">No</span> <span class="string">Write</span> <span class="string">Cache</span> <span class="string">if</span> <span class="string">Bad</span> <span class="string">BBU</span></span><br><span class="line"><span class="attr">Access Policy       :</span> <span class="string">Read/Write</span></span><br><span class="line"><span class="attr">Disk Cache Policy   :</span> <span class="string">Disk's</span> <span class="string">Default</span></span><br><span class="line"><span class="attr">Encryption Type     :</span> <span class="string">None</span></span><br><span class="line"></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">./MegaCli64</span>  <span class="string">-ldinfo</span> <span class="string">-l0</span> <span class="string">-a0</span></span><br><span class="line">                                     </span><br><span class="line"></span><br><span class="line"><span class="attr">Adapter 0 -- Virtual Drive Information:</span></span><br><span class="line"><span class="attr">Virtual Drive:</span> <span class="number">0</span> <span class="string">(Target</span> <span class="attr">Id:</span> <span class="number">0</span><span class="string">)</span></span><br><span class="line"><span class="attr">Name                :</span></span><br><span class="line"><span class="attr">RAID Level          :</span> <span class="string">Primary-0,</span> <span class="string">Secondary-0,</span> <span class="string">RAID</span> <span class="string">Level</span> <span class="string">Qualifier-0</span></span><br><span class="line"><span class="attr">Size                :</span> <span class="number">1.816</span> <span class="string">TB</span></span><br><span class="line"><span class="attr">State               :</span> <span class="string">Optimal</span></span><br><span class="line"><span class="attr">Stripe Size         :</span> <span class="number">64</span> <span class="string">KB</span></span><br><span class="line"><span class="attr">Number Of Drives    :</span> <span class="number">2</span></span><br><span class="line"><span class="attr">Span Depth          :</span> <span class="number">1</span></span><br><span class="line"><span class="attr">Default Cache Policy:</span> <span class="string">WriteBack,</span> <span class="string">ReadAheadNone,</span> <span class="string">Direct,</span> <span class="literal">No</span> <span class="string">Write</span> <span class="string">Cache</span> <span class="string">if</span> <span class="string">Bad</span> <span class="string">BBU</span></span><br><span class="line"><span class="attr">Current Cache Policy:</span> <span class="string">WriteThrough,</span> <span class="string">ReadAheadNone,</span> <span class="string">Direct,</span> <span class="literal">No</span> <span class="string">Write</span> <span class="string">Cache</span> <span class="string">if</span> <span class="string">Bad</span> <span class="string">BBU</span></span><br><span class="line"><span class="attr">Access Policy       :</span> <span class="string">Read/Write</span></span><br><span class="line"><span class="attr">Disk Cache Policy   :</span> <span class="string">Disk's</span> <span class="string">Default</span></span><br><span class="line"><span class="attr">Encryption Type     :</span> <span class="string">None</span></span><br><span class="line"></span><br><span class="line"><span class="string">Raid状态以及raid中包含哪些硬盘</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">./MegaCli64</span>  <span class="string">-ldpdinfo</span>  <span class="string">-a0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">删除raid</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">./MegaCli64</span>  <span class="string">-cfglddel</span> <span class="string">-l0</span> <span class="string">-a0</span></span><br><span class="line">                                     </span><br><span class="line"><span class="attr">Adapter 0:</span> <span class="string">Deleted</span> <span class="string">Virtual</span> <span class="string">Drive-0(target</span> <span class="string">id-0)</span></span><br><span class="line"><span class="attr">Exit Code:</span> <span class="number">0x00</span></span><br><span class="line"><span class="string">做热备</span></span><br><span class="line"><span class="string">【root@localhost</span> <span class="string">MegaCli]#</span> <span class="string">./MegaCli64</span>  <span class="string">-pdhsp</span> <span class="string">-set</span> <span class="string">-physdrv[252:3]</span> <span class="string">-a0</span></span><br><span class="line">                                     </span><br><span class="line"><span class="attr">Adapter: 0:</span> <span class="string">Set</span> <span class="string">Physical</span> <span class="string">Drive</span> <span class="string">at</span> <span class="string">EnclId-252</span> <span class="string">SlotId-3</span> <span class="string">as</span> <span class="string">Hot</span> <span class="string">Spare</span> <span class="string">Success.</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Exit Code:</span> <span class="number">0x00</span></span><br><span class="line"><span class="string">查看热备盘状态：Firmware</span> <span class="attr">state:</span> <span class="string">Hotspare,</span> <span class="string">Spun</span> <span class="string">Up</span></span><br><span class="line"><span class="string">热备盘删除</span></span><br><span class="line"><span class="string">./MegaCli64</span> <span class="string">-PDHSP</span> <span class="string">-Rmv</span>  <span class="string">-PhysDrv[Ex：Sx]</span> <span class="string">–aALL</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span><span class="string">、uncfgure</span> <span class="string">bad硬盘改成uncfgure</span> <span class="string">good硬盘</span></span><br><span class="line"><span class="string">MegaCli</span> <span class="string">-PDMakeGood</span> <span class="string">-PhysDrv[E0:S0,E1:S1,...]</span> <span class="string">|</span> <span class="string">[-Force]</span> <span class="string">-aN|-a0,1,2|-aALL</span></span><br><span class="line"><span class="string">Uncfgure</span> <span class="string">bad状态硬盘，无法对其进行操作。</span></span><br><span class="line"></span><br><span class="line"><span class="number">6</span><span class="string">、删除foreign信息</span></span><br><span class="line"><span class="string">MegaCli</span> <span class="string">-CfgForeign</span> <span class="string">-Scan</span> <span class="string">|</span> <span class="string">[-SecurityKey</span> <span class="string">sssssssssss]</span> <span class="string">-aN|-a0,1,2|-aALL</span>    </span><br><span class="line"><span class="string">MegaCli</span> <span class="string">-CfgForeign</span> <span class="string">-Clear</span> <span class="string">[x]|[-SecurityKey</span> <span class="string">sssssssssss]</span> <span class="string">-aN|-a0,1,2|-aALL</span>    </span><br><span class="line">        <span class="string">x</span> <span class="bullet">-</span> <span class="string">index</span> <span class="string">of</span> <span class="string">foreign</span> <span class="string">configurations.</span> <span class="string">Optional.</span> <span class="string">All</span> <span class="string">by</span> <span class="string">default.</span></span><br><span class="line"><span class="number">7</span><span class="string">、如何做rebuild</span></span><br><span class="line"><span class="string">如有热备盘，硬盘掉线后，热备盘会自动rebuild。</span></span><br><span class="line"><span class="string">热备盘自动rebuid</span></span><br><span class="line"><span class="attr">Enclosure Device ID:</span> <span class="number">252</span></span><br><span class="line"><span class="attr">Slot Number:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">Device Id:</span> <span class="number">178</span></span><br><span class="line"><span class="attr">Sequence Number:</span> <span class="number">6</span></span><br><span class="line"><span class="attr">Media Error Count:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">Other Error Count:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">Predictive Failure Count:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">Last Predictive Failure Event Seq Number:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">PD Type:</span> <span class="string">SATA</span></span><br><span class="line"><span class="attr">Raw Size:</span> <span class="number">931.512</span> <span class="string">GB</span> <span class="string">[0x74706db0</span> <span class="string">Sectors]</span></span><br><span class="line"><span class="attr">Non Coerced Size:</span> <span class="number">931.012</span> <span class="string">GB</span> <span class="string">[0x74606db0</span> <span class="string">Sectors]</span></span><br><span class="line"><span class="attr">Coerced Size:</span> <span class="number">930.390</span> <span class="string">GB</span> <span class="string">[0x744c8000</span> <span class="string">Sectors]</span></span><br><span class="line"><span class="attr">Firmware state:</span> <span class="string">Rebuild</span></span><br><span class="line"><span class="string">SAS</span> <span class="string">Address(0):</span> <span class="number">0x9281c0667817c71</span></span><br><span class="line"><span class="attr">Connected Port Number:</span> <span class="number">2</span><span class="string">(path0)</span> </span><br><span class="line"><span class="attr">Inquiry Data:</span>             <span class="string">9WK0BXZLST31000524NS</span>                            <span class="string">SN11</span>    </span><br><span class="line"><span class="attr">FDE Capable:</span> <span class="string">Not</span> <span class="string">Capable</span></span><br><span class="line"><span class="attr">FDE Enable:</span> <span class="string">Disable</span></span><br><span class="line"><span class="attr">Secured:</span> <span class="string">Unsecured</span></span><br><span class="line"><span class="attr">Locked:</span> <span class="string">Unlocked</span></span><br><span class="line"><span class="attr">Needs EKM Attention:</span> <span class="literal">No</span></span><br><span class="line"><span class="attr">Foreign State:</span> <span class="string">None</span> </span><br><span class="line"><span class="attr">Device Speed:</span> <span class="number">3.</span><span class="string">0Gb/s</span> </span><br><span class="line"><span class="attr">Link Speed:</span> <span class="number">3.</span><span class="string">0Gb/s</span> </span><br><span class="line"><span class="attr">Media Type:</span> <span class="string">Hard</span> <span class="string">Disk</span> <span class="string">Device</span></span><br><span class="line"><span class="string">使用MegaCli</span> <span class="string">-PDRbld</span> <span class="string">-ShowProg</span> <span class="string">-PhysDrv</span> <span class="string">[E0:S0,E1:S1,...]</span> <span class="string">-aN|-a0,1,2|-aALL来查看硬盘rebuild进程。</span></span><br><span class="line"><span class="string">Rebuid结束后，掉线槽位硬盘更换后，自动从热备拷回数据，原热备盘再次变成热备盘，</span></span><br><span class="line"><span class="attr">Enclosure Device ID:</span> <span class="number">252</span></span><br><span class="line"><span class="attr">Slot Number:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">Device Id:</span> <span class="number">179</span></span><br><span class="line"><span class="attr">Sequence Number:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">Media Error Count:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">Other Error Count:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">Predictive Failure Count:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">Last Predictive Failure Event Seq Number:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">PD Type:</span> <span class="string">SATA</span></span><br><span class="line"><span class="attr">Raw Size:</span> <span class="number">931.512</span> <span class="string">GB</span> <span class="string">[0x74706db0</span> <span class="string">Sectors]</span></span><br><span class="line"><span class="attr">Non Coerced Size:</span> <span class="number">931.012</span> <span class="string">GB</span> <span class="string">[0x74606db0</span> <span class="string">Sectors]</span></span><br><span class="line"><span class="attr">Coerced Size:</span> <span class="number">930.390</span> <span class="string">GB</span> <span class="string">[0x744c8000</span> <span class="string">Sectors]</span></span><br><span class="line"><span class="attr">Firmware state:</span> <span class="string">Copyback</span></span><br><span class="line"><span class="string">SAS</span> <span class="string">Address(0):</span> <span class="number">0x9281c06595f6f7c</span></span><br><span class="line"><span class="attr">Connected Port Number:</span> <span class="number">1</span><span class="string">(path0)</span> </span><br><span class="line"><span class="attr">Inquiry Data:</span>             <span class="string">9WK046MWST31000524NS</span>                            <span class="string">SN11</span>    </span><br><span class="line"><span class="attr">FDE Capable:</span> <span class="string">Not</span> <span class="string">Capable</span></span><br><span class="line"><span class="attr">FDE Enable:</span> <span class="string">Disable</span></span><br><span class="line"><span class="attr">Secured:</span> <span class="string">Unsecured</span></span><br><span class="line"><span class="attr">Locked:</span> <span class="string">Unlocked</span></span><br><span class="line"><span class="attr">Needs EKM Attention:</span> <span class="literal">No</span></span><br><span class="line"><span class="attr">Foreign State:</span> <span class="string">None</span> </span><br><span class="line"><span class="attr">Device Speed:</span> <span class="number">3.</span><span class="string">0Gb/s</span> </span><br><span class="line"><span class="attr">Link Speed:</span> <span class="number">3.</span><span class="string">0Gb/s</span> </span><br><span class="line"><span class="attr">Media Type:</span> <span class="string">Hard</span> <span class="string">Disk</span> <span class="string">Device</span></span><br><span class="line"></span><br><span class="line"><span class="string">热备盘在rebuid过程中，更换掉线槽位硬盘，查看该硬盘是否有media</span> <span class="string">error即可，确认硬盘为uncfgure</span> <span class="string">good状态，一般RAID卡都可以copyback,后续硬盘会自动从原热备盘拷回数据。</span></span><br><span class="line"><span class="string">但是考虑到存在无法copyback的情况，在热备盘rebuild完成后再更换硬盘。</span></span><br><span class="line"><span class="string">无热备盘情况，更换新硬盘，如果自动rebuild，则正常结束即可，如不自动rebuild，可以配置成热备盘。</span></span><br><span class="line"></span><br><span class="line"><span class="number">8</span><span class="string">、查看raid卡日志</span></span><br><span class="line"><span class="comment">#/opt/MegaRAID/MegaCli/MegaCli64 -FwTermLog -Dsply -aALL </span></span><br><span class="line"><span class="number">9</span><span class="string">、显示Raid卡型号，Raid设置，Disk相关信息</span></span><br><span class="line"><span class="comment">#/opt/MegaRAID/MegaCli/MegaCli64 -cfgdsply -aALL </span></span><br><span class="line"><span class="number">10</span><span class="string">、查看RAID阵列中掉线的盘</span></span><br><span class="line"><span class="string">/opt/MegaRAID/MegaCli/MegaCli64</span> <span class="string">-pdgetmissing</span> <span class="string">-a0</span></span><br></pre></td></tr></table></figure>



<h3 id="去除raid-0"><a href="#去除raid-0" class="headerlink" title="去除raid 0"></a>去除raid 0</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>BMC进入设备终端</span><br><span class="line"><span class="number">2.</span>执行reboot</span><br></pre></td></tr></table></figure>

<p>3.启动过程中执行：ctrl+r 进入raid模式</p>
<p><img src="/2022/05/17/linux/Linux/Linux%5C1584948967541-1585553611037.png" alt="1584948967541"></p>
<p>4.选中RAID 0，按F2，选中Delete Drive Group，按enter选择YES，确认删除</p>
<p><img src="/2022/05/17/linux/Linux/Linux%5C1584948981764-1585553611038.png" alt="1584948981764"></p>
<p><img src="/2022/05/17/linux/Linux/Linux%5C1584948995283-1585553611038.png" alt="1584948995283"></p>
<p>5.按Ctrl+N进入下一页，TAB选择到JBOD，按空格勾选（x），下图是没勾选，选择apply提交</p>
<p><img src="/2022/05/17/linux/Linux/Linux%5C1584949016403-1585553611038.png" alt="1584949016403"></p>
<p><img src="/2022/05/17/linux/Linux/Linux%5C1584949025247-1585553611038.png" alt="1584949025247"></p>
<p>6.以及按Ctrl+p向前查看磁盘是否都做了jbod</p>
<h3 id="查看磁盘型号"><a href="#查看磁盘型号" class="headerlink" title="查看磁盘型号"></a>查看磁盘型号</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smartctl <span class="params">--all</span> <span class="string">/dev/sda</span></span><br></pre></td></tr></table></figure>



<h3 id="lvm"><a href="#lvm" class="headerlink" title="lvm"></a>lvm</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">raid卡是提高性能的</span><br><span class="line">lvm是增加容量的</span><br></pre></td></tr></table></figure>

<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">磁盘</span><br><span class="line">[<span class="symbol">root@</span>block-storage14 home]# vgs</span><br><span class="line">  VG       #PV #LV #SN Attr   VSize  VFree</span><br><span class="line">  datavg     <span class="number">1</span>   <span class="number">1</span>   <span class="number">0</span> wz--n-  <span class="number">1.34</span>t <span class="number">1.24</span>t</span><br><span class="line">  systemvg   <span class="number">1</span>   <span class="number">7</span>   <span class="number">0</span> wz--n- <span class="number">74.51</span>g <span class="number">4.00</span>m</span><br><span class="line"> 注释：datavg是数据盘 systemvg是系统盘</span><br><span class="line"> </span><br><span class="line">lvcreate -L <span class="number">80</span>G -n metadatalv datavg</span><br><span class="line"></span><br><span class="line">lvremove /dev/datavg/data-metadatalv</span><br><span class="line"></span><br><span class="line">格式化：mkfs -t ext4 /dev/mapper/datavg-metadatalv</span><br></pre></td></tr></table></figure>

<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//blog.csdn.net/qq_27721925/article/details/52403912</span></span><br><span class="line">LVM ——Logical Volume Manager (逻辑卷管理)</span><br><span class="line">逻辑卷管理是Linux环境下对磁盘分区进行管理的一种机制，LVM是建立在硬盘和分区之上的一个逻辑层，用来提高磁盘分区管理的灵活性。</span><br><span class="line"></span><br><span class="line">一、优点</span><br><span class="line">磁盘空间的动态划分和管理 </span><br><span class="line">实现分区的动态拉伸和回缩</span><br><span class="line"></span><br><span class="line">二、逻辑卷管理的组成</span><br><span class="line"><span class="number">1</span>、物理卷(PV——Pvcreate Volume) </span><br><span class="line">物理卷在逻辑卷管理中处于最底层，它可以是实际物理硬盘上的分区，也可以是整个物理硬盘。</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、卷组(VG——Vgcreate Group) </span><br><span class="line">卷组建立在物理卷之上，一个卷组中至少要包括一个物理卷，在卷组建立之后可动态添加物理卷到卷组中。一个逻辑卷管理系统中可以只有一个卷组，也可以拥有多个卷组。</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、逻辑卷(LV——Lvcreate Volume) </span><br><span class="line">逻辑卷建立在卷组之上，卷中的未分配空间可以用于建立新的逻辑卷，逻辑卷建立后可以动态地扩展和缩小空间。系统中的多个逻辑卷可以属于同一个卷组，也可以属于不同的多个卷组。</span><br><span class="line"></span><br><span class="line">三、LV的创建步骤</span><br><span class="line">LV的创建过程其实是一个先整合、再划分的过程 </span><br><span class="line">（<span class="number">1</span>）添加硬盘或者创建分区，通知内核 </span><br><span class="line">（<span class="number">2</span>）创建物理卷 </span><br><span class="line">（<span class="number">3</span>）创建卷组 </span><br><span class="line">（<span class="number">4</span>）创建逻辑卷 </span><br><span class="line">（<span class="number">5</span>）创建文件系统(mkfs.ext4) </span><br><span class="line">（<span class="number">6</span>）挂载使用(mkdir；mount)</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、创建分区 划分<span class="number">3</span>个分区，每个<span class="number">2</span>G</span><br></pre></td></tr></table></figure>

<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">linux环境下，假设有一个磁盘<span class="string">/dev/vdb</span>（ssd磁盘可能是sda或者sdb)，一共200G， 要将其分为3个逻辑分区，分别挂载在<span class="string">/mysql</span>, <span class="string">/binlog</span>, <span class="string">/bak</span>三个目录下</span><br><span class="line">环境：CentOS 7.3</span><br><span class="line">一、创建磁盘分区</span><br><span class="line"><span class="comment"># 查看/dev/vdb信息</span></span><br><span class="line">fdisk -l <span class="string">/dev/vdb</span></span><br><span class="line"><span class="comment"># 初始化磁盘</span></span><br><span class="line">pvcreate <span class="string">/dev/vdb</span></span><br><span class="line"><span class="comment"># 查看物理磁盘卷</span></span><br><span class="line">pvs</span><br><span class="line"><span class="comment"># 创建一个LVM卷组datavg</span></span><br><span class="line">vgcreate datavg <span class="string">/dev/vdb</span></span><br><span class="line"><span class="comment"># 查看LVM卷组信息</span></span><br><span class="line">vgs</span><br><span class="line"><span class="comment"># 创建逻辑分区</span></span><br><span class="line">lvcreate -y -n datalv -L 50G datavg</span><br><span class="line">lvcreate -y -n binloglv -L 50G datavg</span><br><span class="line">lvcreate -y -n baklv -L 99G datavg</span><br><span class="line"><span class="comment"># 查看逻辑分区信息</span></span><br><span class="line">lvs</span><br><span class="line"><span class="comment"># 格式化磁盘分区</span></span><br><span class="line">mkfs.xfs  <span class="string">/dev/datavg/datalv</span></span><br><span class="line">mkfs.xfs <span class="string">/dev/datavg/baklv</span></span><br><span class="line">mkfs.xfs <span class="string">/dev/datavg/binloglv</span></span><br><span class="line"><span class="comment"># 挂载分区</span></span><br><span class="line">mount <span class="string">/dev/datavg/datalv</span> <span class="string">/mysql</span></span><br><span class="line">mount <span class="string">/dev/datavg/binloglv</span> <span class="string">/binlog</span></span><br><span class="line">mount <span class="string">/dev/datavg/baklv</span> <span class="string">/bak</span></span><br><span class="line"><span class="comment"># 磁盘分区创建完成，查看磁盘分区信息</span></span><br><span class="line">df -h -T</span><br><span class="line"></span><br><span class="line">二、删除磁盘分区</span><br><span class="line"><span class="comment"># 卸载分区</span></span><br><span class="line">umount <span class="string">/mysql</span></span><br><span class="line">umount <span class="string">/binlog</span></span><br><span class="line">umount <span class="string">/bak</span></span><br><span class="line"><span class="comment"># 确认分区已卸载</span></span><br><span class="line">df -h -T</span><br><span class="line"><span class="comment"># 查看逻辑分区</span></span><br><span class="line">lvs</span><br><span class="line"><span class="comment"># 移除逻辑分区</span></span><br><span class="line">lvremove -y <span class="string">/dev/datavg/datalv</span></span><br><span class="line">lvremove -y <span class="string">/dev/datavg/binloglv</span></span><br><span class="line">lvremove -y <span class="string">/dev/datavg/baklv</span></span><br><span class="line"><span class="comment"># 移除LVM卷组</span></span><br><span class="line">vgremove datavg</span><br><span class="line"><span class="comment"># 移除物理磁盘卷</span></span><br><span class="line">pvremove <span class="string">/dev/vdb</span></span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">linux磁盘分区创建与删除会对磁盘上已有的数据造成损坏，谨慎操作。以上命令的详细信息请参考帮助文档，这里不再赘述。</span><br></pre></td></tr></table></figure>

<h3 id="part"><a href="#part" class="headerlink" title="part"></a>part</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">https://blog.csdn.net/qq_32863631/article/details/76047133</span></span><br><span class="line"><span class="string">https://www.cnblogs.com/kreo/p/11406217.html</span></span><br><span class="line"><span class="string">https://blog.csdn.net/sfdst/article/details/81167080</span></span><br><span class="line"><span class="string">https://blog.csdn.net/qq_32863631/article/details/76047133</span></span><br><span class="line"></span><br><span class="line"><span class="string">创建分区：</span></span><br><span class="line"><span class="string">[root@localhost</span> <span class="string">~]#</span> <span class="string">parted</span> <span class="string">/dev/sdb</span>   </span><br><span class="line"><span class="string">GNU</span> <span class="string">Parted</span> <span class="number">1.8</span><span class="number">.1</span> <span class="string">Using</span> <span class="string">/dev/sdb</span> <span class="string">Welcome</span> <span class="string">to</span> <span class="string">GNU</span> <span class="string">Parted!</span> <span class="string">Type</span> <span class="string">‘help’</span> <span class="string">to</span> <span class="string">view</span> <span class="string">a</span> <span class="string">list</span> <span class="string">of</span> <span class="string">commands.</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">mklabel</span> <span class="string">gpt</span>           <span class="comment"># 将MBR磁盘格式化为GPT</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">print</span>                       <span class="comment">#打印当前分区</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">0</span> <span class="number">4.</span><span class="string">5TB</span>                <span class="comment"># 分一个4.5T的主分区</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">4.</span><span class="string">5TB</span> <span class="string">12TB</span>      <span class="comment"># 分一个7.5T的主分区</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">print</span>                         <span class="comment">#打印当前分区</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">quit</span> <span class="string">退出</span></span><br><span class="line"></span><br><span class="line"><span class="string">或者</span></span><br><span class="line"><span class="string">GNU</span> <span class="string">Parted</span> <span class="number">1.8</span><span class="number">.1</span> <span class="string">Using</span> <span class="string">/dev/sdb</span> <span class="string">Welcome</span> <span class="string">to</span> <span class="string">GNU</span> <span class="string">Parted!</span> <span class="string">Type</span> <span class="string">‘help’</span> <span class="string">to</span> <span class="string">view</span> <span class="string">a</span> <span class="string">list</span> <span class="string">of</span> <span class="string">commands.</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">mklabel</span> <span class="string">gpt</span>           <span class="comment"># 将MBR磁盘格式化为GPT</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">1</span> <span class="number">3072</span>            <span class="comment">#默认单位是M                                                                                     </span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">3072</span> <span class="number">6144</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">6144</span> <span class="number">9216</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">9216</span> <span class="number">12288</span>                                   </span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">12288</span> <span class="number">15360</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">15360</span> <span class="number">18432</span>                                 </span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">18432</span> <span class="number">21504</span>                                 </span><br><span class="line"><span class="string">(parted)</span> <span class="string">mkpart</span> <span class="string">primary</span> <span class="number">21504</span> <span class="number">24577</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">quit</span></span><br><span class="line"></span><br><span class="line"><span class="string">mklabel</span> <span class="string">gpt</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">1</span> <span class="number">3072</span>     </span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">3072</span> <span class="number">6144</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">6144</span> <span class="number">9216</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">9216</span> <span class="number">12288</span> </span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">12288</span> <span class="number">15360</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">15360</span> <span class="number">18432</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">18432</span> <span class="number">21504</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">21504</span> <span class="number">24577</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">24577</span> <span class="number">434177</span></span><br><span class="line"></span><br><span class="line"><span class="string">disk=`lsblk|grep</span> <span class="number">2.9</span><span class="string">|sed</span> <span class="string">'s/├─//g'</span><span class="string">|awk</span> <span class="string">'&#123;print $1&#125;'</span><span class="string">|head</span> <span class="number">-1</span><span class="string">|sed</span> <span class="string">'s/[1-9]//g'</span><span class="string">`;parted</span> <span class="string">/dev/$&#123;disk&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="string">rm</span> <span class="number">1</span></span><br><span class="line"><span class="string">rm</span> <span class="number">2</span></span><br><span class="line"><span class="string">rm</span> <span class="number">3</span></span><br><span class="line"><span class="string">rm</span> <span class="number">4</span></span><br><span class="line"><span class="string">rm</span> <span class="number">5</span></span><br><span class="line"><span class="string">rm</span> <span class="number">6</span></span><br><span class="line"><span class="string">rm</span> <span class="number">7</span></span><br><span class="line"><span class="string">rm</span> <span class="number">8</span></span><br><span class="line"><span class="string">rm</span> <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="string">磁盘开始的位置和磁盘结束的位置，默认单位是M，可以使用unit</span> <span class="string">GB改变默认单位GB</span></span><br><span class="line"><span class="string">for</span> <span class="string">i</span> <span class="string">in</span> <span class="string">`seq</span> <span class="number">1</span> <span class="number">8</span><span class="string">`;do</span> <span class="string">/home/snbs/ChunkServer/server</span> <span class="string">format</span> <span class="string">-dev=sda$&#123;i&#125;</span> <span class="string">-purpose=wcache;done</span></span><br><span class="line"></span><br><span class="line"><span class="string">全闪环境：</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">1</span> <span class="number">3072</span>     </span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">3072</span> <span class="number">6144</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">6144</span> <span class="number">9216</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">9216</span> <span class="number">12288</span> </span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">12288</span> <span class="number">15360</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">15360</span> <span class="number">18432</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">18432</span> <span class="number">21504</span></span><br><span class="line"><span class="string">mkpart</span> <span class="string">primary</span> <span class="number">21504</span> <span class="number">763084</span></span><br><span class="line"></span><br><span class="line"><span class="string">删除分区：</span></span><br><span class="line"><span class="string">(parted)</span> <span class="string">p</span>                                                                </span><br><span class="line"><span class="attr">Model:</span> <span class="string">AVAGO</span> <span class="string">AVAGO</span> <span class="string">(scsi)</span></span><br><span class="line"><span class="attr">Disk /dev/sdb:</span> <span class="number">18.</span><span class="string">0TB</span></span><br><span class="line"><span class="string">Sector</span> <span class="string">size</span> <span class="string">(logical/physical):</span> <span class="string">512B/4096B</span></span><br><span class="line"><span class="attr">Partition Table:</span> <span class="string">gpt</span></span><br><span class="line"><span class="attr">Disk Flags:</span> </span><br><span class="line"></span><br><span class="line"><span class="string">Number</span>  <span class="string">Start</span>   <span class="string">End</span>     <span class="string">Size</span>    <span class="string">File</span> <span class="string">system</span>  <span class="string">Name</span>     <span class="string">Flags</span></span><br><span class="line"> <span class="number">1</span>      <span class="number">17.</span><span class="string">4kB</span>  <span class="string">4096GB</span>  <span class="string">4096GB</span>               <span class="string">primary</span></span><br><span class="line"></span><br><span class="line"><span class="string">(parted)</span> <span class="string">rm</span> <span class="number">1</span>                                                             </span><br><span class="line"><span class="string">(parted)</span> <span class="string">p</span>                                                                </span><br><span class="line"><span class="attr">Model:</span> <span class="string">AVAGO</span> <span class="string">AVAGO</span> <span class="string">(scsi)</span></span><br><span class="line"><span class="attr">Disk /dev/sdb:</span> <span class="number">18.</span><span class="string">0TB</span></span><br><span class="line"><span class="string">Sector</span> <span class="string">size</span> <span class="string">(logical/physical):</span> <span class="string">512B/4096B</span></span><br><span class="line"><span class="attr">Partition Table:</span> <span class="string">gpt</span></span><br><span class="line"><span class="attr">Disk Flags:</span> </span><br><span class="line"></span><br><span class="line"><span class="string">Number</span>  <span class="string">Start</span>  <span class="string">End</span>  <span class="string">Size</span>  <span class="string">File</span> <span class="string">system</span>  <span class="string">Name</span>  <span class="string">Flags</span></span><br><span class="line"></span><br><span class="line"><span class="string">(parted)</span></span><br></pre></td></tr></table></figure>

<h3 id="fdisk"><a href="#fdisk" class="headerlink" title="fdisk"></a>fdisk</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@host102442553 ~]# fdisk /dev/sdc</span><br><span class="line"></span><br><span class="line">The device presents a logical sector size that <span class="keyword">is</span> smaller than</span><br><span class="line">the physical sector size. Aligning <span class="keyword">to</span> a physical sector (<span class="keyword">or</span> optimal</span><br><span class="line">I/O) size boundary <span class="keyword">is</span> recommended, <span class="keyword">or</span> performance may be impacted.</span><br><span class="line">Welcome <span class="keyword">to</span> fdisk (util-linux <span class="number">2.23</span><span class="number">.2</span>).</span><br><span class="line"></span><br><span class="line">Changes will remain <span class="keyword">in</span> memory <span class="keyword">only</span>, <span class="keyword">until</span> you decide <span class="keyword">to</span> <span class="keyword">write</span> them.</span><br><span class="line">Be careful <span class="keyword">before</span> <span class="keyword">using</span> the <span class="keyword">write</span> command.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> help): d</span><br><span class="line"><span class="keyword">Partition</span> number (<span class="number">1</span>,<span class="number">2</span>, <span class="keyword">default</span> <span class="number">2</span>): <span class="number">1</span></span><br><span class="line"><span class="keyword">Partition</span> <span class="number">1</span> <span class="keyword">is</span> deleted</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> help): w</span><br><span class="line">The <span class="keyword">partition</span> <span class="keyword">table</span> has been altered!</span><br><span class="line"></span><br><span class="line">Calling ioctl() <span class="keyword">to</span> re-<span class="keyword">read</span> <span class="keyword">partition</span> <span class="keyword">table</span>.</span><br><span class="line"></span><br><span class="line"><span class="built_in">WARNING</span>: Re-reading the <span class="keyword">partition</span> <span class="keyword">table</span> failed <span class="keyword">with</span> error <span class="number">16</span>: Device <span class="keyword">or</span> resource busy.</span><br><span class="line">The kernel still uses the <span class="built_in">old</span> <span class="keyword">table</span>. The <span class="built_in">new</span> <span class="keyword">table</span> will be used at</span><br><span class="line">the next reboot <span class="keyword">or</span> <span class="keyword">after</span> you run partprobe(<span class="number">8</span>) <span class="keyword">or</span> kpartx(<span class="number">8</span>)</span><br><span class="line">Syncing disks.</span><br><span class="line"></span><br><span class="line">解决：操作完，执行partprobe（#.为了不reboot就能生效，强制内核重新读取分区表）</span><br><span class="line">http://blog.itpub.net/<span class="number">22907091</span>/viewspace<span class="number">-748118</span>/</span><br><span class="line">https://www.cnblogs.com/zsychanpin/p/<span class="number">6784655.</span>html</span><br><span class="line"> partprobe包括在parted的rpm软件包中。partprobe能够改动kernel中分区表。使kernel又一次读取分区表。 因此。使用该命令就行创建分区而且在不又一次启动机器的情况下系统可以识别这些分区。</span><br></pre></td></tr></table></figure>

<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span><span class="comment">//www.cnblogs.com/zishengY/p/7137671.html</span></span><br><span class="line">一.  创建分区</span><br><span class="line">先查看下是否有磁盘没有分区</span><br><span class="line">fdisk -l</span><br></pre></td></tr></table></figure>

<p><img src="/2022/05/17/linux/Linux/847059-20170708180732940-2132354928.png" alt="img"></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">其中第一个框是已经分好区的磁盘，第二、三个硬盘没有分区。下面开始分区</span><br><span class="line"></span><br><span class="line">二.用fdisk 对<span class="regexp">/dev/</span>vda 进行分区</span><br><span class="line">fdisk <span class="regexp">/dev/</span>vdb</span><br><span class="line">输入m，可以查看命令操作</span><br></pre></td></tr></table></figure>

<p><img src="/2022/05/17/linux/Linux/Linux%5C1584950864092-1585551848364.png" alt="1584950864092"></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输入<span class="selector-tag">p</span> 查看当前硬盘分区，目前没有分区</span><br></pre></td></tr></table></figure>

<p><img src="/2022/05/17/linux/Linux/Linux%5C1584950877483-1585551867171.png" alt="1584950877483"></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输入n新建一个分区，输入p 建立分区，输入分区编号 <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/05/17/linux/Linux/Linux%5C1584950901855-1585551881417.png" alt="1584950901855"></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">然后会让你设置开始扇区,我填的是开始扇区<span class="number">2048</span>，结束，<span class="number">20480</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/05/17/linux/Linux/Linux%5C1584950916178-1585551894581.png" alt="1584950916178"></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可以填“+<span class="number">100</span>G”</span><br><span class="line">最后输入w,回车保存</span><br></pre></td></tr></table></figure>

<p><img src="/2022/05/17/linux/Linux/Linux%5C1584950933865-1585551912922.png" alt="1584950933865"></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">其实这个时候，建立好的分区还不能用，还需要挂载才可以用。但是挂载之前，必须要格式化，才行。。。</span></span><br><span class="line"></span><br><span class="line"><span class="string">三.</span> <span class="string">格式化分区</span></span><br><span class="line"><span class="string">mkfs.ext4</span>   <span class="string">/dev/vdb</span></span><br><span class="line"></span><br><span class="line"><span class="string">四.</span> <span class="string">挂载</span></span><br><span class="line"><span class="number">4.1</span><span class="string">挂载分区</span></span><br><span class="line"><span class="number">4.1</span><span class="number">.1</span> <span class="string">先创建挂载目录</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">/lutong</span></span><br><span class="line"><span class="number">4.1</span><span class="number">.2</span> <span class="string">通知系统内核分区表的变化，不然内核不知道分区（或重启系统）</span></span><br><span class="line"><span class="string">partprobe</span> <span class="string">/dev/vdb</span></span><br><span class="line"><span class="number">4.1</span><span class="number">.3</span> <span class="string">然后再挂载分区</span></span><br><span class="line"><span class="string">mount</span> <span class="string">/dev/vdb</span> <span class="string">/lutong</span></span><br><span class="line"><span class="number">4.1</span><span class="number">.4</span> <span class="string">最后查看挂载是否成功</span></span><br><span class="line"><span class="string">df</span> <span class="string">-h</span></span><br><span class="line"><span class="string">补充：</span></span><br><span class="line"><span class="string">使用工具partprobe让kernel读取分区信息</span></span><br><span class="line"><span class="string">[root@db2</span> <span class="string">~]#</span> <span class="string">partprobe</span></span><br><span class="line"><span class="string">使用fdisk工具只是将分区信息写到磁盘，如果需要mkfs磁盘分区则需要重启系统，</span></span><br><span class="line"><span class="string">而使用partprobe则可以使kernel重新读取分区</span> <span class="string">信息，从而避免重启系统。</span></span><br><span class="line"></span><br><span class="line"><span class="number">4.2</span> <span class="string">设置开机自动挂载</span></span><br><span class="line"><span class="string">vim</span> <span class="string">/etc/fstab</span></span><br><span class="line"><span class="string">mount</span> <span class="string">-a</span></span><br><span class="line"></span><br><span class="line"><span class="string">五.</span> <span class="string">卸载及删除分区</span></span><br><span class="line"><span class="number">5.1</span> <span class="string">卸载</span></span><br><span class="line"><span class="string">umount</span> <span class="string">/dev/vdb</span></span><br><span class="line"></span><br><span class="line"><span class="number">5.2</span> <span class="string">删除分区</span></span><br><span class="line"><span class="string">fdisk</span> <span class="string">/dev/sdc</span></span><br><span class="line"><span class="string">m</span></span><br><span class="line"><span class="string">d</span></span><br><span class="line"><span class="number">1</span>   </span><br><span class="line"><span class="string">d</span>   <span class="comment">#删除</span></span><br><span class="line"><span class="string">w</span>   <span class="comment">#输入 w  保存，这个时候分区以及删除了，可以重新创建了</span></span><br></pre></td></tr></table></figure>



<h2 id="三、分区"><a href="#三、分区" class="headerlink" title="三、分区"></a>三、分区</h2><h3 id="分区表"><a href="#分区表" class="headerlink" title="分区表"></a>分区表</h3><p>磁盘分区表主要有两种格式，一种是限制较多的 MBR 分区表，一种是较新且限制较少的 GPT 分区表。</p>
<h4 id="1-MBR"><a href="#1-MBR" class="headerlink" title="1. MBR"></a>1. MBR</h4><p>MBR 中，第一个扇区最重要，里面有主要开机记录（Master boot record, MBR）及分区表（partition table），其中主要开机记录占 446 bytes，分区表占 64 bytes。</p>
<p>分区表只有 64 bytes，最多只能存储 4 个分区，这 4 个分区为主分区（Primary）和扩展分区（Extended）。其中扩展分区只有一个，它使用其它扇区来记录额外的分区表，因此通过扩展分区可以分出更多分区，这些分区称为逻辑分区。</p>
<p>Linux 也把分区当成文件，分区文件的命名方式为：磁盘文件名 + 编号，例如 /dev/sda1。注意，逻辑分区的编号从 5 开始。</p>
<h4 id="2-GPT"><a href="#2-GPT" class="headerlink" title="2. GPT"></a>2. GPT</h4><p>扇区是磁盘的最小存储单位，旧磁盘的扇区大小通常为 512 bytes，而最新的磁盘支持 4 k。GPT 为了兼容所有磁盘，在定义扇区上使用逻辑区块地址（Logical Block Address, LBA），LBA 默认大小为 512 bytes。</p>
<p>GPT 第 1 个区块记录了主要开机记录（MBR），紧接着是 33 个区块记录分区信息，并把最后的 33 个区块用于对分区信息进行备份。这 33 个区块第一个为 GPT 表头纪录，这个部份纪录了分区表本身的位置与大小和备份分区的位置，同时放置了分区表的校验码 (CRC32)，操作系统可以根据这个校验码来判断 GPT 是否正确。若有错误，可以使用备份分区进行恢复。</p>
<p>GPT 没有扩展分区概念，都是主分区，每个 LBA 可以分 4 个分区，因此总共可以分 4 * 32 = 128 个分区。</p>
<p>MBR 不支持 2.2 TB 以上的硬盘，GPT 则最多支持到 233 TB = 8 ZB。</p>
<p><a href="https://camo.githubusercontent.com/67df9e7198b4078778b3d9d782bae2b104c626d8c9898587ee638c21859d7fbb/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f475549445f506172746974696f6e5f5461626c655f536368656d652e7376672e706e67" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/67df9e7198b4078778b3d9d782bae2b104c626d8c9898587ee638c21859d7fbb/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f475549445f506172746974696f6e5f5461626c655f536368656d652e7376672e706e67" alt="img"></a></p>
<h4 id="3-MBR和GPT"><a href="#3-MBR和GPT" class="headerlink" title="3. MBR和GPT"></a>3. MBR和GPT</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">模拟磁盘损坏：</span><br><span class="line">https:<span class="comment">//blog.51cto.com/jk6627/1957816</span></span><br><span class="line">https:<span class="comment">//www.cnblogs.com/jenqz/p/3613829.html</span></span><br><span class="line"></span><br><span class="line">目前对于硬盘的分区方式有两种：MBR和GPT。</span><br><span class="line">【MBR的备份和恢复】</span><br><span class="line">采用MBR分区的硬盘中一共有四个分区：扩展分区最多有一个，如果不需要再分逻辑分区，可以没有扩展分区。</span><br><span class="line"></span><br><span class="line">我们都知道磁盘上有一个个的磁道，每个磁道上有很多的扇区，从磁盘的外围向内，从<span class="number">0</span>开始逐渐增加磁道编号，每次磁道中的扇区也是从<span class="number">0</span>开始进行编号，而MBR这个数据块就位于<span class="number">0</span>磁道<span class="number">0</span>扇区。</span><br><span class="line"></span><br><span class="line">每个扇区的大小为<span class="number">512</span>字节，所以磁盘上的MBR的大小就为<span class="number">512</span>字节，而这<span class="number">512</span>字节又分为：</span><br><span class="line">*主引导程序（偏移地址<span class="number">0000</span>H-<span class="number">-0088</span>H），它负责从活动分 区中装载，并运行系统引导程序。</span><br><span class="line">*出错信息数据区（偏移地址<span class="number">0089</span>H-<span class="number">-00E1</span>H为出错信息， <span class="number">00E2</span>H-<span class="number">-01</span>BDH全为<span class="number">0</span>字节。）</span><br><span class="line">*分区表（DPT,Disk Partition Table）含<span class="number">4</span>个分区项，偏移地址<span class="number">01</span>BEH-<span class="number">-01</span>FDH,每个分区表项长<span class="number">16</span>个字节，共<span class="number">64</span>字节为 分区项<span class="number">1</span>、分区项<span class="number">2</span>、分区项<span class="number">3</span>、分区项<span class="number">4</span> v</span><br><span class="line">*结束标志字，偏移地址<span class="number">01</span>FE-<span class="number">-01</span>FF的<span class="number">2</span>个字节值为结束标志 <span class="number">55</span>AA</span><br><span class="line"></span><br><span class="line">所以MBR存储的信息很重要，前<span class="number">446</span>字节的启动引导信息，是当系统启动时由BIOS自举，进行首先查找的地方，根据启动引导中的内容到指定的位置进行加载西东启动文件，所以如果MBR损坏，则系统就启动不起来了。如果启动引导后面的<span class="number">64</span>字节分区表位损坏了，则系统就不能正常识别磁盘中的分区，系统就会认为该磁盘没有分区，也不能正常加载分区，每<span class="number">16</span>位字节标识一个分区，所以一个采用MBR分区方式的硬盘只能分四个分区（除逻辑分区），最后的两位结束为也是很重要的，如果没有结束为，系统就不认为这是一个MBR，就会认为这是一个空盘，结束位标志着分区表的结束，也是一个MBR数据区的结束。</span><br><span class="line"></span><br><span class="line">在生产的过程中，我们需要对磁盘的MBR区进行一个备份，以备当MBR区损坏时能够恢复。</span><br><span class="line">而且这个备份的文件是不能还放在这个硬盘下的，一定要备份到远程主机上。</span><br><span class="line"></span><br><span class="line">我们在开始试验之前需要了解两个东西：</span><br><span class="line">/dev/zero文件：这个是一个特殊的字符文件，会不断产生返回值<span class="number">0</span>,</span><br><span class="line">dd 这个命令：这个命令可以对块设备进行读写操作。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">我们先来查看一下磁盘的MBR区数据，前<span class="number">512</span>字节（我们以sda磁盘为例）</span><br><span class="line">    hexdump -C -n <span class="number">512</span> /dev/sda</span><br><span class="line"></span><br><span class="line">对磁盘上的MBR区进行备份：（我们以sda盘为例）</span><br><span class="line">    dd <span class="keyword">if</span>=/dev/sda of=/app/mbr bs=<span class="number">1</span> count=<span class="number">512</span></span><br><span class="line"></span><br><span class="line">这条命令将sda盘中的前<span class="number">512</span>字节的数据读入到/app/mbr这个文件中了，即使没有这个文件，通过这条命令也会自动生成一个该文件，bs后面默认的是以字节为单位，我们也可以跟上单位自定义大小，count是表示有多少块该大小的数据。</span><br><span class="line">备份完之后我们来查看一下是否备份成功，进入/app下进行查看是否生成了备份文件：</span><br><span class="line"></span><br><span class="line">当然，这个备份的文件不能放到当前这个磁盘下，如果我们的MBR区域坏了，系统就启动不起来，而且磁盘就进不去，我们的备份文件就根本找不到。所以通常备份文件都是放到远程主机上的，我们将mbr文件远程拷贝到我的另一台Linux上：</span><br><span class="line"></span><br><span class="line">好了，既然已经备份好了，我们就可以直接进行mbr的破坏了，同样我们通过dd 命令写入数据，将sda磁盘中的mbr区的数据给破坏掉：dd <span class="keyword">if</span>=/dev/zero of=/dev/sda bs=<span class="number">1</span> count=<span class="number">512</span></span><br><span class="line">我们之前也提到过了，/dev/zero是一个特殊的字符设备，不断的产生<span class="number">0</span>值，我们将sda前<span class="number">512</span>字节全部重置为<span class="number">0.</span></span><br><span class="line"></span><br><span class="line">通过hexdump -C -n <span class="number">512</span> /dev/sda 查看sda前面<span class="number">512</span>都变成了<span class="number">0</span></span><br><span class="line"></span><br><span class="line">现在，我们的系统就不能正常的加载启动了，我们需要把这块破坏的硬盘安装到另一台主机上，通过另一台主机进行修复。</span><br><span class="line">在挂载之前我们要先查看一下我们用来添加磁盘的系统中的磁盘，以确定最后我们是否知道我们添加的是那一块磁盘。</span><br><span class="line"></span><br><span class="line">首先，我们要知道被破坏的磁盘的磁盘名，否则我们怎么知道我们要把那一个磁盘安装到另一个主机上。打开虚拟机编辑，找到磁盘对应的磁盘文件名。这是为了方便我们接下来在虚拟机文件中找到这个磁盘文件。</span><br><span class="line"></span><br><span class="line">按照步骤来：</span><br><span class="line">    设备进行添加完成之后，我们进行入系统中查看有没有将此硬盘添加进来：</span><br><span class="line"></span><br><span class="line">    通过查看，我们发现，虽然我们将磁盘进行了物理的添加，但是系统中，并没有真正的识别，所以我们需要运行echo <span class="string">'- - -'</span> &gt; /sys/<span class="keyword">class</span>/<span class="symbol">scsi_host0</span>/<span class="symbol">scan</span> 这条命令进行系统的识别，有些时候需要向<span class="symbol">scsi_host2</span>中添加。之后我们在来查看会发现多出来一个<span class="symbol">sde</span>磁盘，这个磁盘的大小正是我们添加的那块磁盘的大小，所以确定这个就是我们需要修复的那一块磁盘。</span><br><span class="line"></span><br><span class="line">   为了进一步的确认这就是我们需要恢复的磁盘，我们再来查看一次。下图中，我们发现磁盘的前<span class="symbol">512</span>自己全部为<span class="symbol">0</span>了。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 接下来我们将我们备份的文件，同样的使用<span class="symbol">dd</span>命令将备份文件写入到被破坏的磁盘中，小编演示如下：</span><br><span class="line"></span><br><span class="line">    恢复数据之后要进行查看确认，以确保万无一失。</span><br><span class="line">这个时候我们进行查看磁盘分区情况，看是否会有所改变：</span><br><span class="line"></span><br><span class="line">    恢复过<span class="symbol">MBR</span>分区后，<span class="symbol">sde</span>中的分区信息就显示出来了。说明我们恢复成功了。我们将磁盘卸载掉，重新挂回原来的系统上，测试一下看是否能够开机成功。</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    小编这里显示已经成功的开机了！你那边怎么样了？</span><br><span class="line">    一般当我们恢复过之后，其中的分区信息能够显示出来就表明恢复已经成功，我们这个实验是在虚拟机上进行的，现实中的磁盘跟我们的操作思想是一样的。只不过是我们要把磁盘拔下来，插到另一个主机上进行恢复，其思想是完全一样的。</span><br><span class="line">    有时候我们没有备份磁盘的<span class="symbol">MBR</span>区，但是只要我们有相同分区类型的磁盘（注意：是完全相同的分区类型，其中的数据可以不一样，我们需要的是恢复启动引导和分区表位以及结束位。）也是可以同过这个方法来恢复的。把小编上面演示中的备份文件换成完好的磁盘设备就可以了。</span><br></pre></td></tr></table></figure>



<h3 id="开机检测程序"><a href="#开机检测程序" class="headerlink" title="开机检测程序"></a>开机检测程序</h3><h4 id="1-BIOS"><a href="#1-BIOS" class="headerlink" title="1. BIOS"></a>1. BIOS</h4><p>BIOS（Basic Input/Output System，基本输入输出系统），它是一个固件（嵌入在硬件中的软件），BIOS 程序存放在断电后内容不会丢失的只读内存中。</p>
<p><a href="https://camo.githubusercontent.com/b84becd8165f5cca61ae77ad3319a3e19abe5ddb4a771ea7903027a3fc86763d/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f35303833316136662d323737372d343665612d613537312d3239663233633835636332312e6a7067" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/b84becd8165f5cca61ae77ad3319a3e19abe5ddb4a771ea7903027a3fc86763d/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f35303833316136662d323737372d343665612d613537312d3239663233633835636332312e6a7067" alt="img"></a></p>
<p>BIOS 是开机的时候计算机执行的第一个程序，这个程序知道可以开机的磁盘，并读取磁盘第一个扇区的主要开机记录（MBR），由主要开机记录（MBR）执行其中的开机管理程序，这个开机管理程序会加载操作系统的核心文件。</p>
<p>主要开机记录（MBR）中的开机管理程序提供以下功能：选单、载入核心文件以及转交其它开机管理程序。转交这个功能可以用来实现多重引导，只需要将另一个操作系统的开机管理程序安装在其它分区的启动扇区上，在启动开机管理程序时，就可以通过选单选择启动当前的操作系统或者转交给其它开机管理程序从而启动另一个操作系统。</p>
<p>下图中，第一扇区的主要开机记录（MBR）中的开机管理程序提供了两个选单：M1、M2，M1 指向了 Windows 操作系统，而 M2 指向其它分区的启动扇区，里面包含了另外一个开机管理程序，提供了一个指向 Linux 的选单。</p>
<p><a href="https://camo.githubusercontent.com/f2aa270d96a0bb98df4393e2abe4214a318ff444033f1c5a062bc75a3426a430/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66393030663236362d613332332d343262322d626334332d3231386664623838313161382e6a7067" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/f2aa270d96a0bb98df4393e2abe4214a318ff444033f1c5a062bc75a3426a430/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f66393030663236362d613332332d343262322d626334332d3231386664623838313161382e6a7067" alt="img"></a></p>
<p>安装多重引导，最好先安装 Windows 再安装 Linux。因为安装 Windows 时会覆盖掉主要开机记录（MBR），而 Linux 可以选择将开机管理程序安装在主要开机记录（MBR）或者其它分区的启动扇区，并且可以设置开机管理程序的选单。</p>
<h4 id="2-UEFI"><a href="#2-UEFI" class="headerlink" title="2. UEFI"></a>2. UEFI</h4><p>BIOS 不可以读取 GPT 分区表，而 UEFI 可以。</p>
<h2 id="四、文件系统"><a href="#四、文件系统" class="headerlink" title="四、文件系统"></a>四、文件系统</h2><h3 id="分区与文件系统"><a href="#分区与文件系统" class="headerlink" title="分区与文件系统"></a>分区与文件系统</h3><p>对分区进行格式化是为了在分区上建立文件系统。一个分区通常只能格式化为一个文件系统，但是磁盘阵列等技术可以将一个分区格式化为多个文件系统。</p>
<h3 id="组成"><a href="#组成" class="headerlink" title="组成"></a>组成</h3><p>最主要的几个组成部分如下：</p>
<ul>
<li>inode：一个文件占用一个 inode，记录文件的属性，同时记录此文件的内容所在的 block 编号；</li>
<li>block：记录文件的内容，文件太大时，会占用多个 block。</li>
</ul>
<p>除此之外还包括：</p>
<ul>
<li>superblock：记录文件系统的整体信息，包括 inode 和 block 的总量、使用量、剩余量，以及文件系统的格式与相关信息等；</li>
<li>block bitmap：记录 block 是否被使用的位图。</li>
</ul>
<p><a href="https://camo.githubusercontent.com/c6f99088c61435a2a5a3736e501a3333c52eb5e584bdd7be466ec633202f7999/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f4253445f6469736b2e706e67" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/c6f99088c61435a2a5a3736e501a3333c52eb5e584bdd7be466ec633202f7999/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f4253445f6469736b2e706e67" alt="img"></a></p>
<h3 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h3><p>对于 Ext2 文件系统，当要读取一个文件的内容时，先在 inode 中查找文件内容所在的所有 block，然后把所有 block 的内容读出来。</p>
<p><a href="https://camo.githubusercontent.com/5ea44f61c614c1fc9253d0229d364bbdb3345194bde7860c1d07554d355921f1/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31326136356363362d323065302d343730362d396665362d3362613439343133643766362e706e67" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/5ea44f61c614c1fc9253d0229d364bbdb3345194bde7860c1d07554d355921f1/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31326136356363362d323065302d343730362d396665362d3362613439343133643766362e706e67" alt="img"></a></p>
<p>而对于 FAT 文件系统，它没有 inode，每个 block 中存储着下一个 block 的编号。</p>
<p><a href="https://camo.githubusercontent.com/f4a1c1c15682fed01e0a3e8be8f592e4fce14c2d270a2a1429453b86e5195080/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f35623731386538362d373130322d346262362d386361352d6431646437393135333063352e706e67" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/f4a1c1c15682fed01e0a3e8be8f592e4fce14c2d270a2a1429453b86e5195080/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f35623731386538362d373130322d346262362d386361352d6431646437393135333063352e706e67" alt="img"></a></p>
<h3 id="磁盘碎片"><a href="#磁盘碎片" class="headerlink" title="磁盘碎片"></a>磁盘碎片</h3><p>指一个文件内容所在的 block 过于分散，导致磁盘磁头移动距离过大，从而降低磁盘读写性能。</p>
<h3 id="block"><a href="#block" class="headerlink" title="block"></a>block</h3><p>在 Ext2 文件系统中所支持的 block 大小有 1K，2K 及 4K 三种，不同的大小限制了单个文件和文件系统的最大大小。</p>
<table>
<thead>
<tr>
<th>大小</th>
<th>1KB</th>
<th>2KB</th>
<th>4KB</th>
</tr>
</thead>
<tbody><tr>
<td>最大单一文件</td>
<td>16GB</td>
<td>256GB</td>
<td>2TB</td>
</tr>
<tr>
<td>最大文件系统</td>
<td>2TB</td>
<td>8TB</td>
<td>16TB</td>
</tr>
</tbody></table>
<p>一个 block 只能被一个文件所使用，未使用的部分直接浪费了。因此如果需要存储大量的小文件，那么最好选用比较小的 block。</p>
<h3 id="inode"><a href="#inode" class="headerlink" title="inode"></a>inode</h3><p>inode 具体包含以下信息：</p>
<ul>
<li>权限 (read/write/excute)；</li>
<li>拥有者与群组 (owner/group)；</li>
<li>容量；</li>
<li>建立或状态改变的时间 (ctime)；</li>
<li>最近读取时间 (atime)；</li>
<li>最近修改时间 (mtime)；</li>
<li>定义文件特性的旗标 (flag)，如 SetUID…；</li>
<li>该文件真正内容的指向 (pointer)。</li>
</ul>
<p>inode 具有以下特点：</p>
<ul>
<li>每个 inode 大小均固定为 128 bytes (新的 ext4 与 xfs 可设定到 256 bytes)；</li>
<li>每个文件都仅会占用一个 inode。</li>
</ul>
<p>inode 中记录了文件内容所在的 block 编号，但是每个 block 非常小，一个大文件随便都需要几十万的 block。而一个 inode 大小有限，无法直接引用这么多 block 编号。因此引入了间接、双间接、三间接引用。间接引用让 inode 记录的引用 block 块记录引用信息。</p>
<p><a href="https://camo.githubusercontent.com/36335e16eb28652bb66ca46edba6040f1bcfcabce0b3fbcdf1d18111ffc52b28/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f696e6f64655f776974685f7369676e6174757265732e6a7067" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/36335e16eb28652bb66ca46edba6040f1bcfcabce0b3fbcdf1d18111ffc52b28/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f696e6f64655f776974685f7369676e6174757265732e6a7067" alt="img"></a></p>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><p>建立一个目录时，会分配一个 inode 与至少一个 block。block 记录的内容是目录下所有文件的 inode 编号以及文件名。</p>
<p>可以看到文件的 inode 本身不记录文件名，文件名记录在目录中，因此新增文件、删除文件、更改文件名这些操作与目录的写权限有关。</p>
<h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><p>如果突然断电，那么文件系统会发生错误，例如断电前只修改了 block bitmap，而还没有将数据真正写入 block 中。</p>
<p>ext3/ext4 文件系统引入了日志功能，可以利用日志来修复文件系统。</p>
<h3 id="挂载"><a href="#挂载" class="headerlink" title="挂载"></a>挂载</h3><p>挂载利用目录作为文件系统的进入点，也就是说，进入目录之后就可以读取文件系统的数据。</p>
<h3 id="目录配置"><a href="#目录配置" class="headerlink" title="目录配置"></a>目录配置</h3><p>为了使不同 Linux 发行版本的目录结构保持一致性，Filesystem Hierarchy Standard (FHS) 规定了 Linux 的目录结构。最基础的三个目录如下：</p>
<ul>
<li>/ (root, 根目录)</li>
<li>/usr (unix software resource)：所有系统默认软件都会安装到这个目录；</li>
<li>/var (variable)：存放系统或程序运行过程中的数据文件。</li>
</ul>
<p><a href="https://camo.githubusercontent.com/c89a9597946ed0c7f045dd31df0ee669d2851e73f9d502f37c4694192dc7d1f8/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f6c696e75782d66696c6573797374656d2e706e67" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/c89a9597946ed0c7f045dd31df0ee669d2851e73f9d502f37c4694192dc7d1f8/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f6c696e75782d66696c6573797374656d2e706e67" alt="img"></a></p>
<h2 id="五、文件"><a href="#五、文件" class="headerlink" title="五、文件"></a>五、文件</h2><h3 id="文件属性"><a href="#文件属性" class="headerlink" title="文件属性"></a>文件属性</h3><p>用户分为三种：文件拥有者、群组以及其它人，对不同的用户有不同的文件权限。</p>
<p>使用 ls 查看一个文件时，会显示一个文件的信息，例如 <code>drwxr-xr-x 3 root root 17 May 6 00:14 .config</code>，对这个信息的解释如下：</p>
<ul>
<li>drwxr-xr-x：文件类型以及权限，第 1 位为文件类型字段，后 9 位为文件权限字段</li>
<li>3：链接数</li>
<li>root：文件拥有者</li>
<li>root：所属群组</li>
<li>17：文件大小</li>
<li>May 6 00:14：文件最后被修改的时间</li>
<li>.config：文件名</li>
</ul>
<p>常见的文件类型及其含义有：</p>
<ul>
<li>d：目录</li>
<li>-：文件</li>
<li>l：链接文件</li>
</ul>
<p>9 位的文件权限字段中，每 3 个为一组，共 3 组，每一组分别代表对文件拥有者、所属群组以及其它人的文件权限。一组权限中的 3 位分别为 r、w、x 权限，表示可读、可写、可执行。</p>
<p>文件时间有以下三种：</p>
<ul>
<li>modification time (mtime)：文件的内容更新就会更新；</li>
<li>status time (ctime)：文件的状态（权限、属性）更新就会更新；</li>
<li>access time (atime)：读取文件时就会更新。</li>
</ul>
<h3 id="文件与目录的基本操作"><a href="#文件与目录的基本操作" class="headerlink" title="文件与目录的基本操作"></a>文件与目录的基本操作</h3><h4 id="1-ls"><a href="#1-ls" class="headerlink" title="1. ls"></a>1. ls</h4><p>列出文件或者目录的信息，目录的信息就是其中包含的文件。</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ls [-aAdfFhilnrRSt] file|dir</span></span><br><span class="line"><span class="literal">-a ：列出全部的文件</span></span><br><span class="line"><span class="literal">-d ：仅列出目录本身</span></span><br><span class="line"><span class="literal">-l ：以长数据串行列出，包含文件的属性与权限等等数据</span></span><br></pre></td></tr></table></figure>

<h4 id="2-cd"><a href="#2-cd" class="headerlink" title="2. cd"></a>2. cd</h4><p>更换当前目录。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">cd</span><span class="meta"> [相对路径或绝对路径]</span></span><br></pre></td></tr></table></figure>

<h4 id="3-mkdir"><a href="#3-mkdir" class="headerlink" title="3. mkdir"></a>3. mkdir</h4><p>创建目录。</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## mkdir [-mp] 目录名称</span></span><br><span class="line"><span class="literal">-m ：配置目录权限</span></span><br><span class="line"><span class="literal">-p ：递归创建目录</span></span><br></pre></td></tr></table></figure>

<h4 id="4-rmdir"><a href="#4-rmdir" class="headerlink" title="4. rmdir"></a>4. rmdir</h4><p>删除目录，目录必须为空。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rmdir</span> [-p] 目录名称</span><br><span class="line">-p ：递归删除目录</span><br></pre></td></tr></table></figure>

<h4 id="5-touch"><a href="#5-touch" class="headerlink" title="5. touch"></a>5. touch</h4><p>更新文件时间或者建立新文件。</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">## touch [-acdmt] filename</span><br><span class="line">-<span class="ruby">a ： 更新 atime</span></span><br><span class="line"><span class="ruby">-c ： 更新 ctime，若该文件不存在则不建立新文件</span></span><br><span class="line"><span class="ruby">-m ： 更新 mtime</span></span><br><span class="line"><span class="ruby">-d ： 后面可以接更新日期而不使用当前日期，也可以使用 --date=<span class="string">"日期或时间"</span></span></span><br><span class="line"><span class="ruby">-t ： 后面可以接更新时间而不使用当前时间，格式为[YYYYMMDDhhmm]</span></span><br></pre></td></tr></table></figure>

<h4 id="6-cp"><a href="#6-cp" class="headerlink" title="6. cp"></a>6. cp</h4><p>复制文件。如果源文件有两个以上，则目的文件一定要是目录才行。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cp</span> [-adfilprsu] <span class="keyword">source</span> destination</span><br><span class="line">-<span class="keyword">a</span> ：相当于 -<span class="keyword">dr</span> --<span class="keyword">preserve</span>=<span class="keyword">all</span></span><br><span class="line">-d ：若来源文件为链接文件，则复制链接文件属性而非文件本身</span><br><span class="line">-i ：若目标文件已经存在时，在覆盖前会先询问</span><br><span class="line">-<span class="keyword">p</span> ：连同文件的属性一起复制过去</span><br><span class="line">-r ：递归复制</span><br><span class="line">-<span class="keyword">u</span> ：destination 比 <span class="keyword">source</span> 旧才更新 destination，或 destination 不存在的情况下才复制</span><br><span class="line">--<span class="keyword">preserve</span>=<span class="keyword">all</span> ：除了 -<span class="keyword">p</span> 的权限相关参数外，还加入 SELinux 的属性, links, xattr 等也复制了</span><br></pre></td></tr></table></figure>

<h4 id="7-rm"><a href="#7-rm" class="headerlink" title="7. rm"></a>7. rm</h4><p>删除文件。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## rm [-fir] 文件或目录</span></span><br><span class="line">-r ：递归删除</span><br><span class="line"></span><br><span class="line">解决linux删除文件后空间没有释放问题</span><br><span class="line"><span class="symbol">https:</span>/<span class="regexp">/www.cnblogs.com/mfryf</span><span class="regexp">/p/</span><span class="number">3334451</span>.html</span><br><span class="line">[root<span class="variable">@ticketb</span> ~]<span class="comment"># lsof |grep deleted</span></span><br></pre></td></tr></table></figure>



<h4 id="8-mv"><a href="#8-mv" class="headerlink" title="8. mv"></a>8. mv</h4><p>移动文件。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">## mv [-fiu] source destination</span><br><span class="line">## mv [options] source1 source2 source3 .... directory</span><br><span class="line">-f ： force 强制的意思，如果目标文件已经存在，不会询问而直接覆盖</span><br></pre></td></tr></table></figure>

<h3 id="修改权限"><a href="#修改权限" class="headerlink" title="修改权限"></a>修改权限</h3><p>可以将一组权限用数字来表示，此时一组权限的 3 个位当做二进制数字的位，从左到右每个位的权值为 4、2、1，即每个权限对应的数字权值为 r : 4、w : 2、x : 1。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## chmod [-R] xyz dirname/filename</span><br></pre></td></tr></table></figure>

<p>示例：将 .bashrc 文件的权限修改为 -rwxr-xr–。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## chmod <span class="number">754</span> .bashrc</span><br></pre></td></tr></table></figure>

<p>也可以使用符号来设定权限。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">## chmod [ugoa]  [+-=] [rwx] dirname/filename</span></span><br><span class="line"><span class="bullet">- </span>u：拥有者</span><br><span class="line"><span class="bullet">- </span>g：所属群组</span><br><span class="line"><span class="bullet">- </span>o：其他人</span><br><span class="line"><span class="bullet">- </span>a：所有人</span><br><span class="line"><span class="bullet">- </span>+：添加权限</span><br><span class="line"><span class="bullet">- </span>-：移除权限</span><br><span class="line"><span class="bullet">- </span>=：设定权限</span><br></pre></td></tr></table></figure>

<p>示例：为 .bashrc 文件的所有用户添加写权限。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># chmod a+w .bashrc</span></span></span><br></pre></td></tr></table></figure>

<h3 id="默认权限"><a href="#默认权限" class="headerlink" title="默认权限"></a>默认权限</h3><ul>
<li>文件默认权限：文件默认没有可执行权限，因此为 666，也就是 -rw-rw-rw- 。</li>
<li>目录默认权限：目录必须要能够进入，也就是必须拥有可执行权限，因此为 777 ，也就是 drwxrwxrwx。</li>
</ul>
<p>可以通过 umask 设置或者查看默认权限，通常以掩码的形式来表示，例如 002 表示其它用户的权限去除了一个 2 的权限，也就是写权限，因此建立新文件时默认的权限为 -rw-rw-r–。</p>
<h3 id="目录的权限"><a href="#目录的权限" class="headerlink" title="目录的权限"></a>目录的权限</h3><p>文件名不是存储在一个文件的内容中，而是存储在一个文件所在的目录中。因此，拥有文件的 w 权限并不能对文件名进行修改。</p>
<p>目录存储文件列表，一个目录的权限也就是对其文件列表的权限。因此，目录的 r 权限表示可以读取文件列表；w 权限表示可以修改文件列表，具体来说，就是添加删除文件，对文件名进行修改；x 权限可以让该目录成为工作目录，x 权限是 r 和 w 权限的基础，如果不能使一个目录成为工作目录，也就没办法读取文件列表以及对文件列表进行修改了。</p>
<h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3><p><a href="https://camo.githubusercontent.com/2b0c839d61700c8ef2caf3190cb6d42e66a1277b266f695190cecc9a244034e2/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31653436666430332d306364612d346436302d396231632d3063323536656461663662322e706e67" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/2b0c839d61700c8ef2caf3190cb6d42e66a1277b266f695190cecc9a244034e2/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f31653436666430332d306364612d346436302d396231632d3063323536656461663662322e706e67" alt="img"></a></p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ln [-sf] source_filename dist_filename</span></span><br><span class="line"><span class="literal">-s ：默认是实体链接，加 -s 为符号链接</span></span><br><span class="line"><span class="literal">-f ：如果目标文件存在时，先删除目标文件</span></span><br></pre></td></tr></table></figure>

<h4 id="1-实体链接"><a href="#1-实体链接" class="headerlink" title="1. 实体链接"></a>1. 实体链接</h4><p>在目录下创建一个条目，记录着文件名与 inode 编号，这个 inode 就是源文件的 inode。</p>
<p>删除任意一个条目，文件还是存在，只要引用数量不为 0。</p>
<p>有以下限制：不能跨越文件系统、不能对目录进行链接。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ln /etc/crontab .</span></span><br><span class="line"><span class="comment">## ll -i /etc/crontab crontab</span></span><br><span class="line"><span class="number">34474855</span> <span class="string">-rw-r--r--.</span> <span class="number">2</span> <span class="string">root</span> <span class="string">root</span> <span class="number">451</span> <span class="string">Jun</span> <span class="number">10</span> <span class="number">2014</span> <span class="string">crontab</span></span><br><span class="line"><span class="number">34474855</span> <span class="string">-rw-r--r--.</span> <span class="number">2</span> <span class="string">root</span> <span class="string">root</span> <span class="number">451</span> <span class="string">Jun</span> <span class="number">10</span> <span class="number">2014</span> <span class="string">/etc/crontab</span></span><br></pre></td></tr></table></figure>

<h4 id="2-符号链接"><a href="#2-符号链接" class="headerlink" title="2. 符号链接"></a>2. 符号链接</h4><p>符号链接文件保存着源文件所在的绝对路径，在读取时会定位到源文件上，可以理解为 Windows 的快捷方式。</p>
<p>当源文件被删除了，链接文件就打不开了。</p>
<p>因为记录的是路径，所以可以为目录建立符号链接。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">## ll -i /etc/crontab /root/crontab2</span><br><span class="line"><span class="number">34474855</span> -rw-r--r--. <span class="number">2</span> root root <span class="number">451</span> Jun <span class="number">10</span> <span class="number">2014</span> /etc/crontab</span><br><span class="line"><span class="number">53745909</span> lrwxrwxrwx. <span class="number">1</span> root root <span class="number">12</span> Jun <span class="number">23</span> <span class="number">22</span>:<span class="number">31</span> /root/crontab2 -&gt; /etc/crontab</span><br></pre></td></tr></table></figure>

<h3 id="获取文件内容"><a href="#获取文件内容" class="headerlink" title="获取文件内容"></a>获取文件内容</h3><h4 id="1-cat"><a href="#1-cat" class="headerlink" title="1. cat"></a>1. cat</h4><p>取得文件内容。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## cat [-AbEnTv] filename</span><br><span class="line">-n ：打印出行号，连同空白行也会有行号，-b 不会</span><br></pre></td></tr></table></figure>

<p>cat突破</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">突破</span><br><span class="line">在搜索引擎项目工作时，看到过研发工程师在调试问题时这样使用了cat——他们启动服务后，使用了命令cat some_data.txt &gt; /dev/<span class="literal">null</span>，虽然当时没有直接向他们请教原委，但这个命令给我留下了深刻的印象：</span><br><span class="line">/dev/<span class="literal">null</span>是linux的位桶文件，写入它的内容会永远丢失，从它那里什么也读取不到。一般用法是想丢弃命令产生的标准输出和标准错误时，通常使用command &gt; /dev/<span class="literal">null</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span>，因此，cat some_data.txt &gt; /dev/<span class="literal">null</span>似乎没有任何效果。</span><br><span class="line">当时观察到cat some_data.txt &gt; /dev/<span class="literal">null</span>这个命令的执行时间常长，这说明了some_data.txt这个文件也足够大。但第二次执行这个命令时，执行时间则大大缩减了。</span><br><span class="line">由以上大致可以判断出，该用法是为了将文件内容导入到内存中，以便需要使用文件内容时能够快速获取。一般来说，从硬盘中读取数据需要<span class="number">5</span>ms到<span class="number">10</span>ms的时间，而从内存中读取数据时通常只需要<span class="number">50</span>ns到<span class="number">100</span>ns的时间，这就是page cache（页高速缓冲存储器）的作用。</span><br><span class="line"></span><br><span class="line">总结</span><br><span class="line">这个经历给我的体会是，许多时候，我们认为自己掌握了全部或绝大部分，而实际上，只是因为自己知道的太少，并且不认为自己知道的太少——我们压根不觉得是因为自己不知道。就像美国前国防部长拉姆斯菲尔德说过的那样：</span><br><span class="line">because as we know, there are known knowns; there are things we know we know. We also know there are known unknowns; that <span class="keyword">is</span> to say we know there are some things we <span class="keyword">do</span> <span class="keyword">not</span> know. But there are also unknown unknowns - the ones we don<span class="string">'t know we don'</span>t know.</span><br><span class="line">我们有已知的已知，已知的未知，以及未知的未知。</span><br><span class="line"></span><br><span class="line"> 其它读文件：</span><br><span class="line">cat     由第一行开始显示内容，并将所有内容输出</span><br><span class="line">tac     从最后一行倒序显示内容，并将所有内容输出</span><br><span class="line">more    根据窗口大小，一页一页的显示文件内容</span><br><span class="line">less    和more类似，但其优点可以往前翻页，而且进行可以搜索字符</span><br><span class="line">head    只显示头几行</span><br><span class="line">tail    只显示最后几行</span><br><span class="line">nl     类似于cat -n，显示时输出行号</span><br><span class="line"></span><br><span class="line">https:<span class="comment">//www.cnblogs.com/chenxiaomeng/p/10066821.html</span></span><br><span class="line">echo <span class="string">"123456789abcdefghjklmnopq"</span> | cut -b <span class="number">11</span><span class="number">-14</span></span><br></pre></td></tr></table></figure>



<h4 id="2-tac"><a href="#2-tac" class="headerlink" title="2. tac"></a>2. tac</h4><p>是 cat 的反向操作，从最后一行开始打印。</p>
<h4 id="3-more"><a href="#3-more" class="headerlink" title="3. more"></a>3. more</h4><p>和 cat 不同的是它可以一页一页查看文件内容，比较适合大文件的查看。</p>
<h4 id="4-less"><a href="#4-less" class="headerlink" title="4. less"></a>4. less</h4><p>和 more 类似，但是多了一个向前翻页的功能。</p>
<h4 id="5-head"><a href="#5-head" class="headerlink" title="5. head"></a>5. head</h4><p>取得文件前几行。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## head [-n number] filename</span><br><span class="line">-n ：后面接数字，代表显示几行的意思</span><br></pre></td></tr></table></figure>



<h4 id="6-tail"><a href="#6-tail" class="headerlink" title="6. tail"></a>6. tail</h4><p>是 head 的反向操作，只是取得是后几行。</p>
<h4 id="7-od"><a href="#7-od" class="headerlink" title="7. od"></a>7. od</h4><p>以字符或者十六进制的形式显示二进制文件。</p>
<h4 id="column-对齐"><a href="#column-对齐" class="headerlink" title="column :对齐"></a>column :对齐</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">以将文本结果转换为整齐的表格，上下对齐</span><br><span class="line">命令: Column</span><br><span class="line">使用的参数：</span><br><span class="line">-t ：表格，默认以空格间隔</span><br><span class="line">-s：需要配合-t使用，指定分隔符</span><br><span class="line"></span><br><span class="line">-t举例：</span><br><span class="line">[root@uyhd000225 ~]# mount</span><br><span class="line">/dev/hda1 on /<span class="built_in"> type </span>ext3 (rw)</span><br><span class="line">proc on /proc<span class="built_in"> type </span>proc (rw)</span><br><span class="line">sysfs on /sys<span class="built_in"> type </span>sysfs (rw)</span><br><span class="line">devpts on /dev/pts<span class="built_in"> type </span>devpts (rw,<span class="attribute">gid</span>=5,mode=620)</span><br><span class="line">tmpfs on /dev/shm<span class="built_in"> type </span>tmpfs (rw)</span><br><span class="line">/dev/xvdb1 on /data<span class="built_in"> type </span>ext3 (rw)</span><br><span class="line">none on /proc/sys/fs/binfmt_misc<span class="built_in"> type </span>binfmt_misc (rw)</span><br><span class="line">[root@uyhd000225 ~]# mount |column -t</span><br><span class="line">/dev/hda1   on  /                        <span class="built_in"> type </span> ext3         (rw)</span><br><span class="line">proc        on  /proc                    <span class="built_in"> type </span> proc         (rw)</span><br><span class="line">sysfs       on  /sys                     <span class="built_in"> type </span> sysfs        (rw)</span><br><span class="line">devpts      on  /dev/pts                 <span class="built_in"> type </span> devpts       (rw,<span class="attribute">gid</span>=5,mode=620)</span><br><span class="line">tmpfs       on  /dev/shm                 <span class="built_in"> type </span> tmpfs        (rw)</span><br><span class="line">/dev/xvdb1  on  /data                    <span class="built_in"> type </span> ext3         (rw)</span><br><span class="line">none        on  /proc/sys/fs/binfmt_misc <span class="built_in"> type </span> binfmt_misc  (rw)</span><br><span class="line"></span><br><span class="line">-s举例：</span><br><span class="line">[root@uyhd000225 testDir]# cat testcolumn</span><br><span class="line">Jackie | 18 | male</span><br><span class="line">Helen | 20 | female</span><br><span class="line">Daniel Liu | 23 | male</span><br><span class="line">[root@uyhd000225 testDir]# cat testcolumn | column -s <span class="string">'|'</span> -t</span><br><span class="line">Jackie        18    male</span><br><span class="line">Helen         20    female</span><br><span class="line">Daniel Liu    23    male</span><br></pre></td></tr></table></figure>

<h4 id="stat：文件的状态信息"><a href="#stat：文件的状态信息" class="headerlink" title="stat：文件的状态信息"></a>stat：文件的状态信息</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stat</span>命令文件权限属性设置</span><br><span class="line"><span class="built_in">stat</span>命令用于显示文件的状态信息。</span><br><span class="line"><span class="built_in">stat</span>命令的输出信息比ls命令的输出信息要更详细。</span><br><span class="line">语法 <span class="built_in">stat</span>(选项)(参数)</span><br><span class="line">选项</span><br><span class="line">-L：支持符号连接；</span><br><span class="line">-f：显示文件系统状态而非文件状态；</span><br><span class="line">-t：以简洁方式输出信息；</span><br><span class="line">--<span class="built_in">help</span>：显示指令的帮助信息；</span><br><span class="line">--version：显示指令的版本信息。</span><br><span class="line"></span><br><span class="line">参数</span><br><span class="line">文件：指定要显示信息的普通文件或者文件系统对应的设备文件名。</span><br></pre></td></tr></table></figure>

<h4 id="paste-d"><a href="#paste-d" class="headerlink" title="paste -d,"></a>paste -d,</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="meta">@host</span>102442549 ChunkServer]# cat /etc/snbs.conf.back|grep -E <span class="string">"VolDev"</span>|awk -F = <span class="string">'&#123;print <span class="subst">$2</span>&#125;'</span>|sed <span class="string">'s/,/\n/g'</span></span><br><span class="line">sdb</span><br><span class="line">sdc</span><br><span class="line">sdd</span><br><span class="line">sde</span><br><span class="line">sdf</span><br><span class="line">sdh</span><br><span class="line">sdi</span><br><span class="line">sdj</span><br><span class="line">[root<span class="meta">@host</span>102442549 ChunkServer]# lsblk|grep <span class="string">"5.7G"</span>|awk <span class="string">'&#123;print <span class="subst">$1</span>&#125;'</span>|sed <span class="string">'s/├─//g'</span></span><br><span class="line">sdg1</span><br><span class="line">sdg2</span><br><span class="line">sdg3</span><br><span class="line">sdg4</span><br><span class="line">sdg5</span><br><span class="line">sdg6</span><br><span class="line">sdg7</span><br><span class="line">sdg8</span><br><span class="line">[root<span class="meta">@host</span>102442549 ChunkServer]# cat /etc/snbs.conf.back|grep -E <span class="string">"VolDev"</span>|awk -F = <span class="string">'&#123;print <span class="subst">$2</span>&#125;'</span>|sed <span class="string">'s/,/\n/g'</span> &gt;&gt; disk.txt;lsblk|grep <span class="string">"5.7G"</span>|awk <span class="string">'&#123;print <span class="subst">$1</span>&#125;'</span>|sed <span class="string">'s/├─//g'</span> &gt;&gt; cache.sh</span><br><span class="line">[root<span class="meta">@host</span>102442549 ChunkServer]# </span><br><span class="line">[root<span class="meta">@host</span>102442549 ChunkServer]# </span><br><span class="line">[root<span class="meta">@host</span>102442549 ChunkServer]# paste -d, disk.txt cache.sh</span><br><span class="line">sdb,sdg1</span><br><span class="line">sdc,sdg2</span><br><span class="line">sdd,sdg3</span><br><span class="line">sde,sdg4</span><br><span class="line">sdf,sdg5</span><br><span class="line">sdh,sdg6</span><br><span class="line">sdi,sdg7</span><br><span class="line">sdj,sdg8</span><br></pre></td></tr></table></figure>



<h4 id="split"><a href="#split" class="headerlink" title="split"></a>split</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">split</span> -b <span class="number">10</span>k <span class="built_in">date</span>.<span class="built_in">file</span> -d -<span class="keyword">a</span> <span class="number">3</span></span><br><span class="line"><span class="built_in">split</span> -l <span class="number">500000</span> -d -<span class="keyword">a</span> <span class="number">3</span> $<span class="number">1</span> value_</span><br><span class="line"><span class="built_in">split</span> -b <span class="number">300</span>m <span class="built_in">date</span>.<span class="built_in">file</span>  -d -<span class="keyword">a</span> <span class="number">3</span> $<span class="number">1</span> value_</span><br><span class="line"><span class="built_in">split</span> -b <span class="number">5</span>m check-error.<span class="built_in">log</span> -d -<span class="keyword">a</span> <span class="number">3</span> value_</span><br><span class="line"></span><br><span class="line"><span class="built_in">split</span> -l <span class="number">10</span> <span class="built_in">date</span>.<span class="built_in">file</span>按行切割</span><br><span class="line"></span><br><span class="line"><span class="built_in">split</span> -l -d -<span class="keyword">a</span> <span class="number">3</span> value_</span><br></pre></td></tr></table></figure>



<h4 id="qemu-img"><a href="#qemu-img" class="headerlink" title="qemu-img"></a>qemu-img</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">qemu-img convert -S 8k -f qcow2  CentOS7U3_GLOBAL_64bit_75G_20180404_APP.qcow2 -O <span class="built_in"> raw </span>/dev/sdc1   ----直接将qcow2文件转换并写入sdc1磁盘，记得设置-S 8k   ---这个参数指定稀疏拷贝，只写有效数据@王星童</span><br><span class="line"></span><br><span class="line">qemu-img convert -S 8k -f qcow2 new_sdoss-50G-20190225.qcow2 -O<span class="built_in"> raw </span>/os_instance/cyq.raw</span><br><span class="line">qemu-img convert -S 8k -f qcow2 new_sdoss-50G-20190225.qcow2 -O<span class="built_in"> raw </span>/dev/sdc</span><br><span class="line"></span><br><span class="line">在centos7上可以安装这个qemu-img工具，以覆盖方安装。</span><br><span class="line">rpm -ivh --force --nodeps qemu-img-ev-2.6.0-28.el7.centos.10.1.x86_64.rpm</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------</span><br><span class="line">1.yum install  qemu-img</span><br><span class="line"></span><br><span class="line">2.qcw2镜像转化为raw镜像文件</span><br><span class="line">qemu-img convert -f qcow2  CentOS7U3_GLOBAL_64bit_75G_20180404_APP.qcow2 -O <span class="built_in"> raw </span>CentOS7U3.raw</span><br><span class="line"></span><br><span class="line">3.raw镜像转化为qcw2镜像文件</span><br><span class="line">qemu-img convert -f qcow2  win7.raw  -O <span class="built_in"> raw </span> win7.qcow2</span><br><span class="line"></span><br><span class="line">4.压测环境上传：</span><br><span class="line">time qemu-img convert -S 8k -f qcow2 -O<span class="built_in"> raw </span>/os_data/RHEL6U3_GLOBAL_64bit_75G_20180109_APP.qcow2 /mnt/snbsfuse/snpool001/fusetest</span><br></pre></td></tr></table></figure>



<h4 id="dd"><a href="#dd" class="headerlink" title="dd"></a>dd</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>是来源，of是目的。</span><br><span class="line">生成一个5G的文件：</span><br><span class="line">dd <span class="attribute">if</span>=/dev/zero <span class="attribute">of</span>=/tmp/test.txt <span class="attribute">bs</span>=1M <span class="attribute">count</span>=5120</span><br><span class="line">dd <span class="attribute">if</span>=/dev/zero <span class="attribute">of</span>=/tmp/test.txt <span class="attribute">bs</span>=1M <span class="attribute">count</span>=5120</span><br><span class="line">读：</span><br><span class="line">dd <span class="attribute">if</span>=/dev/sdb <span class="attribute">of</span>=/dev/null <span class="attribute">bs</span>=4k</span><br><span class="line">dd <span class="attribute">if</span>=/dev/sdb <span class="attribute">of</span>=/testrw.dbf <span class="attribute">bs</span>=4k</span><br><span class="line"></span><br><span class="line">读磁盘io：</span><br><span class="line">先dd一个5g的文件：</span><br><span class="line">dd <span class="attribute">if</span>=/dev/zero <span class="attribute">of</span>=/tmp/test.txt <span class="attribute">bs</span>=1M <span class="attribute">count</span>=5120</span><br><span class="line"></span><br><span class="line">dd <span class="attribute">if</span>=/dev/zero <span class="attribute">oflag</span>=direct <span class="attribute">of</span>=./10GB <span class="attribute">bs</span>=1M <span class="attribute">count</span>=10240</span><br><span class="line"></span><br><span class="line">dd <span class="attribute">iflag</span>=direct,nonblock <span class="attribute">oflag</span>=direct,nonblock <span class="attribute">if</span>=./bigfile <span class="attribute">of</span>=/dev/null</span><br><span class="line">金泉洁 2019-01-24 10:20:12</span><br><span class="line">dd <span class="attribute">if</span>=./bigfile <span class="attribute">iflag</span>=direct,nonblock <span class="attribute">of</span>=/dev/null</span><br></pre></td></tr></table></figure>



<h4 id="map：键值"><a href="#map：键值" class="headerlink" title="map：键值"></a>map：键值</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line">读文件放到map中：</span><br><span class="line">https://blog.csdn.net/weixin_42651205/article/details/83624574</span><br><span class="line">cat test.txt</span><br><span class="line">000000000007a16000000088:0</span><br><span class="line">000000000007a16000000089:0</span><br><span class="line">000000000007a16300000087:0</span><br><span class="line">000000000007a16800000088:0</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------</span><br><span class="line"><span class="meta">#!/bin/bash  </span></span><br><span class="line">str=(`cat ./test.txt | awk -F <span class="string">' '</span> <span class="string">'&#123;print $1&#125;'</span>`)</span><br><span class="line"><span class="built_in">declare</span> -A mymap;	<span class="comment">#定义</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$&#123;!str[@]&#125;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">eval</span> $(<span class="built_in">echo</span> <span class="variable">$&#123;str[i]&#125;</span> | awk <span class="string">'&#123;split($0, filearray, ":");print "mymap["filearray[1]"]="filearray[2]&#125;'</span>)</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#输出所有key值</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;!mymap[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出所有value值</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;mymap[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#遍历</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="variable">$&#123;!mymap[@]&#125;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;mymap[$key]&#125;</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查找和删除</span></span><br><span class="line">findkey=<span class="string">"keyx"</span></span><br><span class="line">value=<span class="string">"valuex"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;mymap[$findkey]&#125;</span></span><br><span class="line"><span class="comment">#查找插入和删除，找到就删掉，没找到就插入</span></span><br><span class="line"><span class="keyword">if</span> [ ! -n <span class="string">"<span class="variable">$&#123;mymap[$key]&#125;</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">	mymap[<span class="variable">$findkey</span>]=<span class="variable">$value</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"find value"</span></span><br><span class="line">	<span class="built_in">unset</span> mymap[<span class="variable">$findkey</span>]</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">map详解：</span><br><span class="line">https://www.cnblogs.com/yy3b2007com/p/11267237.html</span><br><span class="line">在使用map时，需要先声明，否则结果可能与预期不同，array可以不声明</span><br><span class="line">方式1：</span><br><span class="line">[root@host102442549 Master]<span class="comment"># cat 11.sh </span></span><br><span class="line"><span class="built_in">declare</span> -A myMap</span><br><span class="line">myMap[<span class="string">"my03"</span>]=<span class="string">"03"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;myMap[my03]&#125;</span></span><br><span class="line">[root@host102442549 Master]<span class="comment"># sh 11.sh </span></span><br><span class="line">03</span><br><span class="line"></span><br><span class="line">方式2：</span><br><span class="line">[root@host102442549 Master]<span class="comment"># cat 22.sh </span></span><br><span class="line"><span class="built_in">declare</span> -A myMap=([<span class="string">"my01"</span>]=<span class="string">"01"</span> [<span class="string">"my02"</span>]=<span class="string">"02"</span>)</span><br><span class="line">myMap[<span class="string">"my03"</span>]=<span class="string">"03"</span></span><br><span class="line">myMap[<span class="string">"my04"</span>]=<span class="string">"04"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;myMap[my01]&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;myMap[my02]&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;myMap[my03]&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;myMap[my04]&#125;</span></span><br><span class="line">[root@host102442549 Master]<span class="comment"># sh 22.sh </span></span><br><span class="line">01</span><br><span class="line">02</span><br><span class="line">03</span><br><span class="line">04</span><br><span class="line"></span><br><span class="line">输出Map所有的key、value、长度：</span><br><span class="line"><span class="comment"># 1）输出所有的key</span></span><br><span class="line"><span class="comment">#若未使用declare声明map，则此处将输出0，与预期输出不符，此处输出语句格式比arry多了一个！</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;!myMap[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2）输出所有value</span></span><br><span class="line"><span class="comment">#与array输出格式相同</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;myMap[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3）输出map长度</span></span><br><span class="line"><span class="comment">#与array输出格式相同</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#myMap[@]&#125;</span></span><br><span class="line"></span><br><span class="line">Map遍历：</span><br><span class="line"><span class="comment">#1)遍历，根据key找到对应的value</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="variable">$&#123;!myMap[*]&#125;</span>;<span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$key</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$&#123;myMap[$key]&#125;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#2)遍历所有的key</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="variable">$&#123;!myMap[@]&#125;</span>;<span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$key</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$&#123;myMap[$key]&#125;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#3)遍历所有的value</span></span><br><span class="line"><span class="keyword">for</span> val <span class="keyword">in</span> <span class="variable">$&#123;myMap[@]&#125;</span>;<span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$val</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">测试：</span><br><span class="line">[root@cdh-143 shell-test]<span class="comment"># more map-test.sh</span></span><br><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"一、定义Map:declare -A myMap=([\"myMap00\"]=\"00\" [\"myMap01\"]=\"01\")"</span></span><br><span class="line"><span class="built_in">declare</span> -A myMap=([<span class="string">"my00"</span>]=<span class="string">"00"</span> [<span class="string">"my01"</span>]=<span class="string">"01"</span>)</span><br><span class="line">myMap[<span class="string">"my02"</span>]=<span class="string">"02"</span></span><br><span class="line">myMap[<span class="string">"my03"</span>]=<span class="string">"03"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"二、输出所有的key:"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;!myMap[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"三、输出所有value:"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;myMap[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"四、输出map的长度:"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#myMap[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"五、遍历，根据key找到对应的value:"</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="variable">$&#123;!myMap[*]&#125;</span>;<span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"key:"</span><span class="variable">$key</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"value:"</span><span class="variable">$&#123;myMap[$key]&#125;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"六、遍历所有的key:"</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="variable">$&#123;!myMap[@]&#125;</span>;<span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"key:"</span><span class="variable">$key</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"value:"</span><span class="variable">$&#123;myMap[$key]&#125;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"七、遍历所有value:"</span></span><br><span class="line"><span class="keyword">for</span> val <span class="keyword">in</span> <span class="variable">$&#123;myMap[@]&#125;</span>;<span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"value:"</span><span class="variable">$val</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>



<h4 id="8-shuf命令"><a href="#8-shuf命令" class="headerlink" title="8. shuf命令"></a>8. shuf命令</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">shuf命令把输入行按随机顺序输出到标准输出。</span><br><span class="line"></span><br><span class="line">用法</span><br><span class="line">shuf [选项]... [文件]</span><br><span class="line">或者</span><br><span class="line">shuf -e [选项]... [参数]...</span><br><span class="line">又或者</span><br><span class="line">shuf -i LO-HI [选项]...</span><br><span class="line"></span><br><span class="line">常用参数</span><br><span class="line">-e, --echo</span><br><span class="line">将每个参数视为输入行</span><br><span class="line">-i, --input-range=LO-HI</span><br><span class="line">将LO 到HI 的每个数字视为输入行</span><br><span class="line">-n, --head-count=行数</span><br><span class="line">最多输出指定的行数</span><br><span class="line">-o, --output=文件</span><br><span class="line">将结果输出到指定文件而非标准输出</span><br><span class="line">--random-source=文件</span><br><span class="line">从指定文件获得随机比特</span><br><span class="line">-z, --zero-terminated</span><br><span class="line">以<span class="number">0</span> 结束行而非新行</span><br><span class="line">--help</span><br><span class="line">显示此帮助信息并退出</span><br><span class="line">--version</span><br><span class="line">显示版本信息并退出</span><br><span class="line">如果没有指定文件，或者文件为<span class="string">"-"</span>，则从标准输入读取。</span><br><span class="line"></span><br><span class="line">我有一个名为 ostechnix.txt 的文件，内容如下：</span><br><span class="line">$ cat ostechnix.txt</span><br><span class="line">line1</span><br><span class="line">line2</span><br><span class="line">line3</span><br><span class="line">line4</span><br><span class="line">line5</span><br><span class="line">line6</span><br><span class="line">line7</span><br><span class="line">line8</span><br><span class="line">line9</span><br><span class="line">line10</span><br><span class="line">现在让我们以随机顺序显示上面的行。为此，请运行：</span><br><span class="line">$ shuf ostechnix.txt</span><br><span class="line">line2</span><br><span class="line">line8</span><br><span class="line">line5</span><br><span class="line">line10</span><br><span class="line">line7</span><br><span class="line">line1</span><br><span class="line">line4</span><br><span class="line">line6</span><br><span class="line">line9</span><br><span class="line">line3</span><br><span class="line">看到了吗？上面的命令将名为 ostechnix.txt 中的行随机排列并输出了结果。</span><br><span class="line"></span><br><span class="line">你可能想将输出写入另一个文件。例如，我想将输出保存到 output.txt 中。为此，请先创建 output.txt：</span><br><span class="line">$ <span class="section">touch</span> output.txt</span><br><span class="line">然后，像下面使用 -o 标志将输出写入该文件：</span><br><span class="line">$ shuf ostechnix.txt -o output.txt</span><br><span class="line">上面的命令将随机随机打乱 ostechnix.txt 的内容并将输出写入 output.txt。你可以使用命令查看 output.txt 的内容：</span><br><span class="line">$ cat output.txt</span><br><span class="line">line2</span><br><span class="line">line8</span><br><span class="line">line9</span><br><span class="line">line10</span><br><span class="line">line1</span><br><span class="line">line3</span><br><span class="line">line7</span><br><span class="line">line6</span><br><span class="line">line4</span><br><span class="line">line5</span><br><span class="line">我只想显示文件中的任意一行。我该怎么做？很简单！</span><br><span class="line">$ shuf -n <span class="number">1</span> ostechnix.txt</span><br><span class="line">line6</span><br><span class="line">同样，我们可以选择前 “n” 个随机条目。以下命令将只显示前五个随机条目：</span><br><span class="line">$ shuf -n <span class="number">5</span> ostechnix.txt</span><br><span class="line">line10</span><br><span class="line">line4</span><br><span class="line">line5</span><br><span class="line">line9</span><br><span class="line">line3</span><br><span class="line">如下所示，我们可以直接使用 -e 标志传入输入，而不是从文件中读取行：</span><br><span class="line">$ shuf -e line1 line2 line3 line4 line5</span><br><span class="line">line1</span><br><span class="line">line3</span><br><span class="line">line5</span><br><span class="line">line4</span><br><span class="line">line2</span><br><span class="line">你也可以传入数字：</span><br><span class="line">$ shuf -e <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line">要快速在给定范围选择一个，请改用此命令：</span><br><span class="line">$ shuf -n <span class="number">1</span> -e <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line">或者，选择下面的任意三个随机数字：</span><br><span class="line">$ shuf -n <span class="number">3</span> -e <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">我们也可以在特定范围内生成随机数。例如，要显示 <span class="number">1</span> 到 <span class="number">10</span> 之间的随机数，只需使用：</span><br><span class="line">$ shuf -i <span class="number">1</span><span class="number">-10</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>



<h4 id="8-ASCII比较大小"><a href="#8-ASCII比较大小" class="headerlink" title="8. ASCII比较大小"></a>8. ASCII比较大小</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ASCII比较大小的时候,是比较两个数中的第一个字符 </span><br><span class="line"><span class="number">1</span>）常用字符有<span class="number">128</span>个，编码从<span class="number">0</span>到<span class="number">127</span>。 </span><br><span class="line"><span class="number">2</span>）控制字符：<span class="number">0</span>~<span class="number">31</span>、<span class="number">127</span>，共<span class="number">33</span>个，不可显示； </span><br><span class="line"><span class="number">3</span>）普通字符：<span class="number">95</span>个，包括<span class="number">10</span>个阿拉伯数字、<span class="number">52</span>个英文大小写字母、<span class="number">33</span>个运算符。 </span><br><span class="line"><span class="number">4</span>）每个字符占一个字节，<span class="number">7</span>位，最高位为<span class="number">0</span>。 </span><br><span class="line"></span><br><span class="line">常见ASCII码的大小规则，<span class="number">0</span>－<span class="number">9</span>＜A－Z＜a－z： </span><br><span class="line"><span class="number">1</span>）数字比字母要小。如 “<span class="number">7</span>”＜“F” </span><br><span class="line"><span class="number">2</span>）数字<span class="number">0</span>比数字<span class="number">9</span>要小，并按<span class="number">0</span>到<span class="number">9</span>顺序递增。如 “<span class="number">3</span>”＜“<span class="number">8</span>” </span><br><span class="line"><span class="number">3</span>）字母A比字母Z要小，并按A到Z顺序递增。如“A”＜“Z” </span><br><span class="line"><span class="number">4</span>）同个字母的大写字母比小写字母要小<span class="number">32</span>。如“A”＜“a” </span><br><span class="line"></span><br><span class="line">记住几个常见字母的ASCII码大小： </span><br><span class="line">“A”为<span class="number">65</span>；“a”为<span class="number">97</span>；“<span class="number">0</span>”为<span class="number">48</span>；</span><br></pre></td></tr></table></figure>



<h4 id="9-字符串"><a href="#9-字符串" class="headerlink" title="9. 字符串"></a>9. 字符串</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、字符串或串(String)是由数字、字母、下划线组成的一串字符。一般记为 s=“a1a2···an”(n&gt;=<span class="number">0</span>)。它是编程语言中表示文本的数据类型。在程序设计中，字符串（<span class="built_in">string</span>）为符号或数值的一个连续序列，如符号串（一串字符）或二进制数字串（一串二进制数字）。</span><br><span class="line"><span class="number">2</span>、只要用双引号“ ”括起来的都是String</span><br></pre></td></tr></table></figure>



<h3 id="指令与文件搜索"><a href="#指令与文件搜索" class="headerlink" title="指令与文件搜索"></a>指令与文件搜索</h3><h4 id="1-which"><a href="#1-which" class="headerlink" title="1. which"></a>1. which</h4><p>指令搜索。</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## which [-a] command</span></span><br><span class="line"><span class="literal">-a ：将所有指令列出，而不是只列第一个</span></span><br></pre></td></tr></table></figure>

<h4 id="2-whereis"><a href="#2-whereis" class="headerlink" title="2. whereis"></a>2. whereis</h4><p>文件搜索。速度比较快，因为它只搜索几个特定的目录。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## whereis [-bmsu] dirname/filename</span><br></pre></td></tr></table></figure>

<h4 id="3-locate"><a href="#3-locate" class="headerlink" title="3. locate"></a>3. locate</h4><p>文件搜索。可以用关键字或者正则表达式进行搜索。</p>
<p>locate 使用 /var/lib/mlocate/ 这个数据库来进行搜索，它存储在内存中，并且每天更新一次，所以无法用 locate 搜索新建的文件。可以使用 updatedb 来立即更新数据库。</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## locate [-ir] keyword</span><br><span class="line">-r：正则表达式</span><br></pre></td></tr></table></figure>

<h4 id="4-find"><a href="#4-find" class="headerlink" title="4. find"></a>4. find</h4><p>文件搜索。可以使用文件的属性和权限进行搜索。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## find [basedir] [option]</span></span><br><span class="line">example: <span class="builtin-name">find</span> . -name <span class="string">"shadow*"</span></span><br></pre></td></tr></table></figure>

<p><strong>① 与时间有关的选项</strong></p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-mtime  <span class="built_in">n</span> ：列出在 <span class="built_in">n</span> 天前的那一天修改过内容的文件</span><br><span class="line">-mtime +<span class="built_in">n</span> ：列出在 <span class="built_in">n</span> 天之前 (不含 <span class="built_in">n</span> 天本身) 修改过内容的文件</span><br><span class="line">-mtime -<span class="built_in">n</span> ：列出在 <span class="built_in">n</span> 天之内 (含 <span class="built_in">n</span> 天本身) 修改过内容的文件</span><br><span class="line">-newer file ： 列出比 file 更新的文件</span><br></pre></td></tr></table></figure>

<p>+4、4 和 -4 的指示的时间范围如下：</p>
<p><a href="https://camo.githubusercontent.com/317f225c0a18a9fd9d62ebaa0279b2377f8a1030aa562ef6132d474db8cf7506/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36353866633565372d373963302d343234372d393434352d6436396266313934633533392e706e67" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/317f225c0a18a9fd9d62ebaa0279b2377f8a1030aa562ef6132d474db8cf7506/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f36353866633565372d373963302d343234372d393434352d6436396266313934633533392e706e67" alt="img"></a></p>
<p><strong>② 与文件拥有者和所属群组有关的选项</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-uid n</span><br><span class="line">-gid n</span><br><span class="line">-user name</span><br><span class="line">-group name</span><br><span class="line">-nouser ：搜索拥有者不存在 /etc/passwd 的文件</span><br><span class="line">-nogroup：搜索所属群组不存在于 /etc<span class="built_in">/group </span>的文件</span><br></pre></td></tr></table></figure>

<p><strong>③ 与文件权限和名称有关的选项</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-name filename</span><br><span class="line">-size [+-]SIZE：搜寻比 SIZE 还要大 (+) 或小 (-) 的文件。这个 SIZE 的规格有：c: 代表 byte，k: 代表 1024bytes。所以，要找比 50KB 还要大的文件，就是 -size +50k</span><br><span class="line">-type TYPE</span><br><span class="line">-perm mode  ：搜索权限等于 mode 的文件</span><br><span class="line">-perm -mode ：搜索权限包含 mode 的文件</span><br><span class="line">-perm /mode ：搜索权限包含任一 mode 的文件</span><br></pre></td></tr></table></figure>

<p>#删除多少天之前的文件</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> /mnt/snbslog/snbs -<span class="built_in">type</span> f -<span class="built_in">name</span> <span class="string">'*'</span> -mtime +<span class="number">1</span> -<span class="built_in">exec</span> rm &#123;&#125; \;</span><br><span class="line">基本思路是，<span class="built_in">find</span>找到相应的文件，然后执行某个命令。这里是找到N天前的文件，然后执行删除指令。</span><br></pre></td></tr></table></figure>



<h2 id="六、压缩与打包"><a href="#六、压缩与打包" class="headerlink" title="六、压缩与打包"></a>六、压缩与打包</h2><h3 id="压缩文件名"><a href="#压缩文件名" class="headerlink" title="压缩文件名"></a>压缩文件名</h3><p>Linux 底下有很多压缩文件名，常见的如下：</p>
<table>
<thead>
<tr>
<th>扩展名</th>
<th>压缩程序</th>
</tr>
</thead>
<tbody><tr>
<td>*.Z</td>
<td>compress</td>
</tr>
<tr>
<td>*.zip</td>
<td>zip</td>
</tr>
<tr>
<td>*.gz</td>
<td>gzip</td>
</tr>
<tr>
<td>*.bz2</td>
<td>bzip2</td>
</tr>
<tr>
<td>*.xz</td>
<td>xz</td>
</tr>
<tr>
<td>*.tar</td>
<td>tar 程序打包的数据，没有经过压缩</td>
</tr>
<tr>
<td>*.tar.gz</td>
<td>tar 程序打包的文件，经过 gzip 的压缩</td>
</tr>
<tr>
<td>*.tar.bz2</td>
<td>tar 程序打包的文件，经过 bzip2 的压缩</td>
</tr>
<tr>
<td>*.tar.xz</td>
<td>tar 程序打包的文件，经过 xz 的压缩</td>
</tr>
</tbody></table>
<h3 id="压缩指令"><a href="#压缩指令" class="headerlink" title="压缩指令"></a>压缩指令</h3><h4 id="1-gzip"><a href="#1-gzip" class="headerlink" title="1. gzip"></a>1. gzip</h4><p>gzip 是 Linux 使用最广的压缩指令，可以解开 compress、zip 与 gzip 所压缩的文件。</p>
<p>经过 gzip 压缩过，源文件就不存在了。</p>
<p>有 9 个不同的压缩等级可以使用。</p>
<p>可以使用 zcat、zmore、zless 来读取压缩文件的内容。</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ gzip [-cdtv<span class="comment">#] filename</span></span><br><span class="line"><span class="literal">-c ：将压缩的数据输出到屏幕上</span></span><br><span class="line"><span class="literal">-d ：解压缩</span></span><br><span class="line"><span class="literal">-t ：检验压缩文件是否出错</span></span><br><span class="line"><span class="literal">-v ：显示压缩比等信息</span></span><br><span class="line"><span class="literal">-# ： # 为数字的意思，代表压缩等级，数字越大压缩比越高，默认为 6</span></span><br></pre></td></tr></table></figure>

<h4 id="2-bzip2"><a href="#2-bzip2" class="headerlink" title="2. bzip2"></a>2. bzip2</h4><p>提供比 gzip 更高的压缩比。</p>
<p>查看命令：bzcat、bzmore、bzless、bzgrep。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>bzip2 [-cdkzv<span class="comment">#] filename</span></span><br><span class="line">-k ：保留源文件</span><br></pre></td></tr></table></figure>

<h4 id="3-xz"><a href="#3-xz" class="headerlink" title="3. xz"></a>3. xz</h4><p>提供比 bzip2 更佳的压缩比。</p>
<p>可以看到，gzip、bzip2、xz 的压缩比不断优化。不过要注意的是，压缩比越高，压缩的时间也越长。</p>
<p>查看命令：xzcat、xzmore、xzless、xzgrep。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>xz [-dtlkc<span class="comment">#] filename</span></span><br></pre></td></tr></table></figure>

<h3 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h3><p>压缩指令只能对一个文件进行压缩，而打包能够将多个文件打包成一个大文件。tar 不仅可以用于打包，也可以使用 gzip、bzip2、xz 将打包文件进行压缩。</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ tar <span class="comment">[-z|-j|-J]</span> <span class="comment">[cv]</span> <span class="comment">[-f 新建的 tar 文件]</span> filename...  ==打包压缩</span><br><span class="line">$ tar <span class="comment">[-z|-j|-J]</span> <span class="comment">[tv]</span> <span class="comment">[-f 已有的 tar 文件]</span>              ==查看</span><br><span class="line">$ tar <span class="comment">[-z|-j|-J]</span> <span class="comment">[xv]</span> <span class="comment">[-f 已有的 tar 文件]</span> <span class="comment">[-C 目录]</span>    ==解压缩</span><br><span class="line">-z ：使用 zip；</span><br><span class="line">-j ：使用 bzip2；</span><br><span class="line">-J ：使用 xz；</span><br><span class="line">-c ：新建打包文件；</span><br><span class="line">-t ：查看打包文件里面有哪些文件；</span><br><span class="line">-x ：解打包或解压缩的功能；</span><br><span class="line">-v ：在压缩/解压缩的过程中，显示正在处理的文件名；</span><br><span class="line">-f : filename：要处理的文件；</span><br><span class="line">-C 目录 ： 在特定目录解压缩。</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>使用方式</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>打包压缩</td>
<td>tar -jcv -f filename.tar.bz2 要被压缩的文件或目录名称</td>
</tr>
<tr>
<td>查 看</td>
<td>tar -jtv -f filename.tar.bz2</td>
</tr>
<tr>
<td>解压缩</td>
<td>tar -jxv -f filename.tar.bz2 -C 要解压缩的目录</td>
</tr>
</tbody></table>
<h2 id="七、Bash"><a href="#七、Bash" class="headerlink" title="七、Bash"></a>七、Bash</h2><p>可以通过 Shell 请求内核提供服务，Bash 正是 Shell 的一种。</p>
<h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h3><ul>
<li>命令历史：记录使用过的命令</li>
<li>命令与文件补全：快捷键：tab</li>
<li>命名别名：例如 ll 是 ls -al 的别名</li>
<li>shell scripts</li>
<li>通配符：例如 ls -l /usr/bin/X* 列出 /usr/bin 下面所有以 X 开头的文件</li>
</ul>
<h3 id="变量操作"><a href="#变量操作" class="headerlink" title="变量操作"></a>变量操作</h3><p>对一个变量赋值直接使用 =。</p>
<p>对变量取用需要在变量前加上 $ ，也可以用 ${} 的形式；</p>
<p>输出变量使用 echo 命令。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> x=abc</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$x</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$&#123;x&#125;</span></span></span><br></pre></td></tr></table></figure>

<p>变量内容如果有空格，必须使用双引号或者单引号。</p>
<ul>
<li>双引号内的特殊字符可以保留原本特性，例如 x=”lang is $LANG”，则 x 的值为 lang is zh_TW.UTF-8；</li>
<li>单引号内的特殊字符就是特殊字符本身，例如 x=’lang is $LANG’，则 x 的值为 lang is $LANG。</li>
</ul>
<p>可以使用 <code>指令</code> 或者 $(指令) 的方式将指令的执行结果赋值给变量。例如 version=$(uname -r)，则 version 的值为 4.15.0-22-generic。</p>
<p>可以使用 export 命令将自定义变量转成环境变量，环境变量可以在子程序中使用，所谓子程序就是由当前 Bash 而产生的子 Bash。</p>
<p>Bash 的变量可以声明为数组和整数数字。注意数字类型没有浮点数。如果不进行声明，默认是字符串类型。变量的声明使用 declare 命令：</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> declare [-aixr] <span class="keyword">variable</span></span><br><span class="line">-a ： 定义为数组类型</span><br><span class="line">-i ： 定义为整数类型</span><br><span class="line">-x ： 定义为环境变量</span><br><span class="line">-r ： 定义为<span class="comment"> readonly</span> 类型</span><br></pre></td></tr></table></figure>

<p>使用 [ ] 来对数组进行索引操作：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">array</span>[<span class="number">1</span>]=a</span><br><span class="line">$ <span class="built_in">array</span>[<span class="number">2</span>]=b</span><br><span class="line">$ echo $&#123;<span class="built_in">array</span>[<span class="number">1</span>]&#125;</span><br></pre></td></tr></table></figure>

<h3 id="指令搜索顺序"><a href="#指令搜索顺序" class="headerlink" title="指令搜索顺序"></a>指令搜索顺序</h3><ul>
<li>以绝对或相对路径来执行指令，例如 /bin/ls 或者 ./ls ；</li>
<li>由别名找到该指令来执行；</li>
<li>由 Bash 内置的指令来执行；</li>
<li>按 $PATH 变量指定的搜索路径的顺序找到第一个指令来执行。</li>
</ul>
<h3 id="数据流重定向"><a href="#数据流重定向" class="headerlink" title="数据流重定向"></a>数据流重定向</h3><p>重定向指的是使用文件代替标准输入、标准输出和标准错误输出。</p>
<table>
<thead>
<tr>
<th>1</th>
<th>代码</th>
<th>运算符</th>
</tr>
</thead>
<tbody><tr>
<td>标准输入 (stdin)</td>
<td>0</td>
<td>&lt; 或 &lt;&lt;</td>
</tr>
<tr>
<td>标准输出 (stdout)</td>
<td>1</td>
<td>&gt; 或 &gt;&gt;</td>
</tr>
<tr>
<td>标准错误输出 (stderr)</td>
<td>2</td>
<td>2&gt; 或 2&gt;&gt;</td>
</tr>
</tbody></table>
<p>其中，有一个箭头的表示以覆盖的方式重定向，而有两个箭头的表示以追加的方式重定向。</p>
<p>可以将不需要的标准输出以及标准错误输出重定向到 /dev/null，相当于扔进垃圾箱。</p>
<p>如果需要将标准输出以及标准错误输出同时重定向到一个文件，需要将某个输出转换为另一个输出，例如 2&gt;&amp;1 表示将标准错误输出转换为标准输出。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">find</span> /<span class="built_in">home</span> -name .bashrc &gt; <span class="built_in">list</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="八、管道指令"><a href="#八、管道指令" class="headerlink" title="八、管道指令"></a>八、管道指令</h2><p>管道是将一个命令的标准输出作为另一个命令的标准输入，在数据需要经过多个步骤的处理之后才能得到我们想要的内容时就可以使用管道。</p>
<p>在命令之间使用 | 分隔各个管道命令。</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">ls</span> -al <span class="string">/etc</span> | less</span><br></pre></td></tr></table></figure>

<h3 id="提取指令"><a href="#提取指令" class="headerlink" title="提取指令"></a>提取指令</h3><p>cut 对数据进行切分，取出想要的部分。</p>
<p>切分过程一行一行地进行。</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cut</span><br><span class="line"><span class="deletion">-d ：分隔符</span></span><br><span class="line"><span class="deletion">-f ：经过 -d 分隔后，使用 -f n 取出第 n 个区间</span></span><br><span class="line"><span class="deletion">-c ：以字符为单位取出区间</span></span><br></pre></td></tr></table></figure>

<p>示例 1：last 显示登入者的信息，取出用户名。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ last</span><br><span class="line">root pts/<span class="number">1</span> <span class="number">192.168</span><span class="number">.201</span><span class="number">.101</span> Sat Feb <span class="number">7</span> <span class="number">12</span>:<span class="number">35</span> still logged <span class="keyword">in</span></span><br><span class="line">root pts/<span class="number">1</span> <span class="number">192.168</span><span class="number">.201</span><span class="number">.101</span> Fri Feb <span class="number">6</span> <span class="number">12</span>:<span class="number">13</span> - <span class="number">18</span>:<span class="number">46</span> (<span class="number">06</span>:<span class="number">33</span>)</span><br><span class="line">root pts/<span class="number">1</span> <span class="number">192.168</span><span class="number">.201</span><span class="number">.254</span> Thu Feb <span class="number">5</span> <span class="number">22</span>:<span class="number">37</span> - <span class="number">23</span>:<span class="number">53</span> (<span class="number">01</span>:<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">$ last | cut -d <span class="string">' '</span> -f <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>示例 2：将 export 输出的信息，取出第 12 字符以后的所有字符串。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ export</span><br><span class="line">declare -x <span class="attribute">HISTCONTROL</span>=<span class="string">"ignoredups"</span></span><br><span class="line">declare -x <span class="attribute">HISTSIZE</span>=<span class="string">"1000"</span></span><br><span class="line">declare -x <span class="attribute">HOME</span>=<span class="string">"/home/dmtsai"</span></span><br><span class="line">declare -x <span class="attribute">HOSTNAME</span>=<span class="string">"study.centos.vbird"</span></span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span>.(其他省略)<span class="built_in">..</span><span class="built_in">..</span>.</span><br><span class="line"></span><br><span class="line">$ <span class="builtin-name">export</span> | cut -c 12-</span><br></pre></td></tr></table></figure>

<h3 id="排序指令"><a href="#排序指令" class="headerlink" title="排序指令"></a>排序指令</h3><p><strong>sort</strong> 用于排序。</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ sort [-fbMnrtuk] [file or stdin]</span><br><span class="line"><span class="deletion">-f ：忽略大小写</span></span><br><span class="line"><span class="deletion">-b ：忽略最前面的空格</span></span><br><span class="line"><span class="deletion">-M ：以月份的名字来排序，例如 JAN，DEC</span></span><br><span class="line"><span class="deletion">-n ：使用数字</span></span><br><span class="line"><span class="deletion">-r ：反向排序</span></span><br><span class="line"><span class="deletion">-u ：相当于 unique，重复的内容只出现一次</span></span><br><span class="line"><span class="deletion">-t ：分隔符，默认为 tab</span></span><br><span class="line"><span class="deletion">-k ：指定排序的区间</span></span><br></pre></td></tr></table></figure>

<p>示例：/etc/passwd 文件内容以 : 来分隔，要求以第三列进行排序。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ cat <span class="regexp">/etc/</span>passwd | sort -t <span class="string">':'</span> -k <span class="number">3</span></span><br><span class="line"><span class="string">root:</span><span class="string">x:</span><span class="number">0</span>:<span class="number">0</span>:<span class="string">root:</span><span class="regexp">/root:/</span>bin/bash</span><br><span class="line"><span class="string">dmtsai:</span><span class="string">x:</span><span class="number">1000</span>:<span class="number">1000</span>:<span class="string">dmtsai:</span><span class="regexp">/home/</span><span class="string">dmtsai:</span><span class="regexp">/bin/</span>bash</span><br><span class="line"><span class="string">alex:</span><span class="string">x:</span><span class="number">1001</span>:<span class="number">1002</span>::<span class="regexp">/home/</span><span class="string">alex:</span><span class="regexp">/bin/</span>bash</span><br><span class="line"><span class="string">arod:</span><span class="string">x:</span><span class="number">1002</span>:<span class="number">1003</span>::<span class="regexp">/home/</span><span class="string">arod:</span><span class="regexp">/bin/</span>bash</span><br></pre></td></tr></table></figure>

<p><strong>uniq</strong> 可以将重复的数据只取一个。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ uni<span class="string">q [-ic]</span></span><br><span class="line">-i ：忽略大小写</span><br><span class="line">-c ：进行计数</span><br></pre></td></tr></table></figure>

<p>示例：取得每个人的登录总次数</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ last | cut -d <span class="string">' '</span> -f <span class="number">1</span> | sort | uniq -c</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">6</span> (unknown</span><br><span class="line"><span class="number">47</span> dmtsai</span><br><span class="line"><span class="number">4</span> reboot</span><br><span class="line"><span class="number">7</span> root</span><br><span class="line"><span class="number">1</span> wtmp</span><br></pre></td></tr></table></figure>

<p>#去除重复行</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span> -n partition_id.txt |uniq|<span class="built_in">sort</span> -n</span><br><span class="line">去重必须搭配<span class="built_in">sort</span> -n使用</span><br><span class="line"><span class="built_in">sort</span> -n单独使用是按照数字排序</span><br><span class="line"></span><br><span class="line">按数字排序：<span class="built_in">sort</span> -n <span class="built_in">number</span>.txt</span><br></pre></td></tr></table></figure>



<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>snbs161<span class="number">-201</span>-instance opt]# head stat.log </span><br><span class="line">/opt/write/<span class="number">1</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655362</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375690</span> <span class="number">1573375353</span> <span class="number">1573375353</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">3</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655364</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375832</span> <span class="number">1573375724</span> <span class="number">1573375724</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">7</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655368</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375835</span> <span class="number">1573375724</span> <span class="number">1573375724</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">5</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655366</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375832</span> <span class="number">1573375724</span> <span class="number">1573375724</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655370</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375838</span> <span class="number">1573375724</span> <span class="number">1573375724</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">11</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655372</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375832</span> <span class="number">1573375724</span> <span class="number">1573375724</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">8</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655369</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375828</span> <span class="number">1573375724</span> <span class="number">1573375724</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">6</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655367</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375830</span> <span class="number">1573375724</span> <span class="number">1573375724</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">13</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655374</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375832</span> <span class="number">1573375724</span> <span class="number">1573375724</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">10</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">655371</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375829</span> <span class="number">1573375724</span> <span class="number">1573375724</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9992</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665353</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375829</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9991</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665352</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375833</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9993</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665354</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375828</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9994</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665355</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375832</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9995</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665356</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375834</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">10000</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665361</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375831</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9996</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665357</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375828</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9997</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665358</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375830</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9998</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665359</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375831</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line">/opt/write/<span class="number">9999</span> <span class="number">97792</span> <span class="number">192</span> <span class="number">81</span>a4 <span class="number">0</span> <span class="number">0</span> fd05 <span class="number">665360</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1573375838</span> <span class="number">1573375737</span> <span class="number">1573375737</span> <span class="number">4096</span></span><br><span class="line"></span><br><span class="line">需求：/opt/write/数字，根据数字排序</span><br><span class="line">命令：</span><br><span class="line">sort -t <span class="string">"/"</span> -n -k4 stat.log</span><br><span class="line">注：以/为分隔，按数字进行排序，指定的排序列是<span class="number">4</span></span><br><span class="line"></span><br><span class="line">sort：</span><br><span class="line"><span class="number">1.</span>-t   指定文本分隔符 </span><br><span class="line"><span class="number">2.</span>-k  指定排序列 </span><br><span class="line"><span class="number">3.</span>-n  按数字进行排序 </span><br><span class="line"><span class="number">4.</span>-r   翻转排序结果 </span><br><span class="line"><span class="number">5.</span>-g  科学记数法方式比较</span><br><span class="line"><span class="number">6.</span>-o  设置输出文件，与“&gt;”相比可以设置输出到原文件，“&gt;”会清空原文件</span><br><span class="line"><span class="number">7.</span>-u   删除相同行</span><br></pre></td></tr></table></figure>



<h3 id="双向输出重定向"><a href="#双向输出重定向" class="headerlink" title="双向输出重定向"></a>双向输出重定向</h3><p>输出重定向会将输出内容重定向到文件中，而 <strong>tee</strong> 不仅能够完成这个功能，还能保留屏幕上的输出。也就是说，使用 tee 指令，一个输出会同时传送到文件和屏幕上。</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> tee [-a] <span class="keyword">file</span></span><br></pre></td></tr></table></figure>

<h3 id="字符转换指令"><a href="#字符转换指令" class="headerlink" title="字符转换指令"></a>字符转换指令</h3><p><strong>tr</strong> 用来删除一行中的字符，或者对字符进行替换。</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tr [-ds] <span class="symbol">SET1</span> ...</span><br><span class="line">-d ： 删除行中 <span class="symbol">SET1</span> 这个字符串</span><br></pre></td></tr></table></figure>

<p>示例，将 last 输出的信息所有小写转换为大写。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">last</span> | <span class="keyword">tr</span> <span class="string">'[a-z]'</span> <span class="string">'[A-Z]'</span></span><br></pre></td></tr></table></figure>

<p><strong>col</strong> 将 tab 字符转为空格字符。</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">col</span> [-xb]</span><br><span class="line">-x ： 将 <span class="built_in">tab</span> 键转换成对等的空格键</span><br></pre></td></tr></table></figure>

<p><strong>expand</strong> 将 tab 转换一定数量的空格，默认是 8 个。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">expand</span> [-t] <span class="keyword">file</span></span><br><span class="line">-t ：<span class="keyword">tab</span> 转为空格的数量</span><br></pre></td></tr></table></figure>

<p><strong>join</strong> 将有相同数据的那一行合并在一起。</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ join [-ti12] file1 file2</span><br><span class="line"><span class="deletion">-t ：分隔符，默认为空格</span></span><br><span class="line"><span class="deletion">-i ：忽略大小写的差异</span></span><br><span class="line"><span class="deletion">-1 ：第一个文件所用的比较字段</span></span><br><span class="line"><span class="deletion">-2 ：第二个文件所用的比较字段</span></span><br></pre></td></tr></table></figure>

<p><strong>paste</strong> 直接将两行粘贴在一起。</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ paste [-d] file1 file2</span><br><span class="line">-d ：分隔符，默认为 <span class="literal">tab</span></span><br></pre></td></tr></table></figure>

<h3 id="分区指令"><a href="#分区指令" class="headerlink" title="分区指令"></a>分区指令</h3><p><strong>split</strong> 将一个文件划分成多个文件。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ split [-bl] file PREFIX</span><br><span class="line">-b ：以大小来进行分区，可加单位，例如 b, k, m 等</span><br><span class="line">-l ：以行数来进行分区。</span><br><span class="line">-<span class="built_in"> PREFIX </span>：分区文件的前导名称</span><br></pre></td></tr></table></figure>

<h2 id="九、正则表达式"><a href="#九、正则表达式" class="headerlink" title="九、正则表达式"></a>九、正则表达式</h2><h3 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">*：匹配<span class="number">0</span>或多个字符</span><br><span class="line">?：匹配随意一个字符</span><br><span class="line">[list]：匹配list中的随意单一字符</span><br><span class="line">[!list]：匹配非list中的随意单一字符</span><br><span class="line">[a1-a3]：匹配a1和a3之间的随意一个字符。如<span class="number">0</span><span class="number">-9</span>，a-z</span><br><span class="line">&#123;<span class="built_in">string</span>1,<span class="built_in">string</span>2,<span class="built_in">string</span>3...&#125;：匹配<span class="built_in">string</span>1，或<span class="built_in">string</span>2或……当中的一个字符串</span><br></pre></td></tr></table></figure>



<h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><p>g/re/p（globally search a regular expression and print)，使用正则表示式进行全局查找并打印。</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ grep [-acinv] [--color=auto] 搜寻字符串 filename</span><br><span class="line">-<span class="ruby">c ： 统计匹配到行的个数</span></span><br><span class="line"><span class="ruby">-i ： 忽略大小写</span></span><br><span class="line"><span class="ruby">-n ： 输出行号</span></span><br><span class="line"><span class="ruby">-v ： 反向选择，也就是显示出没有 搜寻字符串 内容的那一行</span></span><br><span class="line"><span class="ruby">-w ： 完全匹配		grep -w <span class="string">"cao"</span></span></span><br><span class="line"><span class="ruby">--color=auto ：找到的关键字加颜色显示</span></span><br><span class="line"></span><br><span class="line"><span class="ruby">-A -B -C 后面都跟阿拉伯数字 </span></span><br><span class="line"><span class="ruby">-A是显示匹配后和它后面的n行。 </span></span><br><span class="line"><span class="ruby">-B是显示匹配行和它前面的n行。 </span></span><br><span class="line"><span class="ruby">-C是匹配行和它前后各n行。 </span></span><br><span class="line"><span class="ruby">总体来说，-C覆盖面最大。用它保险些。哈哈。这<span class="number">3</span>个开关都是关于匹配行的上下文的（context）。</span></span><br></pre></td></tr></table></figure>



<p>示例：把含有 the 字符串的行提取出来（注意默认会有 –color=auto 选项，因此以下内容在 Linux 中有颜色显示 the 字符串）</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ grep -n <span class="symbol">'the</span>' regular_express.txt</span><br><span class="line"><span class="number">8</span>:I can<span class="symbol">'t</span> finish the test.</span><br><span class="line"><span class="number">12</span>:the symbol <span class="string">'*'</span> <span class="keyword">is</span> represented as start.</span><br><span class="line"><span class="number">15</span>:You are the best <span class="keyword">is</span> mean you are the no. <span class="number">1</span>.</span><br><span class="line"><span class="number">16</span>:The world Happy <span class="keyword">is</span> the same <span class="keyword">with</span> <span class="string">"glad"</span>.</span><br><span class="line"><span class="number">18</span>:google <span class="keyword">is</span> the best tools <span class="keyword">for</span> search keyword</span><br></pre></td></tr></table></figure>



<p>示例：正则表达式 a{m,n} 用来匹配字符 a m~n 次，这里需要将 { 和 } 进行转义，因为它们在 shell 是有特殊意义的。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>grep -n <span class="string">'a\&#123;2,5\&#125;'</span> regular_express.txt</span><br></pre></td></tr></table></figure>



<p>示例：查找当前目录下包含关键字“checknetiflinkstat”的所有文件，并列出行号。</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grep</span> -nr <span class="string">"checknetiflinkstat"</span> <span class="regexp">/home/</span>zxcdn<span class="regexp">/ottcache/</span>nginx<span class="regexp">/lua</span></span><br></pre></td></tr></table></figure>



<p>报错Binary file (standard input) matches：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解决：</span><br><span class="line"><span class="keyword">cat</span> mt.output-<span class="number">20180807</span>|<span class="keyword">grep</span> -<span class="keyword">a</span> l129093</span><br></pre></td></tr></table></figure>



<h3 id="printf"><a href="#printf" class="headerlink" title="printf"></a>printf</h3><p>用于格式化输出。它不属于管道命令，在给 printf 传数据时需要使用 $( ) 形式。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ printf '%<span class="number">10</span>s %<span class="number">5</span>i %<span class="number">5</span>i %<span class="number">5</span>i %<span class="number">8.2</span>f \n' $(cat printf.txt)</span><br><span class="line">    DmTsai    <span class="number">80</span>    <span class="number">60</span>    <span class="number">92</span>    <span class="number">77.33</span></span><br><span class="line">     VBird    <span class="number">75</span>    <span class="number">55</span>    <span class="number">80</span>    <span class="number">70.00</span></span><br><span class="line">       Ken    <span class="number">60</span>    <span class="number">90</span>    <span class="number">70</span>    <span class="number">73.33</span></span><br></pre></td></tr></table></figure>

<h3 id="tr："><a href="#tr：" class="headerlink" title="tr："></a>tr：</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">去除字母</span><br><span class="line"><span class="keyword">cat</span> <span class="keyword">file</span> | <span class="keyword">tr</span> -d <span class="string">"a-zA-Z"</span>&gt;new_file</span><br></pre></td></tr></table></figure>



<h3 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span>/<span class="regexp">/www.cnblogs.com/fiberhome</span><span class="regexp">/p/</span><span class="number">6898786</span>.html</span><br><span class="line"></span><br><span class="line">在每行的头添加字符，比如<span class="string">"HEAD"</span>，命令如下：</span><br><span class="line">[root<span class="variable">@localhost</span> ~]<span class="comment"># sed -i 's/^/HEAD&amp;/' /tmp/input.txt </span></span><br><span class="line">[root<span class="variable">@localhost</span> ~]<span class="comment"># cat /tmp/input.txt</span></span><br><span class="line">HEADnull</span><br><span class="line">HEAD000011112222</span><br><span class="line">HEAD</span><br><span class="line">HEADtest</span><br><span class="line"></span><br><span class="line"><span class="comment">#替换关键字的后面两位</span></span><br><span class="line">sed -ri <span class="string">'s/(20230907..)/\110/g'</span></span><br><span class="line">sed -ri <span class="string">'s/(20230907..)/\110/'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#在包含某个关键字的行上面插入一行文字，命令如下：</span></span><br><span class="line">sed -i <span class="string">'/hello/i\\555555'</span> testfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#在包含某个关键字的行下面插入一行文字，命令如下：</span></span><br><span class="line">sed -i <span class="string">'/hello/a\\66666'</span> testfile</span><br><span class="line"></span><br><span class="line"><span class="comment">#替换第21次匹配的字符</span></span><br><span class="line">sed -i <span class="string">'s/xxx/12344/21/'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#在文件的第一行插入字符串</span></span><br><span class="line">sed  -i  <span class="string">'1i include /etc/cinder/volumes/*'</span>  /etc/tgt/targets .conf</span><br><span class="line">其中i表示插入，而且是添加到当前行的上一行；而a是添加到当前行的后一行。</span><br><span class="line">注意：在sed中没有第0行之说。</span><br><span class="line"></span><br><span class="line">显示文件X行到Y行的内容：</span><br><span class="line"><span class="comment">#sed -n 'x,yp' filename</span></span><br><span class="line"></span><br><span class="line">删除文件最后一行：</span><br><span class="line">sed <span class="string">'$d'</span></span><br><span class="line"></span><br><span class="line">对第十八行进行注释：sed <span class="string">'18s/^/#/'</span> /etc/fstab </span><br><span class="line"></span><br><span class="line">sed中支持变量的处理方法</span><br><span class="line"><span class="number">1</span>.eval sed ’s/<span class="variable">$a</span>/<span class="variable">$b</span>/’ filename</span><br><span class="line"><span class="number">2</span>.sed <span class="string">"s/$a/$b/"</span> filename</span><br><span class="line"><span class="number">3</span>.sed ’s/’<span class="variable">$a</span>’/’<span class="variable">$b</span>’/’ filename </span><br><span class="line"><span class="number">4</span>.sed s/<span class="variable">$a</span>/<span class="variable">$b</span>/ filename</span><br><span class="line">第一种eval sed -i <span class="string">'s!gcomm://!gcomm://$IP_2!g'</span> /etc/my.cnf.d/server.cnf</span><br><span class="line">第二种sed -i <span class="string">"s/localhost-IP/$IP_2/g"</span> /etc/my.cnf.d/server.cnf</span><br><span class="line"></span><br><span class="line">sed删除含有某个字符的行</span><br><span class="line">readzone1=<span class="number">12345</span></span><br><span class="line">sed -i <span class="string">"/$readzone1/d"</span> zone1.log zone2.log zone3.log</span><br><span class="line"></span><br><span class="line">linux 删除文件里的标点符号</span><br><span class="line">sed  -i <span class="string">'s /[,."]//g  filename</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">删除空行：</span></span><br><span class="line"><span class="string">sed '</span>/^\s*<span class="variable">$/</span>d<span class="string">'</span></span><br><span class="line"><span class="string">注：d代表删除该行</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">行尾追加字符：</span></span><br><span class="line"><span class="string">sed '</span>s/<span class="variable">$/</span> ABC/<span class="string">' file1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">行首：</span></span><br><span class="line"><span class="string">sed '</span>s/^<span class="regexp">/xxx/</span><span class="string">'  filename &gt;output：^符号代表行首</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">awk NF</span></span><br><span class="line"><span class="string">注：NF代表当前行的字段数，空行的话字段数为0,被awk解释为假，因此不进行输出。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Sed 删除包含某些字符串的行</span></span><br><span class="line"><span class="string">sed -i '</span>/关键字符/d<span class="string">' 文件名</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">https://www.cnblogs.com/Berryxiong/p/6232283.html</span></span><br><span class="line"><span class="string">sed '</span>s/[ ][ ]*<span class="regexp">/,/g</span><span class="string">' 1.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">脚本说明：</span></span><br><span class="line"><span class="string">s代表替换指令；</span></span><br><span class="line"><span class="string">每个[ ]都包含有一个空格；</span></span><br><span class="line"><span class="string">*号代表0个或多个；</span></span><br><span class="line"><span class="string">g代表替换每行的所有匹配；</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">linux 如何截取一段时间内log日志 </span></span><br><span class="line"><span class="string">sed -n '</span>/<span class="number">2020-02</span><span class="number">-12 08</span><span class="symbol">:</span><span class="number">50</span>/,<span class="regexp">/2020-02-12 09:00/</span><span class="string">'p  server.INFO</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">shell替换一个或多个空格为逗号</span></span><br><span class="line"><span class="string">sed '</span>s/[ ][ ]*<span class="regexp">/,/g</span><span class="string">' 1.txt</span></span><br><span class="line"><span class="string">脚本说明：</span></span><br><span class="line"><span class="string">s代表替换指令；</span></span><br><span class="line"><span class="string">每个[ ]都包含有一个空格；</span></span><br><span class="line"><span class="string">*号代表0个或多个；</span></span><br><span class="line"><span class="string">g代表替换每行的所有匹配；</span></span><br></pre></td></tr></table></figure>



<h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><p>是由 Alfred Aho，Peter Weinberger 和 Brian Kernighan 创造，awk 这个名字就是这三个创始人名字的首字母。</p>
<p>awk 每次处理一行，处理的最小单位是字段，每个字段的命名方式为：$n，n 为字段号，从 1 开始，$0 表示一整行。</p>
<p>示例：取出最近五个登录用户的用户名和 IP。首先用 last -n 5 取出用最近五个登录用户的所有信息，可以看到用户名和 IP 分别在第 1 列和第 3 列，我们用 $1 和 $3 就能取出这两个字段，然后用 print 进行打印。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ last -n <span class="number">5</span></span><br><span class="line">dmtsai pts/<span class="number">0</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span> Tue Jul <span class="number">14</span> <span class="number">17</span>:<span class="number">32</span> still logged <span class="keyword">in</span></span><br><span class="line">dmtsai pts/<span class="number">0</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span> Thu Jul <span class="number">9</span> <span class="number">23</span>:<span class="number">36</span> - <span class="number">02</span>:<span class="number">58</span> (<span class="number">03</span>:<span class="number">22</span>)</span><br><span class="line">dmtsai pts/<span class="number">0</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span> Thu Jul <span class="number">9</span> <span class="number">17</span>:<span class="number">23</span> - <span class="number">23</span>:<span class="number">36</span> (<span class="number">06</span>:<span class="number">12</span>)</span><br><span class="line">dmtsai pts/<span class="number">0</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span> Thu Jul <span class="number">9</span> <span class="number">08</span>:<span class="number">02</span> - <span class="number">08</span>:<span class="number">17</span> (<span class="number">00</span>:<span class="number">14</span>)</span><br><span class="line">dmtsai tty1 Fri May <span class="number">29</span> <span class="number">11</span>:<span class="number">55</span> - <span class="number">12</span>:<span class="number">11</span> (<span class="number">00</span>:<span class="number">15</span>)</span><br><span class="line">$ last -n <span class="number">5</span> | awk <span class="string">'&#123;print $1 "\t" $3&#125;'</span></span><br><span class="line">dmtsai   <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span></span><br><span class="line">dmtsai   <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span></span><br><span class="line">dmtsai   <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span></span><br><span class="line">dmtsai   <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span></span><br><span class="line">dmtsai   Fri</span><br></pre></td></tr></table></figure>

<p>可以根据字段的某些条件进行匹配，例如匹配字段小于某个值的那一行数据。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ awk '条件类型 <span class="number">1</span> &#123;动作 <span class="number">1</span>&#125; 条件类型 <span class="number">2</span> &#123;动作 <span class="number">2</span>&#125; ...' filename</span><br></pre></td></tr></table></figure>

<p>示例：/etc/passwd 文件第三个字段为 UID，对 UID 小于 10 的数据进行处理。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/passwd | awk 'BEGIN &#123;FS=<span class="string">":"</span>&#125; $<span class="number">3</span> &lt; <span class="number">10</span> &#123;print $<span class="number">1</span> <span class="string">"<span class="subst">\t</span> "</span> $<span class="number">3</span>&#125;'</span><br><span class="line">root <span class="number">0</span></span><br><span class="line">bin <span class="number">1</span></span><br><span class="line">daemon <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>awk 变量：</p>
<table>
<thead>
<tr>
<th>变量名称</th>
<th>代表意义</th>
</tr>
</thead>
<tbody><tr>
<td>NF</td>
<td>每一行拥有的字段总数</td>
</tr>
<tr>
<td>NR</td>
<td>目前所处理的是第几行数据</td>
</tr>
<tr>
<td>FS</td>
<td>目前的分隔字符，默认是空格键</td>
</tr>
</tbody></table>
<p>示例：显示正在处理的行号以及每一行有多少字段</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">last</span> -n <span class="number">5</span> | awk <span class="string">'&#123;print $1 "\t lines: " NR "\t columns: " NF&#125;'</span></span><br><span class="line">dmtsai <span class="built_in">line</span><span class="variable">s:</span> <span class="number">1</span> column<span class="variable">s:</span> <span class="number">10</span></span><br><span class="line">dmtsai <span class="built_in">line</span><span class="variable">s:</span> <span class="number">2</span> column<span class="variable">s:</span> <span class="number">10</span></span><br><span class="line">dmtsai <span class="built_in">line</span><span class="variable">s:</span> <span class="number">3</span> column<span class="variable">s:</span> <span class="number">10</span></span><br><span class="line">dmtsai <span class="built_in">line</span><span class="variable">s:</span> <span class="number">4</span> column<span class="variable">s:</span> <span class="number">10</span></span><br><span class="line">dmtsai <span class="built_in">line</span><span class="variable">s:</span> <span class="number">5</span> column<span class="variable">s:</span> <span class="number">9</span></span><br></pre></td></tr></table></figure>



<p><a href="https://www.cnblogs.com/doflamingo/p/13209610.html" target="_blank" rel="noopener external nofollow noreferrer">awk中执行Linux命令的两种方式</a></p>
<blockquote>
<p>在使用awk处理内容时，有时会按行执行Linux命令，下面介绍两种执行Linux命令方式。</p>
</blockquote>
<p><strong>方式一</strong>：<strong><em>用system()：</em></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost shell_script]<span class="comment"># awk 'BEGIN &#123;system("pwd")&#125;'</span></span><br><span class="line">[root@localhost shell_script]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>test.log文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost shell_script]<span class="comment"># cat test.log </span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">ls</span><br><span class="line"><span class="built_in">which</span> sh</span><br><span class="line">[root@localhost shell_script]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>按文件行作为输入执行：</p>
<blockquote>
<p><strong>$0</strong> 表示一行数据</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost shell_script]<span class="comment"># awk '&#123;print "执行命令："$0; system($0); print "\r"&#125;' test.log</span></span><br><span class="line">执行命令：<span class="built_in">pwd</span></span><br><span class="line">/root/shell_script</span><br><span class="line"></span><br><span class="line">执行命令：ls</span><br><span class="line">awk_system.sh  test.log</span><br><span class="line"></span><br><span class="line">执行命令：<span class="built_in">which</span> sh</span><br><span class="line">/usr/bin/sh</span><br><span class="line"></span><br><span class="line">[root@localhost shell_script]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>拼接命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost shell_script]<span class="comment"># echo "sh601236" | awk '&#123;cmd = "curl -X GET http://hq.sinajs.cn/list="$0; system(cmd);&#125;'</span></span><br><span class="line">var hq_str_sh601236=<span class="string">"红塔证券,19.930,20.320,19.150,19.930,18.710,19.150,19.160,41190044,791608359.000,198000,19.150,53300,19.140,60100,19.130,74200,19.120,24100,19.110,50500,19.160,28500,19.170,18300,19.180,15500,19.190,59300,19.200,2020-06-29,15:00:00,00,"</span>;</span><br><span class="line">[root@localhost shell_script]<span class="comment">#</span></span><br></pre></td></tr></table></figure>



<p><strong>方式二</strong>：借助|和sh命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost shell_script]<span class="comment"># echo "pwd" | sh</span></span><br><span class="line">/root/shell_script</span><br><span class="line">[root@localhost shell_script]<span class="comment"># cat test.log | sh</span></span><br><span class="line">/root/shell_script</span><br><span class="line">awk_system.sh  test.log</span><br><span class="line">/usr/bin/sh</span><br><span class="line">[root@localhost shell_script]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>print</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost shell_script]<span class="comment"># awk 'BEGIN &#123;print "pwd" | "sh"&#125;'</span></span><br><span class="line">/root/shell_script</span><br><span class="line">[root@localhost shell_script]<span class="comment">#</span></span><br><span class="line">[root@localhost shell_script]<span class="comment"># echo "pwd" | awk '&#123;print $0 | "sh"&#125;'</span></span><br><span class="line">/root/shell_script</span><br><span class="line">[root@localhost shell_script]<span class="comment">#</span></span><br><span class="line">[root@localhost shell_script]<span class="comment"># awk '&#123;print "执行命令："$0; print $0 | "sh"; print "\r"&#125;' test.log</span></span><br><span class="line">执行命令：<span class="built_in">pwd</span></span><br><span class="line"></span><br><span class="line">执行命令：ls</span><br><span class="line"></span><br><span class="line">执行命令：<span class="built_in">which</span> sh</span><br><span class="line"></span><br><span class="line">/root/shell_script</span><br><span class="line">awk_system.sh  test.log</span><br><span class="line">/usr/bin/sh</span><br><span class="line">[root@localhost shell_script]<span class="comment">#</span></span><br></pre></td></tr></table></figure>





<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//www.cnblogs.com/xudong-bupt/p/3721210.html</span></span><br><span class="line">https:<span class="comment">//www.cnblogs.com/jackhub/p/3549091.html</span></span><br><span class="line">http:<span class="comment">//www.mamicode.com/info-detail-1187091.html</span></span><br><span class="line">http:<span class="comment">//www.voidcn.com/article/p-pycljjoj-btv.html</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">IF</span>语句</span><br><span class="line">必须用在&#123;&#125;中，且比较内容用()扩起来</span><br><span class="line">awk -F: '&#123;<span class="keyword">if</span>(<span class="variable">$1</span>~/mail/) <span class="keyword">print</span> <span class="variable">$1&#125;</span>' /etc/passwd                                       <span class="comment">//简写</span></span><br><span class="line">awk -F: '&#123;<span class="keyword">if</span>(<span class="variable">$1</span>~/mail/) &#123;<span class="keyword">print</span> <span class="variable">$1&#125;</span>&#125;'  /etc/passwd                                   <span class="comment">//全写</span></span><br><span class="line">awk -F: '&#123;<span class="keyword">if</span>(<span class="variable">$1</span>~/mail/) &#123;<span class="keyword">print</span> <span class="variable">$1&#125;</span> <span class="keyword">else</span> &#123;<span class="keyword">print</span> <span class="variable">$2&#125;</span>&#125;' /etc/passwd            <span class="comment">//if...else...</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">条件表达式</span><br><span class="line">==   !=   &gt;   &gt;=  </span><br><span class="line">awk -F<span class="string">":"</span> '<span class="variable">$1</span>==<span class="string">"mysql"</span>&#123;<span class="keyword">print</span> <span class="variable">$3&#125;</span>' /etc/passwd  </span><br><span class="line">awk -F<span class="string">":"</span> '&#123;<span class="keyword">if</span>(<span class="variable">$1</span>==<span class="string">"mysql"</span>) <span class="keyword">print</span> <span class="variable">$3&#125;</span>' /etc/passwd          <span class="comment">//与上面相同 </span></span><br><span class="line">awk -F<span class="string">":"</span> '<span class="variable">$1</span>!=<span class="string">"mysql"</span>&#123;<span class="keyword">print</span> <span class="variable">$3&#125;</span>' /etc/passwd                 <span class="comment">//不等于</span></span><br><span class="line">awk -F<span class="string">":"</span> '<span class="variable">$3</span>&gt;1000&#123;<span class="keyword">print</span> <span class="variable">$3&#125;</span>' /etc/passwd                      <span class="comment">//大于</span></span><br><span class="line">awk -F<span class="string">":"</span> '<span class="variable">$3</span>&gt;=100&#123;<span class="keyword">print</span> <span class="variable">$3&#125;</span>' /etc/passwd                     <span class="comment">//大于等于</span></span><br><span class="line">awk -F<span class="string">":"</span> '<span class="variable">$3</span>&lt;1&#123;<span class="keyword">print</span> <span class="variable">$3&#125;</span>' /etc/passwd                            <span class="comment">//小于</span></span><br><span class="line">awk -F<span class="string">":"</span> '<span class="variable">$3</span>&lt;=1&#123;<span class="keyword">print</span> <span class="variable">$3&#125;</span>' /etc/passwd                         <span class="comment">//小于等于</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">awk判断某字段为空</span><br><span class="line"><span class="keyword">more</span> aaa.txt | awk -F '|' '<span class="variable">$11</span> ~/^$/&#123;<span class="keyword">print</span> <span class="variable">$0&#125;</span>'</span><br><span class="line"></span><br><span class="line">#在每一行插入字符</span><br><span class="line">1. 如何在一个文本文件中的每一行头插入一个字符</span><br><span class="line">awk '&#123;<span class="keyword">print</span> <span class="string">"X"</span><span class="variable">$0&#125;</span>' urfile</span><br><span class="line">2. 如何在一个文本文件中的每一行尾插入一个字符</span><br><span class="line">awk '&#123;<span class="keyword">print</span> <span class="variable">$0</span><span class="string">"X"</span>&#125;' urfile</span><br><span class="line">3. 如何在一个文本文件中的每一行的指定列插入一串字符</span><br><span class="line">awk '<span class="variable">$O</span>=<span class="variable">$O</span><span class="string">" X"</span>' urfile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">awk匹配指定的字符串并打印该字符串所在的列 简书</span><br><span class="line">df|awk '/%/ &#123;<span class="keyword">for</span>(i=1;i&lt;=NF;i++) <span class="keyword">if</span> (<span class="variable">$i</span>~/%/)<span class="keyword">print</span> <span class="variable">$i</span> &#125;'</span><br><span class="line"></span><br><span class="line">【-----awk之行与列的<span class="keyword">count</span> Chinaunix----】</span><br><span class="line">1） 每行字段数</span><br><span class="line">awk '&#123;<span class="keyword">print</span> NF&#125;' <span class="keyword">file</span></span><br><span class="line">5</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line"> </span><br><span class="line">2） 最大字段数</span><br><span class="line">awk '&#123;max=max</span><br><span class="line">5</span><br><span class="line"> </span><br><span class="line">3） 总共字段个数</span><br><span class="line">awk '&#123;x+=NF&#125;END&#123;<span class="keyword">print</span> x&#125;' <span class="keyword">file</span></span><br><span class="line">16</span><br><span class="line"></span><br><span class="line">4） 所有字段的总和</span><br><span class="line">awk '&#123;<span class="keyword">for</span>(i=1;i&lt;=NF;i++)x+=<span class="variable">$i&#125;</span>END&#123;<span class="keyword">print</span> x&#125;' <span class="keyword">file</span></span><br><span class="line">280</span><br><span class="line"></span><br><span class="line">5） 各行的总和</span><br><span class="line">awk '&#123;x=0;<span class="keyword">for</span>(i=1;i&lt;=NF;i++)&#123;x+=<span class="variable">$i&#125;</span>;<span class="keyword">print</span> x&#125;' <span class="keyword">file</span></span><br><span class="line">60</span><br><span class="line">15</span><br><span class="line">70</span><br><span class="line">41</span><br><span class="line">94</span><br><span class="line"></span><br><span class="line">6） 各列的总和</span><br><span class="line">awk '&#123;<span class="keyword">for</span>(i=1;i&lt;=NF;i++)a[i]+=<span class="variable">$i&#125;</span>END&#123;<span class="keyword">l</span>=<span class="built_in">length</span>(a);<span class="keyword">for</span>(j=1;j&lt;=<span class="keyword">l</span>;j++) printf a[j]<span class="string">" "</span>;printf <span class="string">"\n"</span>&#125;' <span class="keyword">file</span></span><br><span class="line">83 72 54 57 14</span><br><span class="line"> </span><br><span class="line">7） 行列交换</span><br><span class="line">awk '&#123;<span class="keyword">for</span>(i=1;i&lt;=NF;i++)a[NR,i]=<span class="variable">$i</span>;x=x10 15 16 20 22 </span><br><span class="line">11 17 21 23 </span><br><span class="line">12 18 24 </span><br><span class="line">13 19 25 </span><br><span class="line">14</span><br><span class="line">或者以空格补齐空白处</span><br><span class="line">awk '&#123;<span class="keyword">for</span>(i=1;i&lt;=NF;i++)a[NR,i]=<span class="variable">$i</span>;x=x10 15 16 20 22 </span><br><span class="line">11    17 21 23 </span><br><span class="line">12    18    24 </span><br><span class="line">13    19    25 </span><br><span class="line">14</span><br><span class="line"></span><br><span class="line">【----<span class="keyword">Shell</span>获取字符串长度的多种方法总结---】</span><br><span class="line">方法如下：</span><br><span class="line">【方法一】:利用$&#123;#str&#125;来获取字符串的长度</span><br><span class="line">str=<span class="string">"ABCDEF"</span></span><br><span class="line">echo $&#123;#str&#125;</span><br><span class="line"></span><br><span class="line">【方法二】:利用awk的length方法</span><br><span class="line">str=<span class="string">"ABCDEF"</span></span><br><span class="line">echo <span class="variable">$&#123;str&#125;</span>|awk '&#123;<span class="keyword">print</span> <span class="built_in">length</span>(<span class="variable">$0</span>)&#125;'</span><br><span class="line"></span><br><span class="line">备注:</span><br><span class="line">1) 最好用&#123;&#125;来放置变量</span><br><span class="line">2) 也可以用<span class="built_in">length</span>(<span class="variable">$0</span>)来统计文件中每行的长度</span><br><span class="line">awk '&#123;<span class="keyword">print</span> <span class="built_in">length</span>(<span class="variable">$0</span>)&#125;' /etc/passwd</span><br><span class="line">awk '&#123;<span class="keyword">print</span> <span class="built_in">length</span>(<span class="variable">$NF</span>)&#125;' /etc/passwd #计算最后一个字段的长度</span><br><span class="line"></span><br><span class="line">【方法三】:利用awk的NF项来获取字符串长度</span><br><span class="line">str=<span class="string">"ABCDEF"</span></span><br><span class="line">echo <span class="variable">$&#123;str&#125;</span>|awk -F<span class="string">""</span> '&#123;<span class="keyword">print</span> NF&#125;'</span><br><span class="line"></span><br><span class="line">备注: -F为分隔符，NF为域的个数，即单行字符串的长度</span><br><span class="line"></span><br><span class="line">【方法四】:利用wc的-<span class="keyword">L</span>参数来获取字符串的长度</span><br><span class="line">str=<span class="string">"ABCDEF"</span></span><br><span class="line">echo <span class="variable">$&#123;str&#125;</span>|wc -<span class="keyword">L</span></span><br><span class="line"><span class="keyword">cat</span> /etc/passwd |wc -<span class="keyword">L</span> # 输出：82</span><br><span class="line"></span><br><span class="line">备注: -<span class="keyword">L</span>参数</span><br><span class="line">1) 对多行文件来说，表示打印最长行的长度！82，表示/etc/passwd文件最长行的长度为82。</span><br><span class="line">2) 对单行字符串而言，表示当前行字符串的长度！</span><br><span class="line"></span><br><span class="line">【方法五】:利用wc的-<span class="keyword">l</span>参数，结合echo -<span class="keyword">n</span>参数</span><br><span class="line">str=<span class="string">"ABCDEF"</span></span><br><span class="line">echo -<span class="keyword">n</span> <span class="variable">$&#123;str&#125;</span>|wc -c</span><br><span class="line">echo <span class="variable">$&#123;str&#125;</span> |wc -c</span><br><span class="line"></span><br><span class="line">备注:</span><br><span class="line">1) -c参数: 统计字符的个数</span><br><span class="line">2) -<span class="keyword">n</span>参数: 去除<span class="string">"\n"</span>换行符，不去除的话，默认带换行符，字符个数就成了7</span><br><span class="line"></span><br><span class="line">【方法六】:利用expr的length方法</span><br><span class="line">str=<span class="string">"ABCDEF"</span></span><br><span class="line">expr length <span class="variable">$&#123;str&#125;</span></span><br><span class="line"></span><br><span class="line">【方法七】:利用expr的<span class="variable">$str</span> : <span class="string">".*"</span>技巧，变量带不带花括号无差别</span><br><span class="line">str=<span class="string">"ABCDEF"</span></span><br><span class="line">expr <span class="variable">$&#123;str&#125;</span> : <span class="string">".*"</span></span><br><span class="line"></span><br><span class="line">备注: .*代表任意字符，即用任意字符来匹配字符串，结果是匹配到6个，即字符串的长度为6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">awk输出前最多ip地址：</span><br><span class="line">awk '&#123;ip[<span class="variable">$1</span>]++&#125; END &#123;<span class="keyword">for</span> (i <span class="keyword">in</span> ip) <span class="keyword">print</span> i,ip[i]&#125;' /<span class="keyword">var</span>/<span class="keyword">log</span>/httpd/access_log </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">显示第一行和最后一行：</span><br><span class="line">awk 'NF==1；END｛<span class="keyword">print</span>｝'</span><br><span class="line"></span><br><span class="line">【-------awk去掉某字符串前面所有字符 vOFS-----】</span><br><span class="line">比如：</span><br><span class="line"><span class="keyword">test</span> 1</span><br><span class="line">aaaaatest 2</span><br><span class="line">    <span class="keyword">test</span> 3</span><br><span class="line">tesbbbbbtest <span class="keyword">test</span> 4</span><br><span class="line"></span><br><span class="line">每行去掉<span class="keyword">test</span>前面所有字符之后，输出：</span><br><span class="line"><span class="keyword">test</span> 1</span><br><span class="line"><span class="keyword">test</span> 2</span><br><span class="line"><span class="keyword">test</span> 3</span><br><span class="line"><span class="keyword">test</span> <span class="keyword">test</span> 4</span><br><span class="line"></span><br><span class="line">处理：</span><br><span class="line">awk -F'<span class="keyword">test</span>' -vOFS=<span class="string">"test"</span> '&#123;<span class="variable">$1</span>=<span class="string">""</span>;<span class="variable">$1</span>=<span class="variable">$1&#125;</span>1' <span class="keyword">file</span></span><br><span class="line">awk '&#123;<span class="built_in">match</span>(<span class="variable">$0</span>,<span class="string">"test"</span>);<span class="keyword">print</span> <span class="built_in">substr</span>(<span class="variable">$0</span>,RSTART)&#125;' <span class="keyword">file</span></span><br><span class="line"></span><br><span class="line">解析：</span><br><span class="line">这两种处理方法都很好，</span><br><span class="line">第一种是利用<span class="keyword">test</span>作为分隔符，然后把第一个字段赋值为空，也是就是第一个<span class="keyword">test</span>前面的字符。同时，输出的字段的分隔符还必须是<span class="keyword">test</span>字符串。</span><br><span class="line">第二种方法的话首先查找到<span class="keyword">test</span>字符串的位置，然后这时候RSTART的变量的值就是<span class="keyword">test</span>的开始的位置，而后利用substr函数从此处开始到结束位置。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">awk多个分隔符：</span><br><span class="line">但是如果我想根据多个分隔符进行分割呢？一种办法是两次awk，但是我们可以一次告诉awk我们所有的分隔符，如-和|这两个，如</span><br><span class="line">awk -F ‘[-|]’ ‘&#123;<span class="keyword">print</span> <span class="variable">$3</span>;&#125;’ data</span><br><span class="line"></span><br><span class="line">就这么简单，还有一个问题，如果我们想用[]作为分隔符怎么办？有办法，这样就行：</span><br><span class="line">awk -F ‘[][]’ ‘&#123;<span class="keyword">print</span> <span class="variable">$3</span>;&#125;’ data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">去重命令（去除重复行）：</span><br><span class="line">awk '!a[<span class="variable">$0</span>]++' 42in.txt &gt;42in-new.txt</span><br><span class="line"></span><br><span class="line">awk打印出每一列</span><br><span class="line"> [root@block-storage04 wxttest]# <span class="keyword">cat</span> snbs.<span class="keyword">conf</span> |grep gateway|sed 's/gateway=<span class="comment">//g'|awk -F ";"  '&#123;for(i=1;i&lt;=NF;i++)printf("%s\n",$i);print&#125;'</span></span><br><span class="line">10.242.180.211:8585</span><br><span class="line">10.242.180.210:8585</span><br><span class="line">10.242.180.209:8585</span><br><span class="line">10.242.180.211:8585;10.242.180.210:8585;10.242.180.209:8585</span><br><span class="line"></span><br><span class="line">第一列求和：</span><br><span class="line">awk -F ':' 'BEGIN&#123;<span class="keyword">sum</span>=0&#125;&#123;<span class="keyword">sum</span>+=<span class="variable">$1&#125;</span>END&#123;<span class="keyword">print</span> <span class="keyword">sum</span>&#125;'</span><br><span class="line"></span><br><span class="line">删除第一列：</span><br><span class="line">awk '&#123;<span class="variable">$1</span>=<span class="string">""</span>;<span class="keyword">print</span> <span class="variable">$0&#125;</span>' text</span><br><span class="line"></span><br><span class="line">awk 求平均：awk '&#123;<span class="keyword">sum</span>+=<span class="variable">$1&#125;</span> END &#123;<span class="keyword">print</span> <span class="string">"$k = "</span>, <span class="keyword">sum</span>/NR&#125;'</span><br><span class="line"></span><br><span class="line">每一行行首加上行号:</span><br><span class="line">awk '<span class="variable">$0</span>=NR<span class="string">","</span><span class="variable">$0</span>'</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------</span><br><span class="line">单行、多行转换</span><br><span class="line">#一行数据分割成多行</span><br><span class="line">awk 'BEGIN&#123;i=1&#125;&#123;gsub(/,/,<span class="string">",\n"</span>);i++;<span class="keyword">print</span>&#125;' <span class="keyword">file</span>.txt</span><br><span class="line"></span><br><span class="line">#每两行数据合并成一行（这个可以作为每两行合为一行使用）</span><br><span class="line">sed -<span class="keyword">n</span> '&#123;<span class="keyword">N</span>;s/\<span class="keyword">n</span>/ /p&#125;' <span class="keyword">file</span>.txt</span><br><span class="line"></span><br><span class="line">#指定几行数据合并成一行(此为10行)</span><br><span class="line">awk '&#123;<span class="keyword">if</span> (NR%10==0)&#123;<span class="keyword">print</span> <span class="variable">$0&#125;</span> <span class="keyword">else</span> &#123;printf<span class="string">"%s "</span>,<span class="variable">$0&#125;</span>&#125;' <span class="keyword">file</span>.txt</span><br><span class="line">或</span><br><span class="line"><span class="keyword">cat</span> <span class="keyword">file</span>.txt | awk '&#123;<span class="keyword">if</span>(NR%10!=0)ORS=<span class="string">" "</span>;<span class="keyword">else</span> ORS=<span class="string">"\n"</span>;<span class="keyword">print</span>&#125;'</span><br><span class="line"></span><br><span class="line">#多行数据合并成一行</span><br><span class="line">awk BEGIN&#123;RS=EOF&#125;'&#123;gsub(/\<span class="keyword">n</span>/,<span class="string">" "</span>);<span class="keyword">print</span>&#125;' <span class="keyword">file</span>.txt</span><br><span class="line">或</span><br><span class="line">sed ':a ; <span class="keyword">N</span>;s/\<span class="keyword">n</span>/ / ; t a ; ' <span class="keyword">file</span>.txt</span><br><span class="line">或</span><br><span class="line"><span class="keyword">cat</span> <span class="keyword">file</span>.txt | xargs</span><br><span class="line">或</span><br><span class="line"><span class="keyword">cat</span> <span class="keyword">file</span>.txt | tr '\<span class="keyword">n</span>' ' '</span><br></pre></td></tr></table></figure>





<h3 id="grep-和-awk的buffer"><a href="#grep-和-awk的buffer" class="headerlink" title="grep 和 awk的buffer"></a><a href="https://www.cnblogs.com/cobbliu/p/4954146.html" target="_blank" rel="noopener external nofollow noreferrer">grep 和 awk的buffer</a></h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tail -f <span class="keyword">test</span>.<span class="keyword">log</span> | grep <span class="string">"mode"</span> | awk '&#123;<span class="keyword">print</span> <span class="variable">$5&#125;</span>'命令</span><br><span class="line">或者 tail -f <span class="keyword">test</span>.<span class="keyword">log</span> | awk '/mode/ &#123;<span class="keyword">print</span> <span class="variable">$5&#125;</span>'的时候，如果<span class="keyword">test</span>.<span class="keyword">log</span>中满足模式mode的数据很少，会发现即便是<span class="keyword">test</span>.<span class="keyword">log</span>中新出现了满足mode的行，但是上面两个命令都没有任何输出。</span><br><span class="line"></span><br><span class="line">原因在于grep和awk处于效率的考量，会缓存一批数据再输出到标准输出。</span><br><span class="line"></span><br><span class="line">grep的--<span class="keyword">line</span>-buffered选项和awk的fflush(stdout)命令可以使得grep和awk不缓存数据。如：</span><br><span class="line"></span><br><span class="line">tail -f <span class="keyword">test</span>.<span class="keyword">log</span> | grep --<span class="keyword">line</span>-buffered <span class="string">"mode"</span> | awk '&#123;<span class="keyword">print</span> <span class="variable">$5&#125;</span>'</span><br><span class="line">tail -f <span class="keyword">test</span>.<span class="keyword">log</span> | awk '/mode/ &#123;<span class="keyword">print</span> <span class="variable">$5</span>,<span class="variable">$6</span>; fflush(stdout)&#125;''</span><br></pre></td></tr></table></figure>



<h2 id="十、进程管理"><a href="#十、进程管理" class="headerlink" title="十、进程管理"></a>十、进程管理</h2><h3 id="查看进程"><a href="#查看进程" class="headerlink" title="查看进程"></a>查看进程</h3><h4 id="1-ps"><a href="#1-ps" class="headerlink" title="1. ps"></a>1. ps</h4><p>查看某个时间点的进程信息。</p>
<p>示例：查看自己的进程</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## ps -l</span><br></pre></td></tr></table></figure>

<p>示例：查看系统所有进程</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## ps aux</span><br></pre></td></tr></table></figure>

<p>示例：查看特定的进程</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## ps aux | grep threadx</span><br></pre></td></tr></table></figure>

<h4 id="2-pstree"><a href="#2-pstree" class="headerlink" title="2. pstree"></a>2. pstree</h4><p>查看进程树。</p>
<p>示例：查看所有进程树</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## pstree -A</span></span><br></pre></td></tr></table></figure>

<h4 id="3-top"><a href="#3-top" class="headerlink" title="3. top"></a>3. top</h4><p>实时显示进程信息。</p>
<p>示例：两秒钟刷新一次</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## top -d <span class="number">2</span></span><br></pre></td></tr></table></figure>

<h4 id="4-netstat"><a href="#4-netstat" class="headerlink" title="4. netstat"></a>4. netstat</h4><p>查看占用端口的进程</p>
<p>示例：查看特定端口的进程</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## netstat -anp | grep port</span><br></pre></td></tr></table></figure>

<h3 id="进程状态"><a href="#进程状态" class="headerlink" title="进程状态"></a>进程状态</h3><table>
<thead>
<tr>
<th>状态</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>R</td>
<td>running or runnable (on run queue) 正在执行或者可执行，此时进程位于执行队列中。</td>
</tr>
<tr>
<td>D</td>
<td>uninterruptible sleep (usually I/O) 不可中断阻塞，通常为 IO 阻塞。</td>
</tr>
<tr>
<td>S</td>
<td>interruptible sleep (waiting for an event to complete)  可中断阻塞，此时进程正在等待某个事件完成。</td>
</tr>
<tr>
<td>Z</td>
<td>zombie (terminated but not reaped by its parent) 僵死，进程已经终止但是尚未被其父进程获取信息。</td>
</tr>
<tr>
<td>T</td>
<td>stopped (either by a job control signal or because it is being traced)  结束，进程既可以被作业控制信号结束，也可能是正在被追踪。</td>
</tr>
</tbody></table>
<p><a href="https://camo.githubusercontent.com/ae6622fbe9bed2d92a67e2cac0bbcb86fcf5e015a789aab89faf6b5e0fdb41e5/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f32626162343132372d336537642d343863632d393134652d3433366265383539666230352e706e67" target="_blank" rel="noopener external nofollow noreferrer"><img src="https://camo.githubusercontent.com/ae6622fbe9bed2d92a67e2cac0bbcb86fcf5e015a789aab89faf6b5e0fdb41e5/68747470733a2f2f63732d6e6f7465732d313235363130393739362e636f732e61702d6775616e677a686f752e6d7971636c6f75642e636f6d2f32626162343132372d336537642d343863632d393134652d3433366265383539666230352e706e67" alt="img"></a></p>
<h3 id="SIGCHLD"><a href="#SIGCHLD" class="headerlink" title="SIGCHLD"></a>SIGCHLD</h3><p>当一个子进程改变了它的状态时（停止运行，继续运行或者退出），有两件事会发生在父进程中：</p>
<ul>
<li>得到 SIGCHLD 信号；</li>
<li>waitpid() 或者 wait() 调用会返回。</li>
</ul>
<p>其中子进程发送的 SIGCHLD 信号包含了子进程的信息，比如进程 ID、进程状态、进程使用 CPU 的时间等。</p>
<p>在子进程退出时，它的进程描述符不会立即释放，这是为了让父进程得到子进程信息，父进程通过 wait() 和 waitpid() 来获得一个已经退出的子进程的信息。</p>
<h3 id="wait"><a href="#wait" class="headerlink" title="wait()"></a>wait()</h3><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pid_t <span class="keyword">wait</span>(<span class="built_in">int</span> *<span class="keyword">status</span>)</span><br></pre></td></tr></table></figure>

<p>父进程调用 wait() 会一直阻塞，直到收到一个子进程退出的 SIGCHLD 信号，之后 wait() 函数会销毁子进程并返回。</p>
<p>如果成功，返回被收集的子进程的进程 ID；如果调用进程没有子进程，调用就会失败，此时返回 -1，同时 errno 被置为 ECHILD。</p>
<p>参数 status 用来保存被收集的子进程退出时的一些状态，如果对这个子进程是如何死掉的毫不在意，只想把这个子进程消灭掉，可以设置这个参数为 NULL。</p>
<h3 id="waitpid"><a href="#waitpid" class="headerlink" title="waitpid()"></a>waitpid()</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">pid_t</span> <span class="title">waitpid</span><span class="params">(<span class="keyword">pid_t</span> pid, <span class="keyword">int</span> *status, <span class="keyword">int</span> options)</span></span></span><br></pre></td></tr></table></figure>

<p>作用和 wait() 完全相同，但是多了两个可由用户控制的参数 pid 和 options。</p>
<p>pid 参数指示一个子进程的 ID，表示只关心这个子进程退出的 SIGCHLD 信号。如果 pid=-1 时，那么和 wait() 作用相同，都是关心所有子进程退出的 SIGCHLD 信号。</p>
<p>options 参数主要有 WNOHANG 和 WUNTRACED 两个选项，WNOHANG 可以使 waitpid() 调用变成非阻塞的，也就是说它会立即返回，父进程可以继续执行其它任务。</p>
<h3 id="孤儿进程"><a href="#孤儿进程" class="headerlink" title="孤儿进程"></a>孤儿进程</h3><p>一个父进程退出，而它的一个或多个子进程还在运行，那么这些子进程将成为孤儿进程。</p>
<p>孤儿进程将被 init 进程（进程号为 1）所收养，并由 init 进程对它们完成状态收集工作。</p>
<p>由于孤儿进程会被 init 进程收养，所以孤儿进程不会对系统造成危害。</p>
<h3 id="僵尸进程"><a href="#僵尸进程" class="headerlink" title="僵尸进程"></a>僵尸进程</h3><p>一个子进程的进程描述符在子进程退出时不会释放，只有当父进程通过 wait() 或 waitpid() 获取了子进程信息后才会释放。如果子进程退出，而父进程并没有调用 wait() 或 waitpid()，那么子进程的进程描述符仍然保存在系统中，这种进程称之为僵尸进程。</p>
<p>僵尸进程通过 ps 命令显示出来的状态为 Z（zombie）。</p>
<p>系统所能使用的进程号是有限的，如果产生大量僵尸进程，将因为没有可用的进程号而导致系统不能产生新的进程。</p>
<p>要消灭系统中大量的僵尸进程，只需要将其父进程杀死，此时僵尸进程就会变成孤儿进程，从而被 init 进程所收养，这样 init 进程就会释放所有的僵尸进程所占有的资源，从而结束僵尸进程。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li>鸟哥. 鸟 哥 的 Linux 私 房 菜 基 础 篇 第 三 版[J]. 2009.</li>
<li><a href="https://www.ibm.com/developerworks/cn/linux/l-cn-rpmdpkg/index.html" target="_blank" rel="noopener external nofollow noreferrer">Linux 平台上的软件包管理</a></li>
<li><a href="http://liubigbin.github.io/2016/03/11/Linux-之守护进程、僵死进程与孤儿进程/" target="_blank" rel="noopener external nofollow noreferrer">Linux 之守护进程、僵死进程与孤儿进程</a></li>
<li><a href="https://stackoverflow.com/questions/185899/what-is-the-difference-between-a-symbolic-link-and-a-hard-link" target="_blank" rel="noopener external nofollow noreferrer">What is the difference between a symbolic link and a hard link?</a></li>
<li><a href="https://idea.popcount.org/2012-12-11-linux-process-states/" target="_blank" rel="noopener external nofollow noreferrer">Linux process states</a></li>
<li><a href="https://en.wikipedia.org/wiki/GUID_Partition_Table" target="_blank" rel="noopener external nofollow noreferrer">GUID Partition Table</a></li>
<li><a href="https://blog.csdn.net/kevinhg/article/details/7001719" target="_blank" rel="noopener external nofollow noreferrer">详解 wait 和 waitpid 函数</a></li>
<li><a href="https://blog.csdn.net/tianlesoftware/article/details/6009110" target="_blank" rel="noopener external nofollow noreferrer">IDE、SATA、SCSI、SAS、FC、SSD 硬盘类型介绍</a></li>
<li><a href="http://www.mpchunter.com/s3000/akai-ib-301s-scsi-interface-for-s2800s3000/" target="_blank" rel="noopener external nofollow noreferrer">Akai IB-301S SCSI Interface for S2800,S3000</a></li>
<li><a href="https://en.wikipedia.org/wiki/Parallel_ATA" target="_blank" rel="noopener external nofollow noreferrer">Parallel ATA</a></li>
<li><a href="http://www.thessdreview.com/our-reviews/adata-xpg-sx900-256gb-sata-3-ssd-review-expanded-capacity-and-sandforce-driven-speed/4/" target="_blank" rel="noopener external nofollow noreferrer">ADATA XPG SX900 256GB SATA 3 SSD Review – Expanded Capacity and SandForce Driven Speed</a></li>
<li><a href="https://blogs.cisco.com/datacenter/decoding-ucs-invicta-part-1" target="_blank" rel="noopener external nofollow noreferrer">Decoding UCS Invicta – Part 1</a></li>
<li><a href="https://zh.wikipedia.org/wiki/硬盘" target="_blank" rel="noopener external nofollow noreferrer">硬盘</a></li>
<li><a href="http://www.differencebetween.info/difference-between-sas-and-sata" target="_blank" rel="noopener external nofollow noreferrer">Difference between SAS and SATA</a></li>
<li><a href="https://zh.wikipedia.org/wiki/BIOS" target="_blank" rel="noopener external nofollow noreferrer">BIOS</a></li>
<li><a href="https://www.cs.rutgers.edu/~pxk/416/notes/13-fs-studies.html" target="_blank" rel="noopener external nofollow noreferrer">File system design case studies</a></li>
<li><a href="https://classes.soe.ucsc.edu/cmps111/Fall08/proj4.shtml" target="_blank" rel="noopener external nofollow noreferrer">Programming Project #4</a></li>
<li><a href="http://web.cs.ucla.edu/classes/fall14/cs111/scribe/11a/index.html" target="_blank" rel="noopener external nofollow noreferrer">FILE SYSTEM DESIGN</a></li>
</ul>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章推荐</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2007\01\16\linux\2007-01-16-linux-LinuxDeploy\" rel="bookmark">安卓Linux</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2022\05\17\linux\Linux上天之路\000-Linux上天之路系列目录\" rel="bookmark">Linux上天之路系列目录</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2022\05\17\linux\Linux上天之路\001-Linux前世今生\" rel="bookmark">001-Linux前世今生</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2022\05\17\linux\Linux上天之路\002-Linux安装\" rel="bookmark">Linux上天之路（二）之Linux安装</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2022\05\17\linux\Linux上天之路\003-Linux系统目录\" rel="bookmark">Linux上天之路（三）之Linux系统目录</a></div>
    </li>
  </ul>

        <div class="reward-container">
  <div>赞赏一下吧～</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="tongsiying 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>tongsiying
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tongsiying.github.io/2022/05/17/linux/Linux/" title="001-Linux前世今生">https://tongsiying.github.io/2022/05/17/linux/Linux/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/linux/" rel="tag"># linux</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/17/linux/Linux%E4%B8%8A%E5%A4%A9%E4%B9%8B%E8%B7%AF/003-Linux%E7%B3%BB%E7%BB%9F%E7%9B%AE%E5%BD%95/" rel="prev" title="Linux上天之路（三）之Linux系统目录">
      <i class="fa fa-chevron-left"></i> Linux上天之路（三）之Linux系统目录
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/17/linux/Linux%E4%B8%8A%E5%A4%A9%E4%B9%8B%E8%B7%AF/002-Linux%E5%AE%89%E8%A3%85/" rel="next" title="Linux上天之路（二）之Linux安装">
      Linux上天之路（二）之Linux安装 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Linux"><span class="nav-text">Linux</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一、常用操作以及概念"><span class="nav-text">一、常用操作以及概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#快捷键"><span class="nav-text">快捷键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#求助"><span class="nav-text">求助</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-–help"><span class="nav-text">1. –help</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-man"><span class="nav-text">2. man</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-info"><span class="nav-text">3. info</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-doc"><span class="nav-text">4. doc</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关机"><span class="nav-text">关机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-who"><span class="nav-text">1. who</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-sync"><span class="nav-text">2. sync</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-shutdown"><span class="nav-text">3. shutdown</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PATH"><span class="nav-text">PATH</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sudo"><span class="nav-text">sudo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#包管理工具"><span class="nav-text">包管理工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#发行版"><span class="nav-text">发行版</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VIM-三个模式"><span class="nav-text">VIM 三个模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GNU"><span class="nav-text">GNU</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开源协议"><span class="nav-text">开源协议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、磁盘"><span class="nav-text">二、磁盘</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#磁盘接口"><span class="nav-text">磁盘接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-IDE"><span class="nav-text">1. IDE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-SATA"><span class="nav-text">2. SATA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-SCSI"><span class="nav-text">3. SCSI</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-SAS"><span class="nav-text">4. SAS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#磁盘的文件名"><span class="nav-text">磁盘的文件名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看磁盘分区UUID的四种方法"><span class="nav-text">查看磁盘分区UUID的四种方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何关闭硬盘写缓存（Write-Cache）"><span class="nav-text">如何关闭硬盘写缓存（Write Cache）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Linux创建虚拟块设备并格式化为文件系统"><span class="nav-text">Linux创建虚拟块设备并格式化为文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#惰性初始化"><span class="nav-text">惰性初始化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#raid卡"><span class="nav-text">raid卡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#storcli64"><span class="nav-text">storcli64</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MegaCli"><span class="nav-text">MegaCli</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#去除raid-0"><span class="nav-text">去除raid 0</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看磁盘型号"><span class="nav-text">查看磁盘型号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lvm"><span class="nav-text">lvm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#part"><span class="nav-text">part</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fdisk"><span class="nav-text">fdisk</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、分区"><span class="nav-text">三、分区</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#分区表"><span class="nav-text">分区表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-MBR"><span class="nav-text">1. MBR</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-GPT"><span class="nav-text">2. GPT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-MBR和GPT"><span class="nav-text">3. MBR和GPT</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开机检测程序"><span class="nav-text">开机检测程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-BIOS"><span class="nav-text">1. BIOS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-UEFI"><span class="nav-text">2. UEFI</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、文件系统"><span class="nav-text">四、文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#分区与文件系统"><span class="nav-text">分区与文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组成"><span class="nav-text">组成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件读取"><span class="nav-text">文件读取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#磁盘碎片"><span class="nav-text">磁盘碎片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#block"><span class="nav-text">block</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#inode"><span class="nav-text">inode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#目录"><span class="nav-text">目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#日志"><span class="nav-text">日志</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#挂载"><span class="nav-text">挂载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#目录配置"><span class="nav-text">目录配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、文件"><span class="nav-text">五、文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#文件属性"><span class="nav-text">文件属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件与目录的基本操作"><span class="nav-text">文件与目录的基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-ls"><span class="nav-text">1. ls</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-cd"><span class="nav-text">2. cd</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-mkdir"><span class="nav-text">3. mkdir</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-rmdir"><span class="nav-text">4. rmdir</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-touch"><span class="nav-text">5. touch</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-cp"><span class="nav-text">6. cp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-rm"><span class="nav-text">7. rm</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-mv"><span class="nav-text">8. mv</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改权限"><span class="nav-text">修改权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#默认权限"><span class="nav-text">默认权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#目录的权限"><span class="nav-text">目录的权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#链接"><span class="nav-text">链接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-实体链接"><span class="nav-text">1. 实体链接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-符号链接"><span class="nav-text">2. 符号链接</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取文件内容"><span class="nav-text">获取文件内容</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-cat"><span class="nav-text">1. cat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-tac"><span class="nav-text">2. tac</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-more"><span class="nav-text">3. more</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-less"><span class="nav-text">4. less</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-head"><span class="nav-text">5. head</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-tail"><span class="nav-text">6. tail</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-od"><span class="nav-text">7. od</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#column-对齐"><span class="nav-text">column :对齐</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#stat：文件的状态信息"><span class="nav-text">stat：文件的状态信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#paste-d"><span class="nav-text">paste -d,</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#split"><span class="nav-text">split</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#qemu-img"><span class="nav-text">qemu-img</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dd"><span class="nav-text">dd</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#map：键值"><span class="nav-text">map：键值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-shuf命令"><span class="nav-text">8. shuf命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-ASCII比较大小"><span class="nav-text">8. ASCII比较大小</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-字符串"><span class="nav-text">9. 字符串</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#指令与文件搜索"><span class="nav-text">指令与文件搜索</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-which"><span class="nav-text">1. which</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-whereis"><span class="nav-text">2. whereis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-locate"><span class="nav-text">3. locate</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-find"><span class="nav-text">4. find</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#六、压缩与打包"><span class="nav-text">六、压缩与打包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#压缩文件名"><span class="nav-text">压缩文件名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#压缩指令"><span class="nav-text">压缩指令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-gzip"><span class="nav-text">1. gzip</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-bzip2"><span class="nav-text">2. bzip2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-xz"><span class="nav-text">3. xz</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#打包"><span class="nav-text">打包</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#七、Bash"><span class="nav-text">七、Bash</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#特性"><span class="nav-text">特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#变量操作"><span class="nav-text">变量操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#指令搜索顺序"><span class="nav-text">指令搜索顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据流重定向"><span class="nav-text">数据流重定向</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#八、管道指令"><span class="nav-text">八、管道指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#提取指令"><span class="nav-text">提取指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#排序指令"><span class="nav-text">排序指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#双向输出重定向"><span class="nav-text">双向输出重定向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符转换指令"><span class="nav-text">字符转换指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分区指令"><span class="nav-text">分区指令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#九、正则表达式"><span class="nav-text">九、正则表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#通配符"><span class="nav-text">通配符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#grep"><span class="nav-text">grep</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#printf"><span class="nav-text">printf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tr："><span class="nav-text">tr：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sed"><span class="nav-text">sed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#awk"><span class="nav-text">awk</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#grep-和-awk的buffer"><span class="nav-text">grep 和 awk的buffer</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#十、进程管理"><span class="nav-text">十、进程管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#查看进程"><span class="nav-text">查看进程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-ps"><span class="nav-text">1. ps</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-pstree"><span class="nav-text">2. pstree</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-top"><span class="nav-text">3. top</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-netstat"><span class="nav-text">4. netstat</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#进程状态"><span class="nav-text">进程状态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SIGCHLD"><span class="nav-text">SIGCHLD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#wait"><span class="nav-text">wait()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#waitpid"><span class="nav-text">waitpid()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#孤儿进程"><span class="nav-text">孤儿进程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#僵尸进程"><span class="nav-text">僵尸进程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-text">参考资料</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="tongsiying"
      src="/images/gutianle.gif">
  <p class="site-author-name" itemprop="name">tongsiying</p>
  <div class="site-description" itemprop="description">问渠那得清如许？为有源头活水来。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">436</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/tongsiying" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tongsiying" rel="noopener external nofollow noreferrer" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wxtlucky1015@163.com" title="E-Mail → mailto:wxtlucky1015@163.com" rel="noopener external nofollow noreferrer" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/2964109344" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;2964109344" rel="noopener external nofollow noreferrer" target="_blank"><i class="weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/" title="tongsiying → https:&#x2F;&#x2F;tongsiying.github.io"><i class="wrench fa-fw"></i>tongsiying</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/ReadingNotes/" title="ReadingNotes → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;ReadingNotes&#x2F;"><i class="book fa-fw"></i>ReadingNotes</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/blog/" title="blog → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;blog&#x2F;"><i class="book fa-fw"></i>blog</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/blog/tools/" title="tools → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;blog&#x2F;tools&#x2F;"><i class="wrench fa-fw"></i>tools</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/lanlan/" title="lanlan → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;lanlan&#x2F;"><i class="wrench fa-fw"></i>lanlan</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/Music/" title="note → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;Music&#x2F;"><i class="wrench fa-fw"></i>note</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/sound/" title="Music → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;sound&#x2F;"><i class="wrench fa-fw"></i>Music</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/JSONFormat/" title="JSONFormat → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;JSONFormat&#x2F;"><i class="wrench fa-fw"></i>JSONFormat</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/HTML5-Canvas/" title="Canvas → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;HTML5-Canvas&#x2F;"><i class="wrench fa-fw"></i>Canvas</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/games/" title="games → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;games&#x2F;"><i class="wrench fa-fw"></i>games</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/love/" title="love → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;love&#x2F;"><i class="wrench fa-fw"></i>love</a>
      </span>
  </div>



		<div style="">
  <canvas id="canvas" style="width:60%;">��ǰ�������֧��canvas������������������</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //����canvas�Ŀ���
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //�洢ʱ������
    var data = [];
    //�洢�˶���С��
    var balls = [];
    //�������Ӱ뾶
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //�洢ʱ�����֣���ʮλСʱ����λСʱ��ð�š�ʮλ���ӡ���λ���ӡ�ð�š�ʮλ���ӡ���λ������7���������
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*���ɵ�������*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*����ʱ��*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //ʱ�䷢���仯
            if(NewData[i] !== data[i]){
                //���仯������ֵ����data�����е������洢��changeNumArray������
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //����С��
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*����С��״̬*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*����Ҫ�˶���С��*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*��Ⱦ*/
    function render(){
        //���û������ȣ��ﵽ��ջ�����Ч��
        canvas.height = 100;
        //��Ⱦʱ��
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //��ȾС��
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //����ʱ��
        updateDigitTime();
        //����С��״̬
        updateBalls();
        //��Ⱦ
        render();
    },50);
}

})();
</script>
      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; Weeny – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tongsiying</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">7.7m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">116:27</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
