<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/hedgehog.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/hedgehog.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tongsiying.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","b2t":true,"scrollpercent":true,"padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="article">
<meta property="og:title" content="第36篇：MySQL进阶">
<meta property="og:url" content="https://tongsiying.github.io/2022/01/18/python/python_%E5%9F%BA%E7%A1%80%E7%AF%87/%E7%AC%AC36%E7%AF%87%EF%BC%9AMySQL%E8%BF%9B%E9%98%B6/index.html">
<meta property="og:site_name" content="tongsiying">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tongsiying.github.io/2022/01/18/python/python_%E5%9F%BA%E7%A1%80%E7%AF%87/%E7%AC%AC36%E7%AF%87%EF%BC%9AMySQL%E8%BF%9B%E9%98%B6/1476293-20181229223620930-495058216.jpg">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="og:image" content="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif">
<meta property="article:published_time" content="2022-01-18T13:14:05.288Z">
<meta property="article:modified_time" content="2022-01-18T14:04:31.766Z">
<meta property="article:author" content="tongsiying">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tongsiying.github.io/2022/01/18/python/python_%E5%9F%BA%E7%A1%80%E7%AF%87/%E7%AC%AC36%E7%AF%87%EF%BC%9AMySQL%E8%BF%9B%E9%98%B6/1476293-20181229223620930-495058216.jpg">

<link rel="canonical" href="https://tongsiying.github.io/2022/01/18/python/python_%E5%9F%BA%E7%A1%80%E7%AF%87/%E7%AC%AC36%E7%AF%87%EF%BC%9AMySQL%E8%BF%9B%E9%98%B6/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>第36篇：MySQL进阶 | tongsiying</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
<!-- 加入APlayer音乐播放器 -->
<link rel="stylesheet" href="/dist/APlayer.min.css">
<div id="aplayer"></div>
<script type="text/javascript" src="/dist/APlayer.min.js"></script>
<script type="text/javascript" src="/dist/music.js"></script>
  <div class="container use-motion">
    <div class="headband"></div>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">tongsiying</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">阅读|运动|自律</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/catalog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-目录">

    <a href="/catalog/" rel="section"><i class="fa fa fa-th fa-fw"></i>目录</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-读书清单">

    <a href="/read" rel="section"><i class="fa fa-book fa-fw"></i>读书清单</a>

  </li>
        <li class="menu-item menu-item-读书笔记">

    <a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="section"><i class="fa fa-book fa-fw"></i>读书笔记</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tongsiying.github.io/2022/01/18/python/python_%E5%9F%BA%E7%A1%80%E7%AF%87/%E7%AC%AC36%E7%AF%87%EF%BC%9AMySQL%E8%BF%9B%E9%98%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/gutianle.gif">
      <meta itemprop="name" content="tongsiying">
      <meta itemprop="description" content="问渠那得清如许？为有源头活水来。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tongsiying">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          第36篇：MySQL进阶
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-01-18 21:14:05 / 修改时间：22:04:31" itemprop="dateCreated datePublished" datetime="2022-01-18T21:14:05+08:00">2022-01-18</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>47k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>43 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p class="description"></p>
<a id="more"></a>        

<h1 id="一、视图"><a href="#一、视图" class="headerlink" title="一、视图"></a><strong>一、视图</strong></h1><p>　　<strong>数据库视图是虚拟表或逻辑表，它被定义为具有<a href="http://www.yiibai.com/mysql/inner-join.html" target="_blank" rel="noopener external nofollow noreferrer">连接</a>的SQL <a href="http://www.yiibai.com/mysql/select-statement-query-data.html" target="_blank" rel="noopener external nofollow noreferrer">SELECT</a>查询语句。其本质是为常用的查询语句起个别名。用户使用时只需使用【名称】即可获取结果集，并可以将其当作表来使用。不是真正存在。视图存在数据库中。</strong></p>
<p>　　<strong><img src="/2022/01/18/python/python_%E5%9F%BA%E7%A1%80%E7%AF%87/%E7%AC%AC36%E7%AF%87%EF%BC%9AMySQL%E8%BF%9B%E9%98%B6/1476293-20181229223620930-495058216.jpg" alt="img"></strong></p>
<p><strong>数据库视图是动态的，因为它与物理模式无关。数据库系统将数据库视图存储为具有连接的<a href="http://www.yiibai.com/mysql/select-statement-query-data.html" target="_blank" rel="noopener external nofollow noreferrer">SQL SELECT</a>语句。当表的数据发生变化时，视图也反映了这些数据的变化。</strong></p>
<h2 id="数据库视图的优点"><a href="#数据库视图的优点" class="headerlink" title="数据库视图的优点"></a><strong>数据库视图的优点</strong></h2><ul>
<li>简单：使用视图的用户完全不需要关心后面对应的表的结构、关联条件和筛选条件，对用户来说已经是过滤好的复合条件的结果集。</li>
<li>安全：使用视图的用户只能访问他们被允许查询的结果集，对表的权限管理并不能限制到某个行某个列，但是通过视图就可以简单的实现。</li>
<li>数据独立：一旦视图的结构确定了，可以屏蔽表结构变化对用户的影响，源表增加列对视图没有影响；源表修改列名，则可以通过修改视图来解决，不会造成对访问者的影响。</li>
</ul>
<p>　　总而言之，使用视图的大部分情况是为了保障数据安全性，提高查询效率。</p>
<h2 id="数据库视图的缺点"><a href="#数据库视图的缺点" class="headerlink" title="数据库视图的缺点"></a><strong>数据库视图的缺点</strong></h2><p>除了上面的优点，使用数据库视图有几个缺点：</p>
<ul>
<li><em>性能</em>：从数据库视图查询数据可能会很慢，特别是如果视图是基于其他视图创建的。</li>
<li><em>表依赖关系</em>：将根据数据库的基础表创建一个视图。每当更改与其相关联的表的结构时，都必须更改视图。</li>
</ul>
<h2 id="1-创建视图"><a href="#1-创建视图" class="headerlink" title="1. 创建视图"></a>1. 创建视图</h2><p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 创建视图语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> <span class="keyword">REPLACE</span>] [ALGORITHM = &#123;UNDEFINED | <span class="keyword">MERGE</span> | TEMPTABLE&#125;]</span><br><span class="line">    <span class="keyword">VIEW</span> view_name [(column_list)]</span><br><span class="line">    <span class="keyword">AS</span> select_statement</span><br><span class="line">   [<span class="keyword">WITH</span> [<span class="keyword">CASCADED</span> | <span class="keyword">LOCAL</span>] <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 参数解释</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1 参数解释</span><br><span class="line">2 1）OR <span class="keyword">REPLACE</span>：表示替换已有视图</span><br><span class="line"><span class="number">3</span> <span class="number">2</span>）ALGORITHM：表示视图选择算法，默认算法是UNDEFINED(未定义的)：MySQL自动选择要使用的算法 ；<span class="keyword">merge</span>合并；temptable临时表</span><br><span class="line"><span class="number">4</span> <span class="number">3</span>）select_statement：表示<span class="keyword">select</span>语句</span><br><span class="line"><span class="number">5</span> <span class="number">4</span>）[<span class="keyword">WITH</span> [<span class="keyword">CASCADED</span> | <span class="keyword">LOCAL</span>] <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>]：表示视图在更新时保证在视图的权限范围之内</span><br><span class="line"><span class="number">6</span> 　　<span class="keyword">cascade</span>是默认值，表示更新视图的时候，要满足视图和表的相关条件</span><br><span class="line"><span class="number">7</span> 　　<span class="keyword">local</span>表示更新视图的时候，要满足该视图定义的一个条件即可</span><br><span class="line"><span class="number">8</span> TIPS：推荐使用WHIT [<span class="keyword">CASCADED</span>|<span class="keyword">LOCAL</span>] <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>选项，可以保证数据的安全性 </span><br><span class="line"></span><br><span class="line">参数解释</span><br></pre></td></tr></table></figure>



<p><strong>基本格式：</strong>　</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create view &lt;视图名称&gt;[(column_list)]</span><br><span class="line">as select语句</span><br><span class="line">with<span class="built_in"> check </span>option;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 单表创建视图</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create view v_F_players(编号,名字,性别,电话)</span><br><span class="line">    -&gt; as</span><br><span class="line">    -&gt; select PLAYERNO,NAME,SEX,PHONENO from PLAYERS</span><br><span class="line">    -&gt; where SEX='F'</span><br><span class="line">    -&gt; with check option;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc v_F_players;</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">|<span class="string"> Field  </span>|<span class="string"> Type     </span>|<span class="string"> Null </span>|<span class="string"> Key </span>|<span class="string"> Default </span>|<span class="string"> Extra </span>|</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">|<span class="string"> 编号    </span>|<span class="string"> int(11)  </span>|<span class="string"> NO   </span>|<span class="string">     </span>|<span class="string"> NULL    </span>|<span class="string">       </span>|</span><br><span class="line">|<span class="string"> 名字    </span>|<span class="string"> char(15) </span>|<span class="string"> NO   </span>|<span class="string">     </span>|<span class="string"> NULL    </span>|<span class="string">       </span>|</span><br><span class="line">|<span class="string"> 性别    </span>|<span class="string"> char(1)  </span>|<span class="string"> NO   </span>|<span class="string">     </span>|<span class="string"> NULL    </span>|<span class="string">       </span>|</span><br><span class="line">|<span class="string"> 电话    </span>|<span class="string"> char(13) </span>|<span class="string"> YES  </span>|<span class="string">     </span>|<span class="string"> NULL    </span>|<span class="string">       </span>|</span><br><span class="line">+--------+----------+------+-----+---------+-------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select <span class="symbol">*</span> from  v_F_players;</span><br><span class="line">+--------+-----------+--------+------------+</span><br><span class="line">|<span class="string"> 编号    </span>|<span class="string"> 名字      </span>|<span class="string"> 性别    </span>|<span class="string"> 电话        </span>|</span><br><span class="line">+--------+-----------+--------+------------+</span><br><span class="line">|<span class="string">      8 </span>|<span class="string"> Newcastle </span>|<span class="string"> F      </span>|<span class="string"> 070-458458 </span>|</span><br><span class="line">|<span class="string">     27 </span>|<span class="string"> Collins   </span>|<span class="string"> F      </span>|<span class="string"> 079-234857 </span>|</span><br><span class="line">|<span class="string">     28 </span>|<span class="string"> Collins   </span>|<span class="string"> F      </span>|<span class="string"> 010-659599 </span>|</span><br><span class="line">|<span class="string">    104 </span>|<span class="string"> Moorman   </span>|<span class="string"> F      </span>|<span class="string"> 079-987571 </span>|</span><br><span class="line">|<span class="string">    112 </span>|<span class="string"> Bailey    </span>|<span class="string"> F      </span>|<span class="string"> 010-548745 </span>|</span><br><span class="line">+--------+-----------+--------+------------+</span><br><span class="line">5 rows in set (0.02 sec)</span><br><span class="line"></span><br><span class="line">单表创建视图</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 多表创建视图</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create view v_match</span><br><span class="line">    -&gt; <span class="built_in">as</span> </span><br><span class="line">    -&gt; select a.PLAYERNO,a.NAME,MATCHNO,WON,LOST,c.TEAMNO,c.DIVISION</span><br><span class="line">    -&gt; from </span><br><span class="line">    -&gt; PLAYERS a,MATCHES b,TEAMS c</span><br><span class="line">    -&gt; <span class="keyword">where</span> a.PLAYERNO=b.PLAYERNO and b.TEAMNO=c.TEAMNO;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.03</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from v_match;</span><br><span class="line">+----------+-----------+---------+-----+------+--------+----------+</span><br><span class="line">| <span class="type">PLAYERNO</span> | <span class="type">NAME</span>      | <span class="type">MATCHNO</span> | <span class="type">WON</span> | <span class="type">LOST</span> | <span class="type">TEAMNO</span> | <span class="type">DIVISION</span> |<span class="type"></span></span><br><span class="line"><span class="type">+----------+-----------+---------+-----+------+--------+----------+</span></span><br><span class="line"><span class="type">|        6</span> | <span class="type">Parmenter</span> |       <span class="type">1</span> |   <span class="type">3</span> |    <span class="type">1</span> |      <span class="type">1</span> | <span class="type">first</span>    |<span class="type"></span></span><br><span class="line"><span class="type">|       44</span> | <span class="type">Baker</span>     |       <span class="type">4</span> |   <span class="type">3</span> |    <span class="type">2</span> |      <span class="type">1</span> | <span class="type">first</span>    |<span class="type"></span></span><br><span class="line"><span class="type">|       83</span> | <span class="type">Hope</span>      |       <span class="type">5</span> |   <span class="type">0</span> |    <span class="type">3</span> |      <span class="type">1</span> | <span class="type">first</span>    |<span class="type"></span></span><br><span class="line"><span class="type">|      112</span> | <span class="type">Bailey</span>    |      <span class="type">12</span> |   <span class="type">1</span> |    <span class="type">3</span> |      <span class="type">2</span> | <span class="type">second</span>   |<span class="type"></span></span><br><span class="line"><span class="type">|        8</span> | <span class="type">Newcastle</span> |      <span class="type">13</span> |   <span class="type">0</span> |    <span class="type">3</span> |      <span class="type">2</span> | <span class="type">second</span>   |<span class="type"></span></span><br><span class="line"><span class="type">+----------+-----------+---------+-----+------+--------+----------+</span></span><br><span class="line"><span class="type">5</span> rows <span class="built_in">in</span> <span class="built_in">set</span> (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">多表创建视图</span><br></pre></td></tr></table></figure>

<ul>
<li>　 视图将我们不需要的数据过滤掉，将相关的列名用我们自定义的列名替换。视图作为一个访问接口，不管基表的表结构和表名有多复杂。</li>
<li>如果创建视图时不明确指定视图的列名，那么列名就和定义视图的select子句中的列名完全相同；</li>
<li>　 如果显式的指定视图的列名就按照指定的列名。</li>
</ul>
<p>　　<strong>注意：显示指定视图列名，要求视图名后面的列的数量必须匹配select子句中的列的数量。</strong></p>
<h2 id="2-查看视图"><a href="#2-查看视图" class="headerlink" title="2. 查看视图"></a><strong>2. 查看视图</strong></h2><p><strong>（1）使用show create view语句查看视图信息</strong></p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show <span class="keyword">create</span> <span class="keyword">view</span> v_F_players\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">                View: v_F_players</span><br><span class="line">         <span class="keyword">Create</span> <span class="keyword">View</span>: <span class="keyword">CREATE</span> ALGORITHM=UNDEFINED DEFINER=<span class="symbol">`root`</span>@<span class="symbol">`localhost`</span> SQL SECURITY DEFINER <span class="keyword">VIEW</span> <span class="symbol">`v_F_players`</span> <span class="keyword">AS</span> <span class="keyword">select</span> <span class="symbol">`PLAYERS`</span>.<span class="symbol">`PLAYERNO`</span> <span class="keyword">AS</span> <span class="symbol">`编号`</span>,<span class="symbol">`PLAYERS`</span>.<span class="symbol">`NAME`</span> <span class="keyword">AS</span> <span class="symbol">`名字`</span>,<span class="symbol">`PLAYERS`</span>.<span class="symbol">`SEX`</span> <span class="keyword">AS</span> <span class="symbol">`性别`</span>,<span class="symbol">`PLAYERS`</span>.<span class="symbol">`PHONENO`</span> <span class="keyword">AS</span> <span class="symbol">`电话`</span> <span class="keyword">from</span> <span class="symbol">`PLAYERS`</span> <span class="keyword">where</span> (<span class="symbol">`PLAYERS`</span>.<span class="symbol">`SEX`</span> = <span class="string">'F'</span>) <span class="keyword">WITH</span> CASCADED CHECK <span class="keyword">OPTION</span></span><br><span class="line">character_set_client: utf8</span><br><span class="line">collation_connection: utf8_general_ci</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>



<p><strong>（2）视图一旦创建完毕，就可以像一个普通表那样使用，视图主要用来查询</strong></p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> view_name;</span><br></pre></td></tr></table></figure>



<p><strong>（3）有关视图的信息记录在information_schema数据库中的views表中</strong></p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> information_schema.views</span><br><span class="line">    -&gt; <span class="keyword">where</span> TABLE_NAME=<span class="string">'v_F_players'</span>\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">       TABLE_CATALOG: def</span><br><span class="line">        TABLE_SCHEMA: TENNIS</span><br><span class="line">          TABLE_NAME: v_F_players</span><br><span class="line">     VIEW_DEFINITION: <span class="keyword">select</span> <span class="symbol">`TENNIS`</span>.<span class="symbol">`PLAYERS`</span>.<span class="symbol">`PLAYERNO`</span> <span class="keyword">AS</span> <span class="symbol">`编号`</span>,<span class="symbol">`TENNIS`</span>.<span class="symbol">`PLAYERS`</span>.<span class="symbol">`NAME`</span> <span class="keyword">AS</span> <span class="symbol">`名字`</span>,<span class="symbol">`TENNIS`</span>.<span class="symbol">`PLAYERS`</span>.<span class="symbol">`SEX`</span> <span class="keyword">AS</span> <span class="symbol">`性别`</span>,<span class="symbol">`TENNIS`</span>.<span class="symbol">`PLAYERS`</span>.<span class="symbol">`PHONENO`</span> <span class="keyword">AS</span> <span class="symbol">`电话`</span> <span class="keyword">from</span> <span class="symbol">`TENNIS`</span>.<span class="symbol">`PLAYERS`</span> <span class="keyword">where</span> (<span class="symbol">`TENNIS`</span>.<span class="symbol">`PLAYERS`</span>.<span class="symbol">`SEX`</span> = <span class="string">'F'</span>)</span><br><span class="line">        CHECK_OPTION: CASCADED</span><br><span class="line">        IS_UPDATABLE: YES</span><br><span class="line">             DEFINER: root@localhost</span><br><span class="line">       SECURITY_TYPE: DEFINER</span><br><span class="line">CHARACTER_SET_CLIENT: utf8</span><br><span class="line">COLLATION_CONNECTION: utf8_general_ci</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>



<h2 id="3-视图的更改"><a href="#3-视图的更改" class="headerlink" title="3. 视图的更改"></a><strong>3. 视图的更改</strong></h2><h3 id="3-1-CREATE-OR-REPLACE-VIEW语句修改视图"><a href="#3-1-CREATE-OR-REPLACE-VIEW语句修改视图" class="headerlink" title="3.1 CREATE OR REPLACE VIEW语句修改视图"></a><strong>3.1 CREATE OR REPLACE VIEW语句修改视图</strong></h3><p><strong>基本格式：</strong></p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="built_in">replace</span> <span class="keyword">view</span> view_name <span class="keyword">as</span> <span class="keyword">select</span>语句;</span><br><span class="line"></span><br><span class="line">在视图存在的情况下可对视图进行修改，视图不在的情况下可创建视图</span><br></pre></td></tr></table></figure>



<h3 id="3-2-ALTER语句修改视图"><a href="#3-2-ALTER语句修改视图" class="headerlink" title="3.2 ALTER语句修改视图"></a><strong>3.2 ALTER语句修改视图</strong></h3><p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> alter修改视图语法</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span></span><br><span class="line">    [ALGORITHM = &#123;UNDEFINED | MERGE | TEMPTABLE&#125;]</span><br><span class="line">    [<span class="keyword">DEFINER</span> = &#123; <span class="keyword">user</span> | <span class="built_in">CURRENT_USER</span> &#125;]</span><br><span class="line">    [<span class="keyword">SQL</span> <span class="keyword">SECURITY</span> &#123; <span class="keyword">DEFINER</span> | <span class="keyword">INVOKER</span> &#125;]</span><br><span class="line"><span class="keyword">VIEW</span> view_name [(column_list)]</span><br><span class="line"><span class="keyword">AS</span> select_statement</span><br><span class="line">    [<span class="keyword">WITH</span> [CASCADED | <span class="keyword">LOCAL</span>] <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>]</span><br></pre></td></tr></table></figure>

<p><strong>注意：修改视图是指修改数据库中已存在的表的定义，当基表的某些字段发生改变时，可以通过修改视图来保持视图和基本表之间一致</strong></p>
<h3 id="3-3-DML操作更新视图"><a href="#3-3-DML操作更新视图" class="headerlink" title="3.3 DML操作更新视图"></a><strong>3.3 DML操作更新视图</strong></h3><p>因为视图本身没有数据，因此对视图进行的dml操作最终都体现在基表中　</p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img">DML更新视图</p>
<p>当然，视图的DML操作，不是所有的视图都可以做DML操作。</p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 不能做dml操作的情况</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">①<span class="keyword">select</span>子句中包含distinct</span><br><span class="line">②<span class="keyword">select</span>子句中包含组函数</span><br><span class="line">③<span class="keyword">select</span>语句中包含group by子句</span><br><span class="line">④<span class="keyword">select</span>语句中包含order by子句</span><br><span class="line">⑤<span class="keyword">select</span>语句中包含<span class="class"><span class="keyword">union</span> 、<span class="title">union</span> <span class="title">all</span>等集合运算符</span></span><br><span class="line">⑥where子句中包含相关子查询</span><br><span class="line">⑦from子句中包含多个表</span><br><span class="line">⑧如果视图中有计算列，则不能更新</span><br><span class="line">⑨如果基表中有某个具有非空约束的列未出现在视图定义中，则不能做insert操作</span><br><span class="line">不能做dml操作的情况</span><br></pre></td></tr></table></figure>



<p><strong>3.4 drop删除视图</strong></p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> [<span class="keyword">IF</span> <span class="keyword">EXISTS</span>]   </span><br><span class="line">view_name [, view_name] ...</span><br></pre></td></tr></table></figure>

<p>mysql&gt; drop view v_student;</p>
<ul>
<li><strong>注：如果视图不存在，则抛出异常；使用IF EXISTS选项使得删除不存在的视图时不抛出异常。</strong></li>
</ul>
<h2 id="4-使用WITH-CHECK-OPTION约束"><a href="#4-使用WITH-CHECK-OPTION约束" class="headerlink" title="4. 使用WITH CHECK OPTION约束"></a><strong>4. 使用WITH CHECK OPTION约束</strong></h2><p>对于可以执行DML操作的视图，定义时可以带上WITH CHECK OPTION约束</p>
<p>作用：</p>
<p>　　对视图所做的DML操作的结果，不能违反视图的WHERE条件的限制。</p>
<p>示例：创建视图，包含1960年之前出生的所有球员（老兵）</p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 创建视图示例</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create view v_veterans</span><br><span class="line">    -&gt; <span class="built_in">as</span></span><br><span class="line">    -&gt; select * from PLAYERS</span><br><span class="line">    -&gt; <span class="keyword">where</span> birth_date &lt; '<span class="number">1960</span><span class="number">-01</span><span class="number">-01</span>'</span><br><span class="line">    -&gt; <span class="built_in">with</span> check option;</span><br><span class="line">Query OK, <span class="number">0</span> rows affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from v_veterans;</span><br><span class="line">+----------+---------+----------+------------+-----+--------+----------------+---------+----------+-----------+------------+----------+</span><br><span class="line">| <span class="type">PLAYERNO</span> | <span class="type">NAME</span>    | <span class="type">INITIALS</span> | <span class="type">BIRTH_DATE</span> | <span class="type">SEX</span> | <span class="type">JOINED</span> | <span class="type">STREET</span>         | <span class="type">HOUSENO</span> | <span class="type">POSTCODE</span> | <span class="type">TOWN</span>      | <span class="type">PHONENO</span>    | <span class="type">LEAGUENO</span> |<span class="type"></span></span><br><span class="line"><span class="type">+----------+---------+----------+------------+-----+--------+----------------+---------+----------+-----------+------------+----------+</span></span><br><span class="line"><span class="type">|        2</span> | <span class="type">Everett</span> | <span class="type">R</span>        | <span class="type">1948</span><span class="number">-09</span><span class="number">-01</span> | <span class="type">M</span>   |   <span class="type">1975</span> | <span class="type">Stoney</span> Road    | <span class="type">43</span>      | <span class="type">3575NH</span>   | <span class="type">Stratford</span> | <span class="type">070</span><span class="number">-237893</span> | <span class="type">2411</span>     |<span class="type"></span></span><br><span class="line"><span class="type">|       39</span> | <span class="type">Bishop</span>  | <span class="type">D</span>        | <span class="type">1956</span><span class="number">-10</span><span class="number">-29</span> | <span class="type">M</span>   |   <span class="type">1980</span> | <span class="type">Eaton</span> Square   | <span class="type">78</span>      | <span class="type">9629CD</span>   | <span class="type">Stratford</span> | <span class="type">070</span><span class="number">-393435</span> | <span class="type">NULL</span>     |<span class="type"></span></span><br><span class="line"><span class="type">|       83</span> | <span class="type">Hope</span>    | <span class="type">PK</span>       | <span class="type">1956</span><span class="number">-11</span><span class="number">-11</span> | <span class="type">M</span>   |   <span class="type">1982</span> | <span class="type">Magdalene</span> Road | <span class="type">16A</span>     | <span class="type">1812UP</span>   | <span class="type">Stratford</span> | <span class="type">070</span><span class="number">-353548</span> | <span class="type">1608</span>     |<span class="type"></span></span><br><span class="line"><span class="type">+----------+---------+----------+------------+-----+--------+----------------+---------+----------+-----------+------------+----------+</span></span><br><span class="line"><span class="type">3</span> rows <span class="built_in">in</span> <span class="built_in">set</span> (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">创建视图示例</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> update修改视图</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; update v_veterans</span><br><span class="line">    -&gt; set BIRTH_DATE='1970<span class="string">-09</span><span class="string">-01</span>'</span><br><span class="line">    -&gt; where PLAYERNO=39;</span><br><span class="line"><span class="keyword">ERROR </span>1369 (HY000): CHECK OPTION failed 'TENNIS.v_veterans'</span><br></pre></td></tr></table></figure>

<ul>
<li>因为违反了视图中的WHERE birth_date &lt; ‘1960-01-01’子句，所以抛出异常；</li>
<li>利用with check option约束限制，保证更新视图是在该视图的权限范围之内。</li>
</ul>
<p><strong>嵌套视图</strong>：定义在另一个视图的上面的视图</p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 嵌套视图</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">create</span> <span class="keyword">view</span> v_ear_veterans</span><br><span class="line">    -&gt; <span class="keyword">as</span></span><br><span class="line">    -&gt; <span class="keyword">select</span> * <span class="keyword">from</span> v_veterans</span><br><span class="line">　　 -&gt; <span class="keyword">where</span> JOINED &lt; <span class="number">1980</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> WITH CHECK OPTION约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">使用<span class="keyword">WITH</span> <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>约束时，(不指定选项则默认是<span class="keyword">CASCADED</span>)</span><br><span class="line"></span><br><span class="line">可以使用<span class="keyword">CASCADED</span>或者 <span class="keyword">LOCAL</span>选项指定检查的程度：</span><br><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CASCADED</span> <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>：检查所有的视图</span><br><span class="line">　例如：嵌套视图及其底层的视图</span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">LOCAL</span> <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>：只检查将要更新的视图本身</span><br><span class="line">　例如：对嵌套视图不检查其底层的视图　</span><br><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>约束</span><br></pre></td></tr></table></figure>



<h2 id="5-定义视图时的其他选项"><a href="#5-定义视图时的其他选项" class="headerlink" title="5. 定义视图时的其他选项"></a><strong>5. 定义视图时的其他选项</strong></h2><p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 其它选项</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR REPLACE</span>]   </span><br><span class="line">　　[ALGORITHM = &#123;UNDEFINED | MERGE | TEMPTABLE&#125;]  </span><br><span class="line">　　[<span class="keyword">DEFINER</span> = &#123; <span class="keyword">user</span> | <span class="built_in">CURRENT_USER</span> &#125;]  </span><br><span class="line">　　[<span class="keyword">SQL</span> <span class="keyword">SECURITY</span> &#123; <span class="keyword">DEFINER</span> | <span class="keyword">INVOKER</span> &#125;]</span><br><span class="line"><span class="keyword">VIEW</span> view_name [(column_list)]  </span><br><span class="line"><span class="keyword">AS</span> select_statement  </span><br><span class="line">　　[<span class="keyword">WITH</span> [CASCADED | <span class="keyword">LOCAL</span>] <span class="keyword">CHECK</span> <span class="keyword">OPTION</span>]</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 选项说明</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、ALGORITHM选项：选择在处理定义视图的<span class="keyword">select</span>语句中使用的方法</span><br><span class="line">　　①UNDEFINED：MySQL将自动选择所要使用的算法</span><br><span class="line">　　②MERGE：将视图的语句与视图定义合并起来，使得视图定义的某一部分取代语句的对应部分</span><br><span class="line">　　③TEMPTABLE：将视图的结果存入临时表，然后使用临时表执行语句</span><br><span class="line">缺省ALGORITHM选项等同于ALGORITHM = UNDEFINED</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、<span class="keyword">DEFINER</span>选项：指出谁是视图的创建者或定义者</span><br><span class="line">　　①<span class="keyword">definer</span>= <span class="string">'用户名'</span>@<span class="string">'登录主机'</span></span><br><span class="line">　　②如果不指定该选项，则创建视图的用户就是定义者，指定关键字<span class="built_in">CURRENT_USER</span>(当前用户)和不指定该选项效果相同</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、<span class="keyword">SQL</span> <span class="keyword">SECURITY</span>选项：要查询一个视图，首先必须要具有对视图的<span class="keyword">select</span>权限。</span><br><span class="line">　　但是，如果同一个用户对于视图所访问的表没有<span class="keyword">select</span>权限，那会怎么样？</span><br><span class="line"><span class="keyword">SQL</span> <span class="keyword">SECURITY</span>选项决定执行的结果：</span><br><span class="line">　　①<span class="keyword">SQL</span> <span class="keyword">SECURITY</span> <span class="keyword">DEFINER</span>：定义(创建)视图的用户必须对视图所访问的表具有<span class="keyword">select</span>权限，也就是说将来其他用户访问表的时候以定义者的身份，此时其他用户并没有访问权限。</span><br><span class="line">　　②<span class="keyword">SQL</span> <span class="keyword">SECURITY</span> <span class="keyword">INVOKER</span>：访问视图的用户必须对视图所访问的表具有<span class="keyword">select</span>权限。</span><br><span class="line">缺省<span class="keyword">SQL</span> <span class="keyword">SECURITY</span>选项等同于<span class="keyword">SQL</span> <span class="keyword">SECURITY</span> <span class="keyword">DEFINER</span>　</span><br><span class="line"></span><br><span class="line">视图权限总结：</span><br><span class="line">　　使用root用户定义一个视图(推荐使用第一种)：u1、u2</span><br><span class="line">　　　　<span class="number">1</span>）u1作为定义者定义一个视图，u1对基表有<span class="keyword">select</span>权限，u2对视图有访问权限：u2是以定义者的身份访问可以查询到基表的内容；</span><br><span class="line">　　　　<span class="number">2</span>）u1作为定义者定义一个视图，u1对基表没有<span class="keyword">select</span>权限，u2对视图有访问权限，u2对基表有<span class="keyword">select</span>权限：u2访问视图的时候是以调用者的身份，此时调用者是u2，可以查询到基表的内容。</span><br></pre></td></tr></table></figure>



<h2 id="6-视图查询语句的处理"><a href="#6-视图查询语句的处理" class="headerlink" title="6. 视图查询语句的处理"></a><strong>6. 视图查询语句的处理</strong></h2><p>示例：所有有罚款的球员的信息</p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 创建视图</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">create</span> <span class="keyword">view</span> cost_raisers</span><br><span class="line">    -&gt; <span class="keyword">as</span></span><br><span class="line">    -&gt; <span class="keyword">select</span> * <span class="keyword">from</span> PLAYERS</span><br><span class="line">    -&gt; <span class="keyword">where</span> playerno <span class="keyword">in</span> (<span class="keyword">select</span> playerno <span class="keyword">from</span> PENALTIES);</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 查询视图</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> playerno <span class="keyword">from</span> cost_raisers</span><br><span class="line">    -&gt; <span class="keyword">where</span> town=<span class="string">'Stratford'</span>;</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">| PLAYERNO |</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">|        <span class="number">6</span> |</span><br><span class="line">+<span class="comment">----------+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 替代方法</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 先把select语句中的视图名使用定义视图的select语句来替代；</span><br><span class="line"></span><br><span class="line">　　# 再处理所得到的select语句。</span><br><span class="line"></span><br><span class="line">mysql&gt; select playerno from</span><br><span class="line">　　 -&gt; (</span><br><span class="line"><span class="code">    -&gt;   select * from PLAYERS</span></span><br><span class="line"><span class="code">    -&gt;   where playerno in-&gt;   　　(select playerno from PENALTIES)</span></span><br><span class="line"><span class="code">    -&gt; )as viewformula</span></span><br><span class="line"><span class="code">    -&gt; where town='Stratford';</span></span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">| PLAYERNO |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">|        6 |</span><br><span class="line"><span class="code">+----------+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 具体化方法</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">先处理定义视图的<span class="keyword">select</span>语句，这会生成一个中间的结果集；</span><br><span class="line">然后，再在中间结果上执行<span class="keyword">select</span>查询。</span><br><span class="line">mysql&gt; <span class="keyword">select</span> &lt;列名&gt; <span class="keyword">from</span> &lt;中间结果&gt;;</span><br></pre></td></tr></table></figure>



<h1 id="二、存储过程"><a href="#二、存储过程" class="headerlink" title="二、存储过程"></a><strong>二、存储过程</strong></h1><p>存储过程（Stored Procedure）是一种在数据库中存储复杂程序，以便外部程序调用的一种数据库对象。</p>
<p>存储过程是为了完成特定功能的SQL语句集，经编译创建并保存在数据库中，用户可通过指定存储过程的名字并给定参数(需要时)来调用执行。</p>
<p>存储过程思想上很简单，就是数据库 SQL 语言层面的代码封装与重用。</p>
<h2 id="存储过程的优点"><a href="#存储过程的优点" class="headerlink" title="存储过程的优点"></a>存储过程的优点</h2><ul>
<li>存储过程可封装，并隐藏复杂的商业逻辑。</li>
<li>存储过程可以回传值，并可以接受参数。</li>
<li>存储过程无法使用 SELECT 指令来运行，因为它是子程序，与查看表，数据表或用户定义函数不同。</li>
<li>存储过程可以用在数据检验，强制实行商业逻辑等。</li>
</ul>
<h2 id="存储过程的缺点"><a href="#存储过程的缺点" class="headerlink" title="存储过程的缺点"></a>存储过程的缺点</h2><ul>
<li>存储过程，往往定制化于特定的数据库上，因为支持的编程语言不同。当切换到其他厂商的数据库系统时，需要重写原有的存储过程。</li>
<li>存储过程的性能调校与撰写，受限于各种数据库系统。</li>
</ul>
<h2 id="1-创建存储过程"><a href="#1-创建存储过程" class="headerlink" title="1. 创建存储过程"></a>1. 创建存储过程</h2><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">sp_name</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">.........</span></span><br><span class="line"><span class="function"><span class="title">end</span></span></span><br></pre></td></tr></table></figure>



<h2 id="2-调用存储过程"><a href="#2-调用存储过程" class="headerlink" title="2. 调用存储过程"></a>2. 调用存储过程</h2><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">基本语法：<span class="variable">call</span> <span class="function"><span class="title">sp_name</span>()</span></span><br><span class="line">	</span><br><span class="line">注意：存储过程名称后面必须加括号，哪怕该存储过程没有参数传递</span><br></pre></td></tr></table></figure>



<h2 id="3-删除存储过程"><a href="#3-删除存储过程" class="headerlink" title="3. 删除存储过程"></a>3. 删除存储过程</h2><figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.基本语法：</span><br><span class="line">drop <span class="function"><span class="keyword">procedure</span> <span class="title">sp_name</span><span class="comment">//</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">2.注意事项</span></span><br><span class="line"><span class="function">不能在一个存储过程中删除另一个存储过程，只能调用另一个存储过程</span></span><br></pre></td></tr></table></figure>



<h2 id="4-其他常用命令"><a href="#4-其他常用命令" class="headerlink" title="4. 其他常用命令"></a>4. 其他常用命令</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.show procedure status</span><br><span class="line">显示[<span class="string">数据库</span>](<span class="link">http://lib.csdn.net/base/mysql</span>)中所有存储的存储过程基本信息，包括所属数据库，存储过程名称，创建时间等</span><br><span class="line"></span><br><span class="line">2.show create procedure sp_name</span><br><span class="line">显示某一个[<span class="string">MySQL</span>](<span class="link">http://lib.csdn.net/base/mysql</span>)存储过程的详细信息</span><br></pre></td></tr></table></figure>



<h2 id="5-存储过程实例"><a href="#5-存储过程实例" class="headerlink" title="5. 存储过程实例"></a>5. 存储过程实例</h2><h3 id="5-1-创建存储过程"><a href="#5-1-创建存储过程" class="headerlink" title="5.1 创建存储过程"></a>5.1 创建存储过程</h3><p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 无参数的存储过程</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 创建存储过程</span><br><span class="line">delimiter <span class="comment">//</span></span><br><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">p1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">BEGIN</span></span></span><br><span class="line"><span class="function">    <span class="title">select</span> * <span class="title">from</span> <span class="title">t1</span>;</span></span><br><span class="line"><span class="keyword">END</span><span class="comment">//</span></span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line">-- 执行存储过程</span><br><span class="line">call p1()</span><br></pre></td></tr></table></figure>

<p>对于存储过程，可以接收参数，其参数有三类：</p>
<ul>
<li>in      仅用于传入参数用</li>
<li>out     仅用于返回值用</li>
<li>inout   既可以传入又可以当作返回值</li>
</ul>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 有参数的存储过程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建存储过程</span></span><br><span class="line">delimiter \\</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> p1(</span><br><span class="line">    <span class="keyword">in</span> i1 <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">in</span> i2 <span class="built_in">int</span>,</span><br><span class="line">    inout i3 <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">out</span> r1 <span class="built_in">int</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> temp1 <span class="built_in">int</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> temp2 <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">set</span> temp1 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">set</span> r1 = i1 + i2 + temp1 + temp2;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">set</span> i3 = i3 + <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span>\\</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 执行存储过程</span></span><br><span class="line"><span class="keyword">set</span> @t1 =<span class="number">4</span>;</span><br><span class="line"><span class="keyword">set</span> @t2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">CALL</span> p1 (<span class="number">1</span>, <span class="number">2</span> ,@t1, @t2);</span><br><span class="line"><span class="keyword">SELECT</span> @t1,@t2;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 1.结果集</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">delimiter <span class="comment">//</span></span><br><span class="line">                    <span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">p1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">                    <span class="title">begin</span></span></span><br><span class="line"><span class="function">                        <span class="title">select</span> * <span class="title">from</span> <span class="title">v1</span>;</span></span><br><span class="line">                    <span class="keyword">end</span> <span class="comment">//</span></span><br><span class="line">                    delimiter ;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 2.结果集+out</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">delimiter //</span><br><span class="line">                    <span class="keyword">create</span> <span class="keyword">procedure</span> p2(</span><br><span class="line">                        <span class="keyword">in</span> n1 <span class="built_in">int</span>,</span><br><span class="line">                        inout n3 <span class="built_in">int</span>,</span><br><span class="line">                        <span class="keyword">out</span> n2 <span class="built_in">int</span>,</span><br><span class="line">                    )</span><br><span class="line">                    <span class="keyword">begin</span></span><br><span class="line">                        <span class="keyword">declare</span> temp1 <span class="built_in">int</span> ;</span><br><span class="line">                        <span class="keyword">declare</span> temp2 <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">select</span> * <span class="keyword">from</span> v1;</span><br><span class="line">                        <span class="keyword">set</span> n2 = n1 + <span class="number">100</span>;</span><br><span class="line">                        <span class="keyword">set</span> n3 = n3 + n1 + <span class="number">100</span>;</span><br><span class="line">                    <span class="keyword">end</span> //</span><br><span class="line">                    delimiter ;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 3.事务</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">delimiter \\</span><br><span class="line">                        <span class="keyword">create</span> <span class="keyword">PROCEDURE</span> p1(</span><br><span class="line">                            <span class="keyword">OUT</span> p_return_code <span class="built_in">tinyint</span></span><br><span class="line">                        )</span><br><span class="line">                        <span class="keyword">BEGIN</span> </span><br><span class="line">                          <span class="keyword">DECLARE</span> <span class="keyword">exit</span> <span class="keyword">handler</span> <span class="keyword">for</span> sqlexception </span><br><span class="line">                          <span class="keyword">BEGIN</span> </span><br><span class="line">                            <span class="comment">-- ERROR </span></span><br><span class="line">                            <span class="keyword">set</span> p_return_code = <span class="number">1</span>; </span><br><span class="line">                            <span class="keyword">rollback</span>; </span><br><span class="line">                          <span class="keyword">END</span>; </span><br><span class="line">                         </span><br><span class="line">                          <span class="keyword">DECLARE</span> <span class="keyword">exit</span> <span class="keyword">handler</span> <span class="keyword">for</span> sqlwarning </span><br><span class="line">                          <span class="keyword">BEGIN</span> </span><br><span class="line">                            <span class="comment">-- WARNING </span></span><br><span class="line">                            <span class="keyword">set</span> p_return_code = <span class="number">2</span>; </span><br><span class="line">                            <span class="keyword">rollback</span>; </span><br><span class="line">                          <span class="keyword">END</span>; </span><br><span class="line">                         </span><br><span class="line">                          <span class="keyword">START</span> <span class="keyword">TRANSACTION</span>; </span><br><span class="line">                            <span class="keyword">DELETE</span> <span class="keyword">from</span> tb1;</span><br><span class="line">                            <span class="keyword">insert</span> <span class="keyword">into</span> tb2(<span class="keyword">name</span>)<span class="keyword">values</span>(<span class="string">'seven'</span>);</span><br><span class="line">                          <span class="keyword">COMMIT</span>; </span><br><span class="line">                         </span><br><span class="line">                          <span class="comment">-- SUCCESS </span></span><br><span class="line">                          <span class="keyword">set</span> p_return_code = <span class="number">0</span>; </span><br><span class="line">                         </span><br><span class="line">                          <span class="keyword">END</span>\\</span><br><span class="line">                    delimiter ;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 4.游标</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">delimiter //</span><br><span class="line">                    <span class="keyword">create</span> <span class="keyword">procedure</span> p3()</span><br><span class="line">                    <span class="keyword">begin</span> </span><br><span class="line">                        <span class="keyword">declare</span> ssid <span class="built_in">int</span>; <span class="comment">-- 自定义变量1  </span></span><br><span class="line">                        <span class="keyword">declare</span> ssname <span class="built_in">varchar</span>(<span class="number">50</span>); <span class="comment">-- 自定义变量2  </span></span><br><span class="line">                        <span class="keyword">DECLARE</span> done <span class="built_in">INT</span> <span class="keyword">DEFAULT</span> <span class="literal">FALSE</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        <span class="keyword">DECLARE</span> my_cursor <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">select</span> <span class="keyword">sid</span>,sname <span class="keyword">from</span> student;</span><br><span class="line">                        <span class="keyword">DECLARE</span> CONTINUE <span class="keyword">HANDLER</span> <span class="keyword">FOR</span> <span class="keyword">NOT</span> <span class="keyword">FOUND</span> <span class="keyword">SET</span> done = <span class="literal">TRUE</span>;</span><br><span class="line">                        </span><br><span class="line">                        open my_cursor;</span><br><span class="line">                            xxoo: LOOP</span><br><span class="line">                                fetch my_cursor into ssid,ssname;</span><br><span class="line">                                if done then </span><br><span class="line">                                    leave xxoo;</span><br><span class="line">                                <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">                                <span class="keyword">insert</span> <span class="keyword">into</span> teacher(tname) <span class="keyword">values</span>(ssname);</span><br><span class="line">                            <span class="keyword">end</span> <span class="keyword">loop</span> xxoo;</span><br><span class="line">                        close my_cursor;</span><br><span class="line">                    <span class="keyword">end</span>  //</span><br><span class="line">                    delimter ;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 5.动态执行sql</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">delimiter \\</span><br><span class="line">                    <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> p4 (</span><br><span class="line">                        <span class="keyword">in</span> nid <span class="built_in">int</span></span><br><span class="line">                    )</span><br><span class="line">                    <span class="keyword">BEGIN</span></span><br><span class="line">                        <span class="keyword">PREPARE</span> prod <span class="keyword">FROM</span> <span class="string">'select * from student where sid &gt; ?'</span>;</span><br><span class="line">                        <span class="keyword">EXECUTE</span> prod <span class="keyword">USING</span> @nid;</span><br><span class="line">                        <span class="keyword">DEALLOCATE</span> <span class="keyword">prepare</span> prod; </span><br><span class="line">                    <span class="keyword">END</span>\\</span><br><span class="line">                    delimiter ;</span><br></pre></td></tr></table></figure>



<h3 id="5-2-删除存储过程"><a href="#5-2-删除存储过程" class="headerlink" title="5.2 删除存储过程"></a>5.2 删除存储过程</h3><figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop <span class="function"><span class="keyword">procedure</span> <span class="title">proc_name</span>;</span></span><br></pre></td></tr></table></figure>



<h3 id="5-3-执行存储过程"><a href="#5-3-执行存储过程" class="headerlink" title="5.3 执行存储过程"></a>5.3 执行存储过程</h3><p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 执行存储过程</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-- 无参数</span><br><span class="line">call proc_name()</span><br><span class="line"></span><br><span class="line">-- 有参数，全<span class="keyword">in</span></span><br><span class="line">call proc_name(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">-- 有参数，有<span class="keyword">in</span>，<span class="keyword">out</span>，<span class="keyword">inout</span></span><br><span class="line"><span class="keyword">set</span> @t1=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">set</span> @t2=<span class="number">3</span>;</span><br><span class="line">call proc_name(<span class="number">1</span>,<span class="number">2</span>,@t1,@t2)</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> pymysql执行存储过程</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">conn = pymysql.connect(<span class="attribute">host</span>=<span class="string">'127.0.0.1'</span>, <span class="attribute">port</span>=3306, <span class="attribute">user</span>=<span class="string">'root'</span>, <span class="attribute">passwd</span>=<span class="string">'123'</span>, <span class="attribute">db</span>=<span class="string">'t1'</span>)</span><br><span class="line">cursor = conn.cursor(<span class="attribute">cursor</span>=pymysql.cursors.DictCursor)</span><br><span class="line"><span class="comment"># 执行存储过程</span></span><br><span class="line">cursor.callproc(<span class="string">'p1'</span>, args=(1, 22, 3, 4))</span><br><span class="line"><span class="comment"># 获取执行完存储的参数</span></span><br><span class="line">cursor.execute(<span class="string">"select @_p1_0,@_p1_1,@_p1_2,@_p1_3"</span>)</span><br><span class="line">result = cursor.fetchall()</span><br><span class="line"></span><br><span class="line">conn.commit()</span><br><span class="line">cursor.close()</span><br><span class="line">conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span>(result)</span><br></pre></td></tr></table></figure>



<h1 id="三、触发器"><a href="#三、触发器" class="headerlink" title="三、触发器"></a><strong>三、触发器</strong></h1><p>如果希望在对某张表的增、删、改的前后进行触发某个特定的行为时，可以使用触发器来自定义操作，触发器用于定制用户对表的行进行【增/删/改】前后的行为。</p>
<h2 id="1-创建触发器"><a href="#1-创建触发器" class="headerlink" title="1. 创建触发器"></a>1. 创建触发器</h2><p>在MySQL中，创建触发器语法如下：</p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 创建触发器</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">trigger_time</span><br><span class="line">trigger_event <span class="keyword">ON</span> tbl_name</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span></span><br><span class="line">trigger_stmt</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 参数说明</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">trigger_name：标识触发器名称，用户自行指定；</span><br><span class="line">trigger_time：标识触发时机，取值为 BEFORE 或 AFTER；</span><br><span class="line">trigger_event：标识触发事件，取值为 <span class="keyword">INSERT</span>、<span class="keyword">UPDATE</span> 或 <span class="keyword">DELETE</span>；</span><br><span class="line">tbl_name：标识建立触发器的表名，即在哪张表上建立触发器；</span><br><span class="line">trigger_stmt：触发器程序体，可以是一句<span class="keyword">SQL</span>语句，或者用 <span class="keyword">BEGIN</span> 和 <span class="keyword">END</span> 包含的多条语句。</span><br><span class="line"></span><br><span class="line">由此可见，可以建立<span class="number">6</span>种触发器，即：<span class="keyword">BEFORE</span> <span class="keyword">INSERT</span>、<span class="keyword">BEFORE</span> <span class="keyword">UPDATE</span>、<span class="keyword">BEFORE</span> <span class="keyword">DELETE</span>、<span class="keyword">AFTER</span> <span class="keyword">INSERT</span>、<span class="keyword">AFTER</span> <span class="keyword">UPDATE</span>、<span class="keyword">AFTER</span> <span class="keyword">DELETE</span>。</span><br><span class="line"></span><br><span class="line">另外有一个限制是不能同时在一个表上建立<span class="number">2</span>个相同类型的触发器，因此在一个表上最多建立<span class="number">6</span>个触发器。</span><br><span class="line"></span><br><span class="line">trigger_event 详解</span><br><span class="line">MySQL 除了对 <span class="keyword">INSERT</span>、<span class="keyword">UPDATE</span>、<span class="keyword">DELETE</span> 基本操作进行定义外，还定义了 <span class="keyword">LOAD</span> <span class="keyword">DATA</span> 和 <span class="keyword">REPLACE</span> 语句，这两种语句也能引起上述<span class="number">6</span>中类型的触发器的触发。</span><br><span class="line"></span><br><span class="line"><span class="keyword">LOAD</span> <span class="keyword">DATA</span> 语句用于将一个文件装入到一个数据表中，相当与一系列的 <span class="keyword">INSERT</span> 操作。</span><br><span class="line"></span><br><span class="line"><span class="keyword">REPLACE</span> 语句一般来说和 <span class="keyword">INSERT</span> 语句很像，只是在表中有 primary <span class="keyword">key</span> 或 <span class="keyword">unique</span> 索引时，如果插入的数据和原来 primary <span class="keyword">key</span> 或 <span class="keyword">unique</span> 索引一致时，会先删除原来的数据，然后增加一条新数据，也就是说，一条 <span class="keyword">REPLACE</span> 语句有时候等价于一条。</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> 语句，有时候等价于一条 <span class="keyword">DELETE</span> 语句加上一条 <span class="keyword">INSERT</span> 语句。</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> 型触发器：插入某一行时激活触发器，可能通过 <span class="keyword">INSERT</span>、<span class="keyword">LOAD</span> <span class="keyword">DATA</span>、<span class="keyword">REPLACE</span> 语句触发；</span><br><span class="line"><span class="keyword">UPDATE</span> 型触发器：更改某一行时激活触发器，可能通过 <span class="keyword">UPDATE</span> 语句触发；</span><br><span class="line"><span class="keyword">DELETE</span> 型触发器：删除某一行时激活触发器，可能通过 <span class="keyword">DELETE</span>、<span class="keyword">REPLACE</span> 语句触发。</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span> … <span class="keyword">END</span> 详解</span><br><span class="line">在MySQL中，<span class="keyword">BEGIN</span> … <span class="keyword">END</span> 语句的语法为：</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">[statement_list]</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line">其中，statement_list 代表一个或多个语句的列表，列表内的每条语句都必须用分号（;）来结尾。</span><br><span class="line">而在MySQL中，分号是语句结束的标识符，遇到分号表示该段语句已经结束，MySQL可以开始执行了。因此，解释器遇到statement_list 中的分号后就开始执行，然后会报出错误，因为没有找到和 <span class="keyword">BEGIN</span> 匹配的 <span class="keyword">END</span>。</span><br><span class="line"></span><br><span class="line">这时就会用到 DELIMITER 命令（DELIMITER 是定界符，分隔符的意思），它是一条命令，不需要语句结束标识，语法为：</span><br><span class="line">DELIMITER new_delemiter</span><br><span class="line">new_delemiter 可以设为<span class="number">1</span>个或多个长度的符号，默认的是分号（;），我们可以把它修改为其他符号，如$：</span><br><span class="line">DELIMITER $</span><br><span class="line">在这之后的语句，以分号结束，解释器不会有什么反应，只有遇到了$，才认为是语句结束。注意，使用完之后，我们还应该记得把它给修改回来。</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 触发器示例</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设系统中有两个表：</span></span><br><span class="line"><span class="comment"># 班级表 class(班级号 classID, 班内学生数 stuCount)</span></span><br><span class="line"><span class="comment"># 学生表 student(学号 stuID, 所属班级号 classID)</span></span><br><span class="line"><span class="comment"># 要创建触发器来使班级表中的班内学生数随着学生的添加自动更新，代码如下：</span></span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> tri_stuInsert <span class="keyword">after</span> <span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> student <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">declare</span> c <span class="built_in">int</span>;</span><br><span class="line"><span class="keyword">set</span> c = (<span class="keyword">select</span> stuCount <span class="keyword">from</span> <span class="keyword">class</span> <span class="keyword">where</span> classID=new.classID);</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">class</span> <span class="keyword">set</span> stuCount = c + <span class="number">1</span> <span class="keyword">where</span> classID = new.classID;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 变量详解</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MySQL 中使用 DECLARE 来定义一局部变量，该变量只能在 BEGIN … END 复合语句中使用，并且应该定义在复合语句的开头，</span><br><span class="line"></span><br><span class="line">即其它语句之前，语法如下：</span><br><span class="line"></span><br><span class="line">DECLARE var_name[,<span class="built_in">..</span>.]<span class="built_in"> type </span>[DEFAULT value]</span><br><span class="line">其中：</span><br><span class="line">var_name 为变量名称，同 SQL 语句一样，变量名不区分大小写；type 为 MySQL 支持的任何数据类型；可以同时定义多个同类型的变量，用逗号隔开；变量初始值为 <span class="literal">NULL</span>，如果需要，可以使用<span class="built_in"> DEFAULT </span>子句提供默认值，值可以被指定为一个表达式。</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> NEW 与 OLD 详解</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">在 <span class="keyword">INSERT</span> 型触发器中，<span class="built_in">NEW</span> 用来表示将要（<span class="keyword">BEFORE</span>）或已经（<span class="keyword">AFTER</span>）插入的新数据；</span><br><span class="line">在 <span class="keyword">UPDATE</span> 型触发器中，<span class="built_in">OLD</span> 用来表示将要或已经被修改的原数据，<span class="built_in">NEW</span> 用来表示将要或已经修改为的新数据；</span><br><span class="line">在 <span class="keyword">DELETE</span> 型触发器中，<span class="built_in">OLD</span> 用来表示将要或已经被删除的原数据；</span><br><span class="line">使用方法： <span class="built_in">NEW</span>.columnName （columnName 为相应数据表某一列名）</span><br><span class="line">另外，<span class="built_in">OLD</span> 是只读的，而 <span class="built_in">NEW</span> 则可以在触发器中使用 <span class="keyword">SET</span> 赋值，这样不会再次触发触发器，造成循环调用（如每插入一个学生前，都在其学号前加“<span class="number">2013</span>”）。</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 变量赋值</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">SET</span> var_name = expr [,var_name = expr] <span class="built_in">..</span>.</span><br></pre></td></tr></table></figure>



<h2 id="2-查看触发器"><a href="#2-查看触发器" class="headerlink" title="2. 查看触发器"></a>2. 查看触发器</h2><p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 查看触发器</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS [<span class="keyword">FROM</span> <span class="built_in">schema_name</span>];</span><br><span class="line"># 其中，<span class="built_in">schema_name</span> 即 <span class="keyword">Schema</span> 的名称，在 MySQL 中 <span class="keyword">Schema</span> 和 <span class="keyword">Database</span> 是一样的，也就是说，可以指定数据库名，这样就</span><br><span class="line"># 不必先“USE database_name;”了。</span><br></pre></td></tr></table></figure>



<h2 id="3-删除触发器"><a href="#3-删除触发器" class="headerlink" title="3. 删除触发器"></a>3. 删除触发器</h2><p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 删除触发器</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> [<span class="keyword">IF</span> <span class="keyword">EXISTS</span>] [<span class="built_in">schema_name</span>.]trigger_name</span><br></pre></td></tr></table></figure>



<h2 id="4-触发器的执行顺序"><a href="#4-触发器的执行顺序" class="headerlink" title="4. 触发器的执行顺序"></a>4. 触发器的执行顺序</h2><p>我们建立的数据库一般都是 InnoDB 数据库，其上建立的表是事务性表，也就是事务安全的。这时，若SQL语句或触发器执行失败，MySQL 会回滚事务，有：</p>
<ul>
<li>如果 BEFORE 触发器执行失败，SQL 无法正确执行。</li>
<li>SQL 执行失败时，AFTER 型触发器不会触发。</li>
<li>AFTER 类型的触发器执行失败，SQL 会回滚。</li>
</ul>
<h1 id="四、索引"><a href="#四、索引" class="headerlink" title="四、索引"></a>四、索引</h1><h2 id="1-索引简介："><a href="#1-索引简介：" class="headerlink" title="1. 索引简介："></a>1. 索引简介：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">索引是表的目录，在查找内容之前可以先在目录中查找索引位置，以此快速定位查询数据。对于索引，会保存在额外的文件中。</span><br></pre></td></tr></table></figure>



<h2 id="2-索引作用："><a href="#2-索引作用：" class="headerlink" title="2. 索引作用："></a>2. 索引作用：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">加速查找+约束</span><br></pre></td></tr></table></figure>



<h2 id="3-索引种类："><a href="#3-索引种类：" class="headerlink" title="3. 索引种类："></a>3. 索引种类：</h2><p>主键索引：加速查找、不重复、非空</p>
<p>唯一索引：加速查找、不重复</p>
<p>普通索引：加速查找</p>
<p>联合索引：加速查找</p>
<p>联合唯一索引：加速查找、不重复</p>
<p>PS：联合索引遵循最左前缀原则</p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 例子</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">id name pwd email   假设name,pwd,email　　建立联合索引</span><br><span class="line">select * <span class="keyword">from</span> <span class="attribute">name</span>=<span class="string">'xx'</span>;　　　　命中索引</span><br><span class="line">select * <span class="keyword">from</span> <span class="attribute">name</span>=<span class="string">'xx'</span> <span class="keyword">and</span> <span class="attribute">pwd</span>=<span class="string">'123'</span>;　　命中索引</span><br><span class="line">select * <span class="keyword">from</span> <span class="attribute">name</span>=<span class="string">'xx'</span> <span class="keyword">and</span> <span class="attribute">pwd</span>=<span class="string">'123'</span> <span class="keyword">and</span> <span class="attribute">email</span>=<span class="string">'qq'</span>;　　命中索引</span><br><span class="line">select * <span class="keyword">from</span> <span class="attribute">name</span>=<span class="string">'xx'</span> <span class="keyword">and</span> <span class="attribute">emai</span>=<span class="string">'qq'</span>;　　　　命中索引</span><br><span class="line">select * <span class="keyword">from</span> <span class="attribute">email</span>=<span class="string">'qq'</span> <span class="keyword">and</span> <span class="attribute">pwd</span>=<span class="string">'123'</span>;　　不能命中索引</span><br></pre></td></tr></table></figure>

<p>覆盖索引：select的数据列只用从索引中就能够取得，不必读取数据行，换句话说查询列要被所建的索引覆盖,如索引为name，也仅查找name列</p>
<p>索引合并：使用多个单列索引去查找数据，如name和age 都为索引，使用name和age联合查询</p>
<h2 id="4-创建索引语法"><a href="#4-创建索引语法" class="headerlink" title="4. 创建索引语法"></a>4. 创建索引语法</h2><p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 创建索引语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建表时</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名 (</span><br><span class="line">字段名<span class="number">1</span> 数据类型 [完整性约束条件…],</span><br><span class="line">字段名<span class="number">2</span> 数据类型 [完整性约束条件…],</span><br><span class="line">[<span class="keyword">UNIQUE</span> | FULLTEXT | SPATIAL ] <span class="keyword">INDEX</span> | <span class="keyword">KEY</span></span><br><span class="line">[索引名] (字段名[(长度)] [<span class="keyword">ASC</span> |<span class="keyword">DESC</span>])</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 实例</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test2(</span><br><span class="line">　　<span class="keyword">id</span> <span class="built_in">INT</span>,</span><br><span class="line">　　<span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">　　<span class="keyword">INDEX</span> index_name (<span class="keyword">name</span>)</span><br><span class="line">　　);</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 添加索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---CREATE在已存在的表上创建索引</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span> | FULLTEXT | SPATIAL ] <span class="keyword">INDEX</span> 索引名</span><br><span class="line"><span class="keyword">ON</span> 表名 (字段名[(长度)] [<span class="keyword">ASC</span> |<span class="keyword">DESC</span>]) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">---ALTER TABLE在已存在的表上创建索引</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> [<span class="keyword">UNIQUE</span> | FULLTEXT | SPATIAL ] <span class="keyword">INDEX</span></span><br><span class="line">索引名 (字段名[(长度)] [<span class="keyword">ASC</span> |<span class="keyword">DESC</span>]) ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> index_emp_name <span class="keyword">on</span> emp1(<span class="keyword">name</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp2 <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> index_bank_num(band_num);</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 删除索引</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 语法：<span class="keyword">DROP</span> <span class="keyword">INDEX</span> 索引名 <span class="keyword">on</span> 表名</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> index_emp_name <span class="keyword">on</span> emp1;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> bank_num <span class="keyword">on</span> emp2;</span><br></pre></td></tr></table></figure>



<h2 id="5-索引测试实验"><a href="#5-索引测试实验" class="headerlink" title="5. 索引测试实验"></a><strong>5. 索引测试实验</strong></h2><p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 实验1</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t1(id <span class="type">int</span>,<span class="type">name</span> <span class="type">varchar</span>(<span class="number">20</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--存储过程</span></span><br><span class="line"><span class="keyword">delimiter</span> $$</span><br><span class="line"><span class="pgsql"><span class="keyword">create</span> <span class="keyword">procedure</span> autoinsert() </span></span><br><span class="line"><span class="pgsql"><span class="keyword">BEGIN</span></span></span><br><span class="line"><span class="pgsql"><span class="keyword">declare</span> i <span class="type">int</span> <span class="keyword">default</span> <span class="number">1</span>;</span></span><br><span class="line"><span class="pgsql"><span class="keyword">while</span>(i&lt;<span class="number">5000</span>)<span class="keyword">do</span></span></span><br><span class="line"><span class="pgsql"><span class="keyword">insert</span> <span class="keyword">into</span> t1 <span class="keyword">values</span>(i,<span class="string">'yuan'</span>);</span></span><br><span class="line"><span class="pgsql"><span class="keyword">set</span> i=i+<span class="number">1</span>;</span></span><br><span class="line"><span class="pgsql"><span class="keyword">end</span> <span class="keyword">while</span>;</span></span><br><span class="line"><span class="ruby"><span class="keyword">END</span>$$</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delimiter</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">--调用函数</span></span><br><span class="line"><span class="keyword">call</span> autoinsert();</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 花费时间比较：</span></span><br><span class="line"><span class="comment">-- 创建索引前</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t1 <span class="keyword">where</span> id=<span class="number">300000</span>;<span class="comment">--0.32s</span></span><br><span class="line"><span class="comment">-- 添加索引 </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> index_id <span class="keyword">on</span> t1(id);</span><br><span class="line"><span class="comment">-- 创建索引后</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> Indexdb.t1 <span class="keyword">where</span> id=<span class="number">300000</span>;<span class="comment">--0.00s</span></span><br><span class="line"><span class="comment">--删除索引 </span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">index</span> index_id <span class="keyword">on</span> t1;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 实验2</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">use crawed;</span><br><span class="line">desc doutula;</span><br><span class="line">select count(<span class="strong">*) from doutula;</span></span><br><span class="line"><span class="strong">+----------+</span></span><br><span class="line"><span class="strong">| count(*</span>) |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">| 27308 |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">select name from doutula where name like <span class="emphasis">'%坏蛋%'</span>;</span><br><span class="line">--34 rows in set (0.53 sec)</span><br><span class="line">create index index<span class="emphasis">_name on doutula (name);</span></span><br><span class="line"><span class="emphasis">select name from doutula where name like '%坏蛋%';</span></span><br><span class="line"><span class="emphasis">--34 rows in set (0.05 sec)</span></span><br></pre></td></tr></table></figure>



<h2 id="6-正确使用索引"><a href="#6-正确使用索引" class="headerlink" title="6. 正确使用索引"></a><strong>6. 正确使用索引</strong></h2><p>　　数据库表中添加索引后确实会让查询速度起飞，但前提必须是正确的使用索引来查询，如果以错误的方式使用，则即使建立索引也会不奏效。<br>即使建立索引，索引也不会生效：</p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 无法命中索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">like '%xx'</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'%cn'</span>;</span><br><span class="line">- 使用函数</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> <span class="keyword">reverse</span>(<span class="keyword">name</span>) = <span class="string">'wupeiqi'</span>;</span><br><span class="line">- or</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> nid = <span class="number">1</span> <span class="keyword">or</span> email = <span class="string">'seven@live.com'</span>;</span><br><span class="line">    特别的：当or条件中有未建立索引的列才失效，以下会走索引</span><br><span class="line">            <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> nid = <span class="number">1</span> <span class="keyword">or</span> <span class="keyword">name</span> = <span class="string">'seven'</span>;</span><br><span class="line">            <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> nid = <span class="number">1</span> <span class="keyword">or</span> email = <span class="string">'seven@live.com'</span> <span class="keyword">and</span> <span class="keyword">name</span> = <span class="string">'alex'</span></span><br><span class="line">- 类型不一致</span><br><span class="line">    如果列是字符串类型，传入条件是必须用引号引起来，不然...</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> <span class="keyword">name</span> = <span class="number">999</span>;</span><br><span class="line">- !=</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> <span class="keyword">name</span> != <span class="string">'alex'</span></span><br><span class="line">    特别的：如果是主键，则还是会走索引</span><br><span class="line">        <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> nid != <span class="number">123</span></span><br><span class="line">- &gt;</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> <span class="keyword">name</span> &gt; <span class="string">'alex'</span></span><br><span class="line">    特别的：如果是主键或索引是整数类型，则还是会走索引</span><br><span class="line">        <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> nid &gt; <span class="number">123</span></span><br><span class="line">        <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">where</span> <span class="keyword">num</span> &gt; <span class="number">123</span></span><br><span class="line">- <span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line">    <span class="keyword">select</span> email <span class="keyword">from</span> tb1 <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">name</span> <span class="keyword">desc</span>;</span><br><span class="line">    当根据索引排序时候，选择的映射如果不是索引，则不走索引</span><br><span class="line">    特别的：如果对主键排序，则还是走索引：</span><br><span class="line">        <span class="keyword">select</span> * <span class="keyword">from</span> tb1 <span class="keyword">order</span> <span class="keyword">by</span> nid <span class="keyword">desc</span>;</span><br><span class="line"> </span><br><span class="line">- 组合索引最左前缀</span><br><span class="line">    如果组合索引为：(name,email)</span><br><span class="line">    name and email       <span class="comment">-- 使用索引</span></span><br><span class="line">    name                 <span class="comment">-- 使用索引</span></span><br><span class="line">    email                <span class="comment">-- 不使用索引</span></span><br></pre></td></tr></table></figure>



<h1 id="五、函数"><a href="#五、函数" class="headerlink" title="五、函数"></a>五、函数</h1><p><strong>mysql提供了许多内置函数</strong></p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 内置函数</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="constructor">CHAR_LENGTH(<span class="params">str</span>)</span></span><br><span class="line">        返回值为字符串str 的长度，长度的单位为字符。一个多字节字符算作一个单字符。</span><br><span class="line">        对于一个包含五个二字节字符集, <span class="constructor">LENGTH()</span>返回值为 <span class="number">10</span>, 而<span class="constructor">CHAR_LENGTH()</span>的返回值为<span class="number">5</span>。</span><br><span class="line"></span><br><span class="line">    <span class="constructor">CONCAT(<span class="params">str1</span>,<span class="params">str2</span>,<span class="operator">...</span>)</span></span><br><span class="line">        字符串拼接</span><br><span class="line">        如有任何一个参数为NULL ，则返回值为 NULL。</span><br><span class="line">    <span class="constructor">CONCAT_WS(<span class="params">separator</span>,<span class="params">str1</span>,<span class="params">str2</span>,<span class="operator">...</span>)</span></span><br><span class="line">        字符串拼接（自定义连接符）</span><br><span class="line">        <span class="constructor">CONCAT_WS()</span>不会忽略任何空字符串。 (然而会忽略所有的 NULL）。</span><br><span class="line"></span><br><span class="line">    <span class="constructor">CONV(N,<span class="params">from_base</span>,<span class="params">to_base</span>)</span></span><br><span class="line">        进制转换</span><br><span class="line">        例如：</span><br><span class="line">            SELECT <span class="constructor">CONV('<span class="params">a</span>',16,2)</span>; 表示将 a 由<span class="number">16</span>进制转换为<span class="number">2</span>进制字符串表示</span><br><span class="line"></span><br><span class="line">    <span class="constructor">FORMAT(X,D)</span></span><br><span class="line">        将数字X 的格式写为'#,###,###.##',以四舍五入的方式保留小数点后 D 位， 并将结果以字符串的形式返回。若  D 为 <span class="number">0</span>, 则返回结果不带有小数点，或不含小数部分。</span><br><span class="line">        例如：</span><br><span class="line">            SELECT <span class="constructor">FORMAT(12332.1,4)</span>; 结果为： '<span class="number">12</span>,<span class="number">332.1000</span>'</span><br><span class="line">    <span class="constructor">INSERT(<span class="params">str</span>,<span class="params">pos</span>,<span class="params">len</span>,<span class="params">newstr</span>)</span></span><br><span class="line">        在str的指定位置插入字符串</span><br><span class="line">            pos：要替换位置其实位置</span><br><span class="line">            len：替换的长度</span><br><span class="line">            newstr：新字符串</span><br><span class="line">        特别的：</span><br><span class="line">            如果pos超过原字符串长度，则返回原字符串</span><br><span class="line">            如果len超过原字符串长度，则由新字符串完全替换</span><br><span class="line">    <span class="constructor">INSTR(<span class="params">str</span>,<span class="params">substr</span>)</span></span><br><span class="line">        返回字符串 str 中子字符串的第一个出现位置。</span><br><span class="line"></span><br><span class="line">    <span class="constructor">LEFT(<span class="params">str</span>,<span class="params">len</span>)</span></span><br><span class="line">        返回字符串str 从开始的len位置的子序列字符。</span><br><span class="line"></span><br><span class="line">    <span class="constructor">LOWER(<span class="params">str</span>)</span></span><br><span class="line">        变小写</span><br><span class="line"></span><br><span class="line">    <span class="constructor">UPPER(<span class="params">str</span>)</span></span><br><span class="line">        变大写</span><br><span class="line"></span><br><span class="line">    <span class="constructor">LTRIM(<span class="params">str</span>)</span></span><br><span class="line">        返回字符串 str ，其引导空格字符被删除。</span><br><span class="line">    <span class="constructor">RTRIM(<span class="params">str</span>)</span></span><br><span class="line">        返回字符串 str ，结尾空格字符被删去。</span><br><span class="line">    <span class="constructor">SUBSTRING(<span class="params">str</span>,<span class="params">pos</span>,<span class="params">len</span>)</span></span><br><span class="line">        获取字符串子序列</span><br><span class="line"></span><br><span class="line">    <span class="constructor">LOCATE(<span class="params">substr</span>,<span class="params">str</span>,<span class="params">pos</span>)</span></span><br><span class="line">        获取子序列索引位置</span><br><span class="line"></span><br><span class="line">    <span class="constructor">REPEAT(<span class="params">str</span>,<span class="params">count</span>)</span></span><br><span class="line">        返回一个由重复的字符串str 组成的字符串，字符串str的数目等于count 。</span><br><span class="line">        若 count &lt;= <span class="number">0</span>,则返回一个空字符串。</span><br><span class="line">        若str 或 count 为 NULL，则返回 NULL 。</span><br><span class="line">    <span class="constructor">REPLACE(<span class="params">str</span>,<span class="params">from_str</span>,<span class="params">to_str</span>)</span></span><br><span class="line">        返回字符串str 以及所有被字符串to_str替代的字符串from_str 。</span><br><span class="line">    <span class="constructor">REVERSE(<span class="params">str</span>)</span></span><br><span class="line">        返回字符串 str ，顺序和字符顺序相反。</span><br><span class="line">    <span class="constructor">RIGHT(<span class="params">str</span>,<span class="params">len</span>)</span></span><br><span class="line">        从字符串str 开始，返回从后边开始len个字符组成的子序列</span><br><span class="line"></span><br><span class="line">    <span class="constructor">SPACE(N)</span></span><br><span class="line">        返回一个由N空格组成的字符串。</span><br><span class="line"></span><br><span class="line">    <span class="constructor">SUBSTRING(<span class="params">str</span>,<span class="params">pos</span>)</span> , <span class="constructor">SUBSTRING(<span class="params">str</span> FROM <span class="params">pos</span>)</span> <span class="constructor">SUBSTRING(<span class="params">str</span>,<span class="params">pos</span>,<span class="params">len</span>)</span> , <span class="constructor">SUBSTRING(<span class="params">str</span> FROM <span class="params">pos</span> FOR <span class="params">len</span>)</span></span><br><span class="line">        不带有len 参数的格式从字符串str返回一个子字符串，起始于位置 pos。带有len参数的格式从字符串str返回一个长度同len字符相同的子字符串，起始于位置 pos。 使用 FROM的格式为标准 SQL 语法。也可能对pos使用一个负值。假若这样，则子字符串的位置起始于字符串结尾的pos 字符，而不是字符串的开头位置。在以下格式的函数中可以对pos 使用一个负值。</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">SUBSTRING('Quadratically',5)</span>;</span><br><span class="line">            -&gt; 'ratically'</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">SUBSTRING('<span class="params">foobarbar</span>' FROM 4)</span>;</span><br><span class="line">            -&gt; 'barbar'</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">SUBSTRING('Quadratically',5,6)</span>;</span><br><span class="line">            -&gt; 'ratica'</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">SUBSTRING('Sakila', -3)</span>;</span><br><span class="line">            -&gt; 'ila'</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">SUBSTRING('Sakila', -5, 3)</span>;</span><br><span class="line">            -&gt; 'aki'</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">SUBSTRING('Sakila' FROM -4 FOR 2)</span>;</span><br><span class="line">            -&gt; 'ki'</span><br><span class="line"></span><br><span class="line">    <span class="constructor">TRIM([&#123;BOTH | LEADING | TRAILING&#125; [<span class="params">remstr</span>] FROM] <span class="params">str</span>)</span> <span class="constructor">TRIM(<span class="params">remstr</span> FROM] <span class="params">str</span>)</span></span><br><span class="line">        返回字符串 str ， 其中所有remstr 前缀和/或后缀都已被删除。若分类符BOTH、LEADIN或TRAILING中没有一个是给定的,则假设为BOTH 。 remstr 为可选项，在未指定情况下，可删除空格。</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">TRIM('  <span class="params">bar</span>   ')</span>;</span><br><span class="line">                -&gt; 'bar'</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">TRIM(LEADING '<span class="params">x</span>' FROM '<span class="params">xxxbarxxx</span>')</span>;</span><br><span class="line">                -&gt; 'barxxx'</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">TRIM(BOTH '<span class="params">x</span>' FROM '<span class="params">xxxbarxxx</span>')</span>;</span><br><span class="line">                -&gt; 'bar'</span><br><span class="line"></span><br><span class="line">        mysql&gt; SELECT <span class="constructor">TRIM(TRAILING '<span class="params">xyz</span>' FROM '<span class="params">barxxyz</span>')</span>;</span><br><span class="line">                -&gt; 'barx'</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 1.自定义函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">delimiter \\</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> f1(</span><br><span class="line">    i1 <span class="built_in">int</span>,</span><br><span class="line">    i2 <span class="built_in">int</span>)</span><br><span class="line"><span class="keyword">returns</span> <span class="built_in">int</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">declare</span> <span class="keyword">num</span> <span class="built_in">int</span>;</span><br><span class="line">    <span class="keyword">set</span> <span class="keyword">num</span> = i1 + i2;</span><br><span class="line">    return(num);</span><br><span class="line"><span class="keyword">END</span> \\</span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 2.删除函数</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">function</span> func_name;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 3.执行函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取返回值</span></span><br><span class="line"><span class="keyword">declare</span> @i <span class="built_in">VARCHAR</span>(<span class="number">32</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">UPPER</span>(<span class="string">'alex'</span>) <span class="keyword">into</span> @i;</span><br><span class="line"><span class="keyword">SELECT</span> @i;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在查询中使用</span></span><br><span class="line"><span class="keyword">select</span> f1(<span class="number">11</span>,nid) ,<span class="keyword">name</span> <span class="keyword">from</span> tb2;</span><br></pre></td></tr></table></figure>

<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 常用函数</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select concat(<span class="emphasis">'M'</span>,<span class="emphasis">'y'</span>,<span class="emphasis">'SQL'</span>);</span><br><span class="line"><span class="code">+-----------------------+</span></span><br><span class="line">| concat(<span class="emphasis">'M'</span>,<span class="emphasis">'y'</span>,<span class="emphasis">'SQL'</span>) |</span><br><span class="line"><span class="code">+-----------------------+</span></span><br><span class="line">| MySQL                 |</span><br><span class="line"><span class="code">+-----------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select concat(<span class="emphasis">'M'</span>,<span class="emphasis">'y'</span>,<span class="emphasis">'SQL'</span>,<span class="emphasis">'5.7'</span>);</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">| concat(<span class="emphasis">'M'</span>,<span class="emphasis">'y'</span>,<span class="emphasis">'SQL'</span>,<span class="emphasis">'5.7'</span>) |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">| MySQL5.7                    |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select concat(<span class="emphasis">'M'</span>,<span class="emphasis">'y'</span>,<span class="emphasis">'SQL'</span>,' 5.7');</span><br><span class="line"><span class="code">+------------------------------+</span></span><br><span class="line">| concat(<span class="emphasis">'M'</span>,<span class="emphasis">'y'</span>,<span class="emphasis">'SQL'</span>,' 5.7') |</span><br><span class="line"><span class="code">+------------------------------+</span></span><br><span class="line">| MySQL 5.7                    |</span><br><span class="line"><span class="code">+------------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT concat<span class="emphasis">_ws("-",'2012','09');</span></span><br><span class="line"><span class="emphasis">+----------------------------+</span></span><br><span class="line"><span class="emphasis">| concat_</span>ws("-",<span class="emphasis">'2012'</span>,<span class="emphasis">'09'</span>) |</span><br><span class="line"><span class="code">+----------------------------+</span></span><br><span class="line">| 2012-09                    |</span><br><span class="line"><span class="code">+----------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT concat<span class="emphasis">_ws(":",'2012','09');</span></span><br><span class="line"><span class="emphasis">+----------------------------+</span></span><br><span class="line"><span class="emphasis">| concat_</span>ws(":",<span class="emphasis">'2012'</span>,<span class="emphasis">'09'</span>) |</span><br><span class="line"><span class="code">+----------------------------+</span></span><br><span class="line">| 2012:09                    |</span><br><span class="line"><span class="code">+----------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT concat<span class="emphasis">_ws("-:",'2012','09');</span></span><br><span class="line"><span class="emphasis">+-----------------------------+</span></span><br><span class="line"><span class="emphasis">| concat_</span>ws("-:",<span class="emphasis">'2012'</span>,<span class="emphasis">'09'</span>) |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">| 2012-:09                    |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT concat<span class="emphasis">_ws(":-",'2012','09');</span></span><br><span class="line"><span class="emphasis">+-----------------------------+</span></span><br><span class="line"><span class="emphasis">| concat_</span>ws(":-",<span class="emphasis">'2012'</span>,<span class="emphasis">'09'</span>) |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">| 2012:-09                    |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT concat<span class="emphasis">_ws(null,'2012','09');</span></span><br><span class="line"><span class="emphasis">+-----------------------------+</span></span><br><span class="line"><span class="emphasis">| concat_</span>ws(null,<span class="emphasis">'2012'</span>,<span class="emphasis">'09'</span>) |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">| NULL                        |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select concat(1,2);</span><br><span class="line"><span class="code">+-------------+</span></span><br><span class="line">| concat(1,2) |</span><br><span class="line"><span class="code">+-------------+</span></span><br><span class="line">| 12          |</span><br><span class="line"><span class="code">+-------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select strcmp(<span class="emphasis">'ac'</span>,<span class="emphasis">'ac'</span>);</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">| strcmp(<span class="emphasis">'ac'</span>,<span class="emphasis">'ac'</span>) |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">|                 0 |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">1 row in set (0.06 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select strcmp(<span class="emphasis">'ab'</span>,<span class="emphasis">'ac'</span>);</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">| strcmp(<span class="emphasis">'ab'</span>,<span class="emphasis">'ac'</span>) |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">|                -1 |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select strcmp(<span class="emphasis">'ac'</span>,<span class="emphasis">'ab'</span>);</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">| strcmp(<span class="emphasis">'ac'</span>,<span class="emphasis">'ab'</span>) |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">|                 1 |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; help length;</span><br><span class="line">Name: <span class="emphasis">'LENGTH'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">LENGTH(str)</span><br><span class="line"></span><br><span class="line">Returns the length of the string str, measured in bytes. A multibyte</span><br><span class="line">character counts as multiple bytes. This means that for a string</span><br><span class="line">containing five 2-byte characters, LENGTH() returns 10, whereas</span><br><span class="line">CHAR<span class="emphasis">_LENGTH() returns 5.</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">URL: http://dev.mysql.com/doc/refman/5.7/en/string-functions.html</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">Examples:</span></span><br><span class="line"><span class="emphasis">mysql&gt; SELECT LENGTH('text');</span></span><br><span class="line"><span class="emphasis">        -&gt; 4</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select length('1 2');</span></span><br><span class="line"><span class="emphasis">+---------------+</span></span><br><span class="line"><span class="emphasis">| length('1 2') |</span></span><br><span class="line"><span class="emphasis">+---------------+</span></span><br><span class="line"><span class="emphasis">|             3 |</span></span><br><span class="line"><span class="emphasis">+---------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select length('1 2 ');</span></span><br><span class="line"><span class="emphasis">+----------------+</span></span><br><span class="line"><span class="emphasis">| length('1 2 ') |</span></span><br><span class="line"><span class="emphasis">+----------------+</span></span><br><span class="line"><span class="emphasis">|              4 |</span></span><br><span class="line"><span class="emphasis">+----------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select length(' 1 2 ');</span></span><br><span class="line"><span class="emphasis">+-----------------+</span></span><br><span class="line"><span class="emphasis">| length(' 1 2 ') |</span></span><br><span class="line"><span class="emphasis">+-----------------+</span></span><br><span class="line"><span class="emphasis">|               5 |</span></span><br><span class="line"><span class="emphasis">+-----------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; help charlength;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">Nothing found</span></span><br><span class="line"><span class="emphasis">Please try to run 'help contents' for a list of all accessible topics</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; help char_</span>length;</span><br><span class="line">Name: <span class="emphasis">'CHAR_LENGTH'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">CHAR<span class="emphasis">_LENGTH(str)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">Returns the length of the string str, measured in characters. A</span></span><br><span class="line"><span class="emphasis">multibyte character counts as a single character. This means that for a</span></span><br><span class="line"><span class="emphasis">string containing five 2-byte characters, LENGTH() returns 10, whereas</span></span><br><span class="line"><span class="emphasis">CHAR_</span>LENGTH() returns 5.</span><br><span class="line"></span><br><span class="line">URL: http://dev.mysql.com/doc/refman/5.7/en/string-functions.html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select char<span class="emphasis">_length(hello world);</span></span><br><span class="line"><span class="emphasis">ERROR 1583 (42000): Incorrect parameters in the call to native function 'char_</span>le</span><br><span class="line">ngth'</span><br><span class="line">mysql&gt; select char<span class="emphasis">_length('hello world');</span></span><br><span class="line"><span class="emphasis">+----------------------------+</span></span><br><span class="line"><span class="emphasis">| char_</span>length(<span class="emphasis">'hello world'</span>) |</span><br><span class="line"><span class="code">+----------------------------+</span></span><br><span class="line">|                         11 |</span><br><span class="line"><span class="code">+----------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; select upper(<span class="emphasis">'ADSDAsdadsf'</span>);</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">| upper(<span class="emphasis">'ADSDAsdadsf'</span>) |</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">| ADSDASDADSF          |</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">1 row in set (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select ucase(<span class="emphasis">'ADSs'</span>);</span><br><span class="line"><span class="code">+---------------+</span></span><br><span class="line">| ucase(<span class="emphasis">'ADSs'</span>) |</span><br><span class="line"><span class="code">+---------------+</span></span><br><span class="line">| ADSS          |</span><br><span class="line"><span class="code">+---------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select lower(<span class="emphasis">'ADSs'</span>);</span><br><span class="line"><span class="code">+---------------+</span></span><br><span class="line">| lower(<span class="emphasis">'ADSs'</span>) |</span><br><span class="line"><span class="code">+---------------+</span></span><br><span class="line">| adss          |</span><br><span class="line"><span class="code">+---------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select find<span class="emphasis">_in_</span>set(<span class="emphasis">'MySQL'</span>,<span class="emphasis">'a,b,c,MySQL'</span>);</span><br><span class="line"><span class="code">+------------------------------------+</span></span><br><span class="line">| find<span class="emphasis">_in_</span>set(<span class="emphasis">'MySQL'</span>,<span class="emphasis">'a,b,c,MySQL'</span>) |</span><br><span class="line"><span class="code">+------------------------------------+</span></span><br><span class="line">|                                  4 |</span><br><span class="line"><span class="code">+------------------------------------+</span></span><br><span class="line">1 row in set (0.08 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; help field;</span><br><span class="line">Name: <span class="emphasis">'FIELD'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">FIELD(str,str1,str2,str3,...)</span><br><span class="line"></span><br><span class="line">Returns the index (position) of str in the str1, str2, str</span><br><span class="line">Returns 0 if str is not found.</span><br><span class="line"></span><br><span class="line">If all arguments to FIELD() are strings, all arguments are</span><br><span class="line">strings. If all arguments are numbers, they are compared a</span><br><span class="line">Otherwise, the arguments are compared as double.</span><br><span class="line"></span><br><span class="line">If str is NULL, the return value is 0 because NULL fails e</span><br><span class="line">comparison with any value. FIELD() is the complement of EL</span><br><span class="line"></span><br><span class="line">URL: http://dev.mysql.com/doc/refman/5.7/en/string-functio</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">mysql&gt; SELECT FIELD(<span class="emphasis">'ej'</span>, <span class="emphasis">'Hej'</span>, <span class="emphasis">'ej'</span>, <span class="emphasis">'Heja'</span>, <span class="emphasis">'hej'</span>, <span class="emphasis">'foo</span></span><br><span class="line"><span class="emphasis">        -&gt; 2</span></span><br><span class="line"><span class="emphasis">mysql&gt; SELECT FIELD('</span>fo', <span class="emphasis">'Hej'</span>, <span class="emphasis">'ej'</span>, <span class="emphasis">'Heja'</span>, <span class="emphasis">'hej'</span>, <span class="emphasis">'foo</span></span><br><span class="line"><span class="emphasis">        -&gt; 0</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; SELECT FIELD('</span>ej', <span class="emphasis">'Hej'</span>, <span class="emphasis">'ej'</span>, <span class="emphasis">'Heja'</span>, <span class="emphasis">'hej'</span>, <span class="emphasis">'foo</span></span><br><span class="line"><span class="emphasis">+------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| FIELD('</span>ej', <span class="emphasis">'Hej'</span>, <span class="emphasis">'ej'</span>, <span class="emphasis">'Heja'</span>, <span class="emphasis">'hej'</span>, <span class="emphasis">'foo'</span>) |</span><br><span class="line"><span class="code">+------------------------------------------------+</span></span><br><span class="line">|                                              2 |</span><br><span class="line"><span class="code">+------------------------------------------------+</span></span><br><span class="line">1 row in set (0.05 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select left("2013-09-28 23:58:54");</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax;</span><br><span class="line">corresponds to your MySQL server version for the right syn</span><br><span class="line"><span class="code"> line 1</span></span><br><span class="line">mysql&gt; select left("2013-09-28 23:58:54","10");</span><br><span class="line"><span class="code">+----------------------------------+</span></span><br><span class="line">| left("2013-09-28 23:58:54","10") |</span><br><span class="line"><span class="code">+----------------------------------+</span></span><br><span class="line">| 2013-09-28                       |</span><br><span class="line"><span class="code">+----------------------------------+</span></span><br><span class="line">1 row in set (0.04 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select right("2013-09-28 23:58:54","10");</span><br><span class="line"><span class="code">+-----------------------------------+</span></span><br><span class="line">| right("2013-09-28 23:58:54","10") |</span><br><span class="line"><span class="code">+-----------------------------------+</span></span><br><span class="line">| 8 23:58:54                        |</span><br><span class="line"><span class="code">+-----------------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select right("2013-09-28 23:58:54",10);</span><br><span class="line"><span class="code">+---------------------------------+</span></span><br><span class="line">| right("2013-09-28 23:58:54",10) |</span><br><span class="line"><span class="code">+---------------------------------+</span></span><br><span class="line">| 8 23:58:54                      |</span><br><span class="line"><span class="code">+---------------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select substring("this is test string",6,2);</span><br><span class="line"><span class="code">+--------------------------------------+</span></span><br><span class="line">| substring("this is test string",6,2) |</span><br><span class="line"><span class="code">+--------------------------------------+</span></span><br><span class="line">| is                                   |</span><br><span class="line"><span class="code">+--------------------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select substring("this is test string",6,200);</span><br><span class="line"><span class="code">+----------------------------------------+</span></span><br><span class="line">| substring("this is test string",6,200) |</span><br><span class="line"><span class="code">+----------------------------------------+</span></span><br><span class="line">| is test string                         |</span><br><span class="line"><span class="code">+----------------------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select mid("this is test string",6,200);</span><br><span class="line"><span class="code">+----------------------------------+</span></span><br><span class="line">| mid("this is test string",6,200) |</span><br><span class="line"><span class="code">+----------------------------------+</span></span><br><span class="line">| is test string                   |</span><br><span class="line"><span class="code">+----------------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; help mid;</span><br><span class="line">Name: <span class="emphasis">'MID'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">MID(str,pos,len)</span><br><span class="line"></span><br><span class="line">MID(str,pos,len) is a synonym for SUBSTRING(str,pos,len).</span><br><span class="line"></span><br><span class="line">URL: http://dev.mysql.com/doc/refman/5.7/en/string-functio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select ltrim("1 2");</span><br><span class="line"><span class="code">+--------------+</span></span><br><span class="line">| ltrim("1 2") |</span><br><span class="line"><span class="code">+--------------+</span></span><br><span class="line">| 1 2          |</span><br><span class="line"><span class="code">+--------------+</span></span><br><span class="line">1 row in set (0.06 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; help trim;</span><br><span class="line">Name: <span class="emphasis">'TRIM'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">TRIM([&#123;BOTH | LEADING | TRAILING&#125; [remstr] FROM] str), TRI</span><br><span class="line">FROM] str)</span><br><span class="line"></span><br><span class="line">Returns the string str with all remstr prefixes or suffixe</span><br><span class="line">none of the specifiers BOTH, LEADING, or TRAILING is given</span><br><span class="line">assumed. remstr is optional and, if not specified, spaces</span><br><span class="line"></span><br><span class="line">URL: http://dev.mysql.com/doc/refman/5.7/en/string-functio</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">mysql&gt; SELECT TRIM('  bar   <span class="emphasis">');</span></span><br><span class="line"><span class="emphasis">        -&gt; '</span>bar'</span><br><span class="line">mysql&gt; SELECT TRIM(LEADING <span class="emphasis">'x'</span> FROM <span class="emphasis">'xxxbarxxx'</span>);</span><br><span class="line"><span class="code">        -&gt; 'barxxx'</span></span><br><span class="line">mysql&gt; SELECT TRIM(BOTH <span class="emphasis">'x'</span> FROM <span class="emphasis">'xxxbarxxx'</span>);</span><br><span class="line"><span class="code">        -&gt; 'bar'</span></span><br><span class="line">mysql&gt; SELECT TRIM(TRAILING <span class="emphasis">'xyz'</span> FROM <span class="emphasis">'barxxyz'</span>);</span><br><span class="line"><span class="code">        -&gt; 'barx'</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select replace(<span class="emphasis">'this is test string'</span>,<span class="emphasis">'is'</span>,"is not")</span><br><span class="line"><span class="code">+----------------------------------------------+</span></span><br><span class="line">| replace(<span class="emphasis">'this is test string'</span>,<span class="emphasis">'is'</span>,"is not") |</span><br><span class="line"><span class="code">+----------------------------------------------+</span></span><br><span class="line">| this not is not test string                  |</span><br><span class="line"><span class="code">+----------------------------------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select rand();</span><br><span class="line"><span class="code">+--------------------+</span></span><br><span class="line">| rand()             |</span><br><span class="line"><span class="code">+--------------------+</span></span><br><span class="line">| 0.4352682404548565 |</span><br><span class="line"><span class="code">+--------------------+</span></span><br><span class="line">1 row in set (0.06 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select rand(3);</span><br><span class="line"><span class="code">+--------------------+</span></span><br><span class="line">| rand(3)            |</span><br><span class="line"><span class="code">+--------------------+</span></span><br><span class="line">| 0.9057697559760601 |</span><br><span class="line"><span class="code">+--------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; help rand;</span><br><span class="line">Name: <span class="emphasis">'RAND'</span></span><br><span class="line">Description:</span><br><span class="line">Syntax:</span><br><span class="line">RAND(), RAND(N)</span><br><span class="line"></span><br><span class="line">Returns a random floating-point value v in the range 0 &lt;=</span><br><span class="line">constant integer argument N is specified, it is used as th</span><br><span class="line">which produces a repeatable sequence of column values. In</span><br><span class="line">example, note that the sequences of values produced by RAN</span><br><span class="line">same both places where it occurs.</span><br><span class="line"></span><br><span class="line">URL: http://dev.mysql.com/doc/refman/5.7/en/mathematical-f</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">mysql&gt; CREATE TABLE t (i INT);</span><br><span class="line">Query OK, 0 rows affected (0.42 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; INSERT INTO t VALUES(1),(2),(3);</span><br><span class="line">Query OK, 3 rows affected (0.00 sec)</span><br><span class="line">Records: 3  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT i, RAND() FROM t;</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">| i    | RAND()           |</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">|    1 | 0.61914388706828 |</span><br><span class="line">|    2 | 0.93845168309142 |</span><br><span class="line">|    3 | 0.83482678498591 |</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT i, RAND(3) FROM t;</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">| i    | RAND(3)          |</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">|    1 | 0.90576975597606 |</span><br><span class="line">|    2 | 0.37307905813035 |</span><br><span class="line">|    3 | 0.14808605345719 |</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT i, RAND() FROM t;</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">| i    | RAND()           |</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">|    1 | 0.35877890638893 |</span><br><span class="line">|    2 | 0.28941420772058 |</span><br><span class="line">|    3 | 0.37073435016976 |</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT i, RAND(3) FROM t;</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">| i    | RAND(3)          |</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">|    1 | 0.90576975597606 |</span><br><span class="line">|    2 | 0.37307905813035 |</span><br><span class="line">|    3 | 0.14808605345719 |</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line">3 rows in set (0.01 sec)</span><br><span class="line">mysql&gt; select ceil(5.6);</span><br><span class="line"><span class="code">+-----------+</span></span><br><span class="line">| ceil(5.6) |</span><br><span class="line"><span class="code">+-----------+</span></span><br><span class="line">|         6 |</span><br><span class="line"><span class="code">+-----------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select floor(5.6);</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">| floor(5.6) |</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|          5 |</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select floor(5.1);</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">| floor(5.1) |</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|          5 |</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select floor(5.9);</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">| floor(5.9) |</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">|          5 |</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select truncat(123.456,2);</span><br><span class="line">ERROR 1046 (3D000): No database selected</span><br><span class="line">mysql&gt; select truncate(123.456,2);</span><br><span class="line"><span class="code">+---------------------+</span></span><br><span class="line">| truncate(123.456,2) |</span><br><span class="line"><span class="code">+---------------------+</span></span><br><span class="line">|              123.45 |</span><br><span class="line"><span class="code">+---------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select truncate(123.456,-2);</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">| truncate(123.456,-2) |</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">|                  100 |</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select truncate(123.456,-1);</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">| truncate(123.456,-1) |</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">|                  120 |</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select round(123.456);</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">| round(123.456) |</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">|            123 |</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select round(123.456,2);</span><br><span class="line"><span class="code">+------------------+</span></span><br><span class="line">| round(123.456,2) |</span><br><span class="line"><span class="code">+------------------+</span></span><br><span class="line">|           123.46 |</span><br><span class="line"><span class="code">+------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select now();</span><br><span class="line"><span class="code">+---------------------+</span></span><br><span class="line">| now()               |</span><br><span class="line"><span class="code">+---------------------+</span></span><br><span class="line">| 2018-01-09 11:12:25 |</span><br><span class="line"><span class="code">+---------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select curdate();</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">| curdate()  |</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">| 2018-01-09 |</span><br><span class="line"><span class="code">+------------+</span></span><br><span class="line">1 row in set (0.06 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select from<span class="emphasis">_unixitime("123");</span></span><br><span class="line"><span class="emphasis">ERROR 1046 (3D000): No database selected</span></span><br><span class="line"><span class="emphasis">mysql&gt; select from_</span>unixtime("123");</span><br><span class="line"><span class="code">+----------------------------+</span></span><br><span class="line">| from<span class="emphasis">_unixtime("123")       |</span></span><br><span class="line"><span class="emphasis">+----------------------------+</span></span><br><span class="line"><span class="emphasis">| 1970-01-01 08:02:03.000000 |</span></span><br><span class="line"><span class="emphasis">+----------------------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.07 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select unix_</span>timestamp(now());</span><br><span class="line"><span class="code">+-----------------------+</span></span><br><span class="line">| unix<span class="emphasis">_timestamp(now()) |</span></span><br><span class="line"><span class="emphasis">+-----------------------+</span></span><br><span class="line"><span class="emphasis">|            1515467669 |</span></span><br><span class="line"><span class="emphasis">+-----------------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select sysdate();</span></span><br><span class="line"><span class="emphasis">+---------------------+</span></span><br><span class="line"><span class="emphasis">| sysdate()           |</span></span><br><span class="line"><span class="emphasis">+---------------------+</span></span><br><span class="line"><span class="emphasis">| 2018-01-09 11:15:00 |</span></span><br><span class="line"><span class="emphasis">+---------------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select year(now());</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">| year(now()) |</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">|        2018 |</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select hour(now());</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">| hour(now()) |</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">|          11 |</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.02 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select to_</span>days(<span class="emphasis">'20'</span>);</span><br><span class="line"><span class="code">+---------------+</span></span><br><span class="line">| to<span class="emphasis">_days('20') |</span></span><br><span class="line"><span class="emphasis">+---------------+</span></span><br><span class="line"><span class="emphasis">|          NULL |</span></span><br><span class="line"><span class="emphasis">+---------------+</span></span><br><span class="line"><span class="emphasis">1 row in set, 1 warning (0.07 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select to_</span>days(<span class="emphasis">'2013-4-22'</span>);</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">| to<span class="emphasis">_days('2013-4-22') |</span></span><br><span class="line"><span class="emphasis">+----------------------+</span></span><br><span class="line"><span class="emphasis">|               735345 |</span></span><br><span class="line"><span class="emphasis">+----------------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; \h</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">For information about MySQL products and services, visit:</span></span><br><span class="line"><span class="emphasis">   http://www.mysql.com/</span></span><br><span class="line"><span class="emphasis">For developer information, including the MySQL Reference M</span></span><br><span class="line"><span class="emphasis">   http://dev.mysql.com/</span></span><br><span class="line"><span class="emphasis">To buy MySQL Enterprise support, training, or other produc</span></span><br><span class="line"><span class="emphasis">   https://shop.mysql.com/</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">List of all MySQL commands:</span></span><br><span class="line"><span class="emphasis">Note that all text commands must be first on line and end</span></span><br><span class="line"><span class="emphasis">?         (\?) Synonym for `help'.</span></span><br><span class="line"><span class="emphasis">clear     (\c) Clear the current input statement.</span></span><br><span class="line"><span class="emphasis">connect   (\r) Reconnect to the server. Optional arguments</span></span><br><span class="line"><span class="emphasis">delimiter (\d) Set statement delimiter.</span></span><br><span class="line"><span class="emphasis">ego       (\G) Send command to mysql server, display resul</span></span><br><span class="line"><span class="emphasis">exit      (\q) Exit mysql. Same as quit.</span></span><br><span class="line"><span class="emphasis">go        (\g) Send command to mysql server.</span></span><br><span class="line"><span class="emphasis">help      (\h) Display this help.</span></span><br><span class="line"><span class="emphasis">notee     (\t) Don't write into outfile.</span></span><br><span class="line"><span class="emphasis">print     (\p) Print current command.</span></span><br><span class="line"><span class="emphasis">prompt    (\R) Change your mysql prompt.</span></span><br><span class="line"><span class="emphasis">quit      (\q) Quit mysql.</span></span><br><span class="line"><span class="emphasis">rehash    (\#) Rebuild completion hash.</span></span><br><span class="line"><span class="emphasis">source    (\.) Execute an SQL script file. Takes a file na</span></span><br><span class="line"><span class="emphasis">status    (\s) Get status information from the server.</span></span><br><span class="line"><span class="emphasis">tee       (\T) Set outfile [to_</span>outfile]. Append everything</span><br><span class="line">use       (\u) Use another database. Takes database name a</span><br><span class="line">charset   (\C) Switch to another charset. Might be needed</span><br><span class="line">with multi-byte charsets.</span><br><span class="line">warnings  (\W) Show warnings after every statement.</span><br><span class="line">nowarning (\w) Don't show warnings after every statement.</span><br><span class="line">resetconnection(\x) Clean session context.</span><br><span class="line"></span><br><span class="line">For server side help, type <span class="emphasis">'help contents'</span></span><br><span class="line">mysql&gt; \s</span><br><span class="line">--------------</span><br><span class="line">mysql  Ver 14.14 Distrib 5.7.17, for Win64 (x86<span class="emphasis">_64)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">Connection id:          20</span></span><br><span class="line"><span class="emphasis">Current database:</span></span><br><span class="line"><span class="emphasis">Current user:           root@localhost</span></span><br><span class="line"><span class="emphasis">SSL:                    Not in use</span></span><br><span class="line"><span class="emphasis">Using delimiter:        ;</span></span><br><span class="line"><span class="emphasis">Server version:         5.7.17-log MySQL Community Server (GPL)</span></span><br><span class="line"><span class="emphasis">Protocol version:       10</span></span><br><span class="line"><span class="emphasis">Connection:             localhost via TCP/IP</span></span><br><span class="line"><span class="emphasis">Server characterset:    utf8</span></span><br><span class="line"><span class="emphasis">Db     characterset:    utf8</span></span><br><span class="line"><span class="emphasis">Client characterset:    gbk</span></span><br><span class="line"><span class="emphasis">Conn.  characterset:    gbk</span></span><br><span class="line"><span class="emphasis">TCP port:               3306</span></span><br><span class="line"><span class="emphasis">Uptime:                 1 day 21 hours 34 min 49 sec</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">Threads: 3  Questions: 1081  Slow queries: 0  Opens: 314  Flush tables: 1  Open</span></span><br><span class="line"><span class="emphasis">tables: 267  Queries per second avg: 0.006</span></span><br><span class="line"><span class="emphasis">--------------</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select user();</span></span><br><span class="line"><span class="emphasis">+----------------+</span></span><br><span class="line"><span class="emphasis">| user()         |</span></span><br><span class="line"><span class="emphasis">+----------------+</span></span><br><span class="line"><span class="emphasis">| root@localhost |</span></span><br><span class="line"><span class="emphasis">+----------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; select version;</span></span><br><span class="line"><span class="emphasis">ERROR 1054 (42S22): Unknown column 'version' in 'field list'</span></span><br><span class="line"><span class="emphasis">mysql&gt; select version();</span></span><br><span class="line"><span class="emphasis">+------------+</span></span><br><span class="line"><span class="emphasis">| version()  |</span></span><br><span class="line"><span class="emphasis">+------------+</span></span><br><span class="line"><span class="emphasis">| 5.7.17-log |</span></span><br><span class="line"><span class="emphasis">+------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; create table auto_</span>test(id int auto<span class="emphasis">_increment);</span></span><br><span class="line"><span class="emphasis">ERROR 1046 (3D000): No database selected</span></span><br><span class="line"><span class="emphasis">mysql&gt; show databases;</span></span><br><span class="line"><span class="emphasis">+--------------------+</span></span><br><span class="line"><span class="emphasis">| Database           |</span></span><br><span class="line"><span class="emphasis">+--------------------+</span></span><br><span class="line"><span class="emphasis">| information_</span>schema |</span><br><span class="line">| company            |</span><br><span class="line">| index<span class="emphasis">_test         |</span></span><br><span class="line"><span class="emphasis">| mysql              |</span></span><br><span class="line"><span class="emphasis">| num                |</span></span><br><span class="line"><span class="emphasis">| performance_</span>schema |</span><br><span class="line">| sakila             |</span><br><span class="line">| sys                |</span><br><span class="line">| table<span class="emphasis">_test         |</span></span><br><span class="line"><span class="emphasis">| test               |</span></span><br><span class="line"><span class="emphasis">| world              |</span></span><br><span class="line"><span class="emphasis">+--------------------+</span></span><br><span class="line"><span class="emphasis">11 rows in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; use test;</span></span><br><span class="line"><span class="emphasis">Database changed</span></span><br><span class="line"><span class="emphasis">mysql&gt; create table auto_</span>test(id int auto<span class="emphasis">_increment primary key);</span></span><br><span class="line"><span class="emphasis">Query OK, 0 rows affected (0.81 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; show create table auto_</span>increment;</span><br><span class="line">ERROR 1146 (42S02): Table <span class="emphasis">'test.auto_increment'</span> doesn't exist</span><br><span class="line">mysql&gt; show create table auto<span class="emphasis">_test;</span></span><br><span class="line"><span class="emphasis">+-----------+-------------------------------------------------------------------</span></span><br><span class="line"><span class="emphasis">-----------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| Table     | Create Table</span></span><br><span class="line"><span class="emphasis">                                                           |</span></span><br><span class="line"><span class="emphasis">+-----------+-------------------------------------------------------------------</span></span><br><span class="line"><span class="emphasis">-----------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| auto_</span>test | CREATE TABLE <span class="code">`auto_test`</span> (</span><br><span class="line"><span class="code">  `id` int(11) NOT NULL AUTO_INCREMENT,</span></span><br><span class="line"><span class="code">  PRIMARY KEY (`id`)</span></span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8 |</span><br><span class="line"><span class="code">+-----------+</span>-------------------------------------------------------------------</span><br><span class="line">-----------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into auto<span class="emphasis">_test values(null);</span></span><br><span class="line"><span class="emphasis">Query OK, 1 row affected (0.11 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; insert into auto_</span>test values(null);</span><br><span class="line">Query OK, 1 row affected (0.05 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into auto<span class="emphasis">_test values(null);</span></span><br><span class="line"><span class="emphasis">Query OK, 1 row affected (0.09 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; insert into auto_</span>test values(null);</span><br><span class="line">Query OK, 1 row affected (0.23 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select last<span class="emphasis">_insert_</span>id();</span><br><span class="line"><span class="code">+------------------+</span></span><br><span class="line">| last<span class="emphasis">_insert_</span>id() |</span><br><span class="line"><span class="code">+------------------+</span></span><br><span class="line">|                4 |</span><br><span class="line"><span class="code">+------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from auto<span class="emphasis">_test;</span></span><br><span class="line"><span class="emphasis">+----+</span></span><br><span class="line"><span class="emphasis">| id |</span></span><br><span class="line"><span class="emphasis">+----+</span></span><br><span class="line"><span class="emphasis">|  1 |</span></span><br><span class="line"><span class="emphasis">|  2 |</span></span><br><span class="line"><span class="emphasis">|  3 |</span></span><br><span class="line"><span class="emphasis">|  4 |</span></span><br><span class="line"><span class="emphasis">+----+</span></span><br><span class="line"><span class="emphasis">4 rows in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; insert into auto_</span>test values(null);</span><br><span class="line">Query OK, 1 row affected (0.14 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select last<span class="emphasis">_insert_</span>id();</span><br><span class="line"><span class="code">+------------------+</span></span><br><span class="line">| last<span class="emphasis">_insert_</span>id() |</span><br><span class="line"><span class="code">+------------------+</span></span><br><span class="line">|                5 |</span><br><span class="line"><span class="code">+------------------+</span></span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from auto<span class="emphasis">_test;</span></span><br><span class="line"><span class="emphasis">+----+</span></span><br><span class="line"><span class="emphasis">| id |</span></span><br><span class="line"><span class="emphasis">+----+</span></span><br><span class="line"><span class="emphasis">|  1 |</span></span><br><span class="line"><span class="emphasis">|  2 |</span></span><br><span class="line"><span class="emphasis">|  3 |</span></span><br><span class="line"><span class="emphasis">|  4 |</span></span><br><span class="line"><span class="emphasis">|  5 |</span></span><br><span class="line"><span class="emphasis">+----+</span></span><br><span class="line"><span class="emphasis">5 rows in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; help ifnull;</span></span><br><span class="line"><span class="emphasis">Name: 'IFNULL'</span></span><br><span class="line"><span class="emphasis">Description:</span></span><br><span class="line"><span class="emphasis">Syntax:</span></span><br><span class="line"><span class="emphasis">IFNULL(expr1,expr2)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">If expr1 is not NULL, IFNULL() returns expr1; otherwise it returns</span></span><br><span class="line"><span class="emphasis">expr2. IFNULL() returns a numeric or string value, depending on the</span></span><br><span class="line"><span class="emphasis">context in which it is used.</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">URL: http://dev.mysql.com/doc/refman/5.7/en/control-flow-functions.html</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">Examples:</span></span><br><span class="line"><span class="emphasis">mysql&gt; SELECT IFNULL(1,0);</span></span><br><span class="line"><span class="emphasis">        -&gt; 1</span></span><br><span class="line"><span class="emphasis">mysql&gt; SELECT IFNULL(NULL,10);</span></span><br><span class="line"><span class="emphasis">        -&gt; 10</span></span><br><span class="line"><span class="emphasis">mysql&gt; SELECT IFNULL(1/0,10);</span></span><br><span class="line"><span class="emphasis">        -&gt; 10</span></span><br><span class="line"><span class="emphasis">mysql&gt; SELECT IFNULL(1/0,'yes');</span></span><br><span class="line"><span class="emphasis">        -&gt; 'yes'</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt;  SELECT IFNULL(1,0);</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">| IFNULL(1,0) |</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">|           1 |</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; password;</span></span><br><span class="line"><span class="emphasis">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that</span></span><br><span class="line"><span class="emphasis">corresponds to your MySQL server version for the right syntax to use near 'passw</span></span><br><span class="line"><span class="emphasis">ord' at line 1</span></span><br><span class="line"><span class="emphasis">mysql&gt; password();</span></span><br><span class="line"><span class="emphasis">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that</span></span><br><span class="line"><span class="emphasis">corresponds to your MySQL server version for the right syntax to use near 'passw</span></span><br><span class="line"><span class="emphasis">ord()' at line 1</span></span><br><span class="line"><span class="emphasis">mysql&gt; help password();</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">Nothing found</span></span><br><span class="line"><span class="emphasis">Please try to run 'help contents' for a list of all accessible topics</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; help password;</span></span><br><span class="line"><span class="emphasis">Name: 'PASSWORD'</span></span><br><span class="line"><span class="emphasis">Description:</span></span><br><span class="line"><span class="emphasis">Syntax:</span></span><br><span class="line"><span class="emphasis">PASSWORD(str)</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">*Note*: This function is deprecated as of MySQL 5.7.6 and will be</span></span><br><span class="line"><span class="emphasis">removed in a future MySQL release.</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">Returns a hashed password string calculated from the cleartext password</span></span><br><span class="line"><span class="emphasis">str. The return value is a nonbinary string in the connection character</span></span><br><span class="line"><span class="emphasis">set, or NULL if the argument is NULL. This function is the SQL</span></span><br><span class="line"><span class="emphasis">interface to the algorithm used by the server to encrypt MySQL</span></span><br><span class="line"><span class="emphasis">passwords for storage in the mysql.user grant table.</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">The old_</span>passwords system variable controls the password hashing method</span><br><span class="line">used by the PASSWORD() function. It also influences password hashing</span><br><span class="line">performed by CREATE USER and GRANT statements that specify a password</span><br><span class="line">using an IDENTIFIED BY clause.</span><br><span class="line"></span><br><span class="line">URL: http://dev.mysql.com/doc/refman/5.7/en/encryption-functions.html</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">mysql&gt; SET old<span class="emphasis">_passwords = 0;</span></span><br><span class="line"><span class="emphasis">mysql&gt; SELECT PASSWORD('mypass'), OLD_</span>PASSWORD(<span class="emphasis">'mypass'</span>);</span><br><span class="line"><span class="code">+-------------------------------------------+</span>------------------------+</span><br><span class="line">| PASSWORD(<span class="emphasis">'mypass'</span>)                        | OLD<span class="emphasis">_PASSWORD('mypass') |</span></span><br><span class="line"><span class="emphasis">+-------------------------------------------+------------------------+</span></span><br><span class="line"><span class="emphasis">| *6C8989366EAF75BB670AD8EA7A7FC1176A95CEF4 | 6f8c114b58f2ce9e       |</span></span><br><span class="line"><span class="emphasis">+-------------------------------------------+------------------------+</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">mysql&gt; SET old_</span>passwords = 1;</span><br><span class="line">mysql&gt; SELECT PASSWORD(<span class="emphasis">'mypass'</span>), OLD<span class="emphasis">_PASSWORD('mypass');</span></span><br><span class="line"><span class="emphasis">+--------------------+------------------------+</span></span><br><span class="line"><span class="emphasis">| PASSWORD('mypass') | OLD_</span>PASSWORD(<span class="emphasis">'mypass'</span>) |</span><br><span class="line"><span class="code">+--------------------+</span>------------------------+</span><br><span class="line">| 6f8c114b58f2ce9e   | 6f8c114b58f2ce9e       |</span><br><span class="line"><span class="code">+--------------------+</span>------------------------+</span><br></pre></td></tr></table></figure>



<h1 id="六、事务"><a href="#六、事务" class="headerlink" title="六、事务"></a><strong>六、事务</strong></h1><p>事务指逻辑上的一组操作，组成这组操作的各个单元，要不全部成功，要不全部不成功。</p>
<p>数据库开启事务命令<br>– start transaction 开启事务<br>– Rollback 回滚事务,即撤销指定的sql语句(只能回退insert delete update语句)，回滚到上一次commit的位置<br>– Commit 提交事务，提交未存储的事务<br>– savepoint 保留点 ，事务处理中设置的临时占位符 你可以对它发布回退(与整个事务回退不同) </p>
<p>转账实例：</p>
<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 转账实例</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">test</span>;</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| id | name | salary |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">| 1 | zhang | 8000 |</span><br><span class="line">| 2 | fei | 10000 |</span><br><span class="line">| 3 | kobe | 8000 |</span><br><span class="line">| 4 | james | 9000 |</span><br><span class="line">+<span class="comment">------+-------+--------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">test</span> <span class="keyword">set</span> salary=salary<span class="number">-5000</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">rollback</span>;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">test</span> <span class="keyword">set</span> salary=salary<span class="number">-5000</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">test</span> <span class="keyword">set</span> salary=salary+<span class="number">5000</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">savepoint</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test2(<span class="keyword">id</span> <span class="built_in">int</span> PRIMARY <span class="keyword">KEY</span> auto_increment,<span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>)) <span class="keyword">engine</span>=<span class="keyword">innodb</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test2(<span class="keyword">name</span>) <span class="keyword">VALUE</span> (<span class="string">"alvin"</span>),</span><br><span class="line">                              (<span class="string">"yuan"</span>),</span><br><span class="line">                              (<span class="string">"xialv"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test2 (<span class="keyword">name</span>)<span class="keyword">values</span>(<span class="string">'silv'</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> test2;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 保留点</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test2 (<span class="keyword">name</span>)<span class="keyword">values</span>(<span class="string">'wu'</span>);</span><br><span class="line"><span class="keyword">savepoint</span> insert_wu;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> test2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> test2 <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">4</span>;</span><br><span class="line"><span class="keyword">savepoint</span> delete1;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> test2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> test2 <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">savepoint</span> delete2;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> test2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">rollback</span> <span class="keyword">to</span> delete1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> test2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">savepoint</span></span><br></pre></td></tr></table></figure>



<p>事务特性</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="number">1</span>&gt; 原子性（Atomicity）：原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。</span><br><span class="line"></span><br><span class="line">&lt;<span class="number">2</span>&gt; 一致性（Consistency）：事务前后数据的完整性必须保持一致。在事务执行之前数据库是符合数据完整性约束的，无论事务是否执行成功，事务结束后的数据库中的数据也应该是符合完整性约束的。在某一时间点，如果数据库中的所有记录都能保证满足当前数据库中的所有约束，则可以说当前的数据库是符合数据完整性约束的。</span><br><span class="line">比如删部门表前应该删掉关联员工（已经建立外键），如果数据库服务器发生错误，有一个员工没删掉，那么此时员工的部门表已经删除，那么就不符合完整性约束了，所以这样的数据库也就性能太差啦！</span><br><span class="line"></span><br><span class="line">&lt;<span class="number">3</span>&gt;隔离性（Isolation）：事务的隔离性是指多个用户并发访问数据库时，一个用户的事务不能被其它用户的事务所干扰，多个并发事务之间数据要相互隔离。</span><br><span class="line"></span><br><span class="line">&lt;<span class="number">4</span>&gt;持久性（Durability）：持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来即使数据库发生故障也不应该对其有任何影响。</span><br></pre></td></tr></table></figure>



<p>四个隔离级别：</p>
<ul>
<li>Serializable：可避免脏读、不可重复读、虚读情况的发生。（串行化）</li>
<li>Repeatable read：可避免脏读、不可重复读情况的发生。（可重复读）不可以避免虚读</li>
<li>Read committed：可避免脏读情况发生（读已提交）</li>
<li>Read uncommitted：最低级别，以上情况均无法保证。(读未提交)</li>
</ul>
<p>安全性考虑：Serializable&gt;Repeatable read&gt;Read committed&gt;Read uncommitted<br>数据库效率：Read uncommitted&gt;Read committed&gt;Repeatable read&gt;Serializable</p>
<p>一般情况下，我们会使用Repeatable read、Read committed mysql数据库默认的数据库隔离级别Repeatable read</p>
<p>mysql中设置数据库的隔离级别语句：set [global/session] transaction isolation level xxxx;</p>
<p>如果使用global则修改的是数据库的默认隔离级别，所有新开的窗口的隔离级别继承自这个默认隔离级别如果使用session修改，则修改的是当前客户端的隔离级别，和数据库默认隔离级别无关。当前的客户端是什么隔离级别，就能防止什么隔离级别问题，和其他客户端是什么隔离级别无关。<br>mysql中设置数据库的隔离级别语句：<code>select</code> <code>@@tx_isolation;</code></p>
<h1 id="七、数据库授权"><a href="#七、数据库授权" class="headerlink" title="七、数据库授权"></a><strong>七、数据库授权</strong></h1><h2 id="1-创建用户"><a href="#1-创建用户" class="headerlink" title="1. 创建用户"></a><strong>1. 创建用户</strong></h2><p><strong>命令</strong>:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE<span class="built_in"> USER </span><span class="string">'username'</span>@<span class="string">'host'</span> IDENTIFIED BY <span class="string">'password'</span>;</span><br></pre></td></tr></table></figure>

<p><strong>说明</strong>：</p>
<ul>
<li>username：你将创建的用户名</li>
<li>host：指定该用户在哪个主机上可以登陆，如果是本地用户可用localhost，如果想让该用户可以<strong>从任意远程主机登陆</strong>，可以使用通配符<code>%</code></li>
<li>password：该用户的登陆密码，密码可以为空，如果为空则该用户可以不需要密码登陆服务器</li>
</ul>
<p><strong>例子</strong>：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE<span class="built_in"> USER </span><span class="string">'dog'</span>@<span class="string">'localhost'</span> IDENTIFIED BY <span class="string">'123456'</span>;</span><br><span class="line">CREATE<span class="built_in"> USER </span><span class="string">'pig'</span>@<span class="string">'192.168.1.101_'</span> IDENDIFIED BY <span class="string">'123456'</span>;</span><br><span class="line">CREATE<span class="built_in"> USER </span><span class="string">'pig'</span>@<span class="string">'%'</span> IDENTIFIED BY <span class="string">'123456'</span>;</span><br><span class="line">CREATE<span class="built_in"> USER </span><span class="string">'pig'</span>@<span class="string">'%'</span> IDENTIFIED BY <span class="string">''</span>;</span><br><span class="line">CREATE<span class="built_in"> USER </span><span class="string">'pig'</span>@<span class="string">'%'</span>;</span><br></pre></td></tr></table></figure>



<h2 id="2-授权"><a href="#2-授权" class="headerlink" title="2. 授权:"></a>2. 授权:</h2><p><strong>命令</strong>:</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">privileges</span> <span class="keyword">ON</span> databasename.tablename <span class="keyword">TO</span> <span class="string">'username'</span>@<span class="string">'host'</span></span><br></pre></td></tr></table></figure>



<p><strong>说明</strong>:</p>
<ul>
<li>privileges：用户的操作权限，如<code>SELECT</code>，<code>INSERT</code>，<code>UPDATE</code>等，如果要授予所的权限则使用<code>ALL</code></li>
<li>databasename：数据库名</li>
<li>tablename：表名，如果要授予该用户对所有数据库和表的相应操作权限则可用<code>*</code>表示，如<code>*.*</code></li>
</ul>
<p><strong>例子</strong>:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span> <span class="keyword">ON</span> test.user <span class="keyword">TO</span> <span class="string">'pig'</span>@<span class="string">'%'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">'pig'</span>@<span class="string">'%'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> maindataplus.* <span class="keyword">TO</span> <span class="string">'pig'</span>@<span class="string">'%'</span>;</span><br></pre></td></tr></table></figure>



<p><strong>注意</strong>:</p>
<p>用以上命令授权的用户不能给其它用户授权，如果想让该用户可以授权，用以下命令:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">privileges</span> <span class="keyword">ON</span> databasename.tablename <span class="keyword">TO</span> <span class="string">'username'</span>@<span class="string">'host'</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span><br></pre></td></tr></table></figure>



<h2 id="3-设置与更改用户密码"><a href="#3-设置与更改用户密码" class="headerlink" title="3.设置与更改用户密码"></a>3.设置与更改用户密码</h2><p><strong>命令</strong>:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">PASSWORD</span> <span class="keyword">FOR</span> <span class="string">'username'</span>@<span class="string">'host'</span> = <span class="keyword">PASSWORD</span>(<span class="string">'newpassword'</span>);</span><br></pre></td></tr></table></figure>

<p>如果是当前登陆用户用:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">PASSWORD</span> = <span class="keyword">PASSWORD</span>(<span class="string">"newpassword"</span>);</span><br></pre></td></tr></table></figure>



<p><strong>例子</strong>:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">PASSWORD</span> <span class="keyword">FOR</span> <span class="string">'pig'</span>@<span class="string">'%'</span> = <span class="keyword">PASSWORD</span>(<span class="string">"123456"</span>);</span><br></pre></td></tr></table></figure>



<h2 id="4-撤销用户权限"><a href="#4-撤销用户权限" class="headerlink" title="4. 撤销用户权限"></a>4. 撤销用户权限</h2><p><strong>命令</strong>:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> privilege <span class="keyword">ON</span> databasename.tablename <span class="keyword">FROM</span> <span class="string">'username'</span>@<span class="string">'host'</span>;</span><br></pre></td></tr></table></figure>



<p><strong>说明</strong>:</p>
<p>privilege, databasename, tablename：同授权部分</p>
<p><strong>例子</strong>:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> *.* <span class="keyword">FROM</span> <span class="string">'pig'</span>@<span class="string">'%'</span>;</span><br></pre></td></tr></table></figure>



<p><strong>注意</strong>:</p>
<p>假如你在给用户<code>&#39;pig&#39;@&#39;%&#39;</code>授权的时候是这样的（或类似的）：<code>GRANT SELECT ON test.user TO &#39;pig&#39;@&#39;%&#39;</code>，则在使用<code>REVOKE SELECT ON *.* FROM &#39;pig&#39;@&#39;%&#39;;</code>命令并不能撤销该用户对test数据库中user表的<code>SELECT</code> 操作。相反，如果授权使用的是<code>GRANT SELECT ON *.* TO &#39;pig&#39;@&#39;%&#39;;</code>则<code>REVOKE SELECT ON test.user FROM &#39;pig&#39;@&#39;%&#39;;</code>命令也不能撤销该用户对test数据库中user表的<code>Select</code>权限。</p>
<p>具体信息可以用命令<code>SHOW GRANTS FOR &#39;pig&#39;@&#39;%&#39;;</code> 查看。</p>
<h2 id="5-删除用户"><a href="#5-删除用户" class="headerlink" title="5. 删除用户"></a>5. 删除用户</h2><p><strong>命令</strong>:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP<span class="built_in"> USER </span><span class="string">'username'</span>@<span class="string">'host'</span>;</span><br></pre></td></tr></table></figure>



<h1 id="八、pymysql模块"><a href="#八、pymysql模块" class="headerlink" title="八、pymysql模块"></a><strong>八、pymysql模块</strong></h1><p><strong>Python关于MySQL的API接口</strong>    </p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pymsql是Python中操作MySQL的模块，其使用方法和py2的MySQLdb几乎相同。</span><br><span class="line">安装：pip <span class="keyword">install</span> pymysql</span><br></pre></td></tr></table></figure>



<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf<span class="number">-8</span> -*-</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="meta">#1.连接mysql</span></span><br><span class="line">conn = pymysql.<span class="keyword">connect</span>(host=<span class="string">'localhost'</span>,port=<span class="number">3306</span>,<span class="keyword">user</span>=<span class="string">'root'</span>,<span class="keyword">password</span>=<span class="string">'0000'</span>,db=<span class="string">'python3'</span>)</span><br><span class="line"># conn = pymysql.<span class="keyword">connect</span>(host=<span class="string">'localhost'</span>,<span class="keyword">user</span>=<span class="string">'root'</span>,<span class="keyword">password</span>=<span class="string">'0000'</span>,db=<span class="string">'crawed'</span>,charset=<span class="string">'utf8'</span>,cursorclass = pymysql.cursors.DictCursor,use_unicode=<span class="keyword">True</span>)</span><br><span class="line"><span class="meta">#2.创建游标</span></span><br><span class="line"><span class="keyword">cursor</span> = conn.<span class="keyword">cursor</span>()</span><br><span class="line"># <span class="keyword">cursor</span> = conn.<span class="keyword">cursor</span>(<span class="keyword">cursor</span>=pymysql.cursors.DictCursor)  #更改获取数据结果的数据类型</span><br><span class="line"></span><br><span class="line"><span class="meta">#3.创建表添加数据</span></span><br><span class="line"># <span class="keyword">sql</span> = <span class="string">'create table test(id int,name varchar(20))'</span></span><br><span class="line"># sql1 = "insert into test values (1,'zhang'),(2,'fei');"</span><br><span class="line"># <span class="keyword">cursor</span>.<span class="keyword">execute</span>(<span class="keyword">sql</span>)</span><br><span class="line"># <span class="keyword">cursor</span>.<span class="keyword">execute</span>(sql1)</span><br><span class="line"></span><br><span class="line"><span class="meta">#4.查询数据</span></span><br><span class="line">sql2 = <span class="string">'select * from test;'</span></span><br><span class="line"><span class="keyword">cursor</span>.<span class="keyword">execute</span>(sql2)</span><br><span class="line"># num = <span class="keyword">cursor</span>.fetchone()</span><br><span class="line"># print(<span class="keyword">cursor</span>.fetchone())</span><br><span class="line"># print(<span class="keyword">cursor</span>.fetchmany(<span class="number">2</span>))</span><br><span class="line">print(<span class="keyword">cursor</span>.fetchall())</span><br><span class="line"></span><br><span class="line"><span class="meta">#5.scroll  控制游标位置</span></span><br><span class="line"># print(<span class="keyword">cursor</span>.fetchone())</span><br><span class="line"># print(<span class="keyword">cursor</span>.fetchone())</span><br><span class="line"># <span class="keyword">cursor</span>.scroll(<span class="number">-1</span>,mode=<span class="string">'relative'</span>)  # 相对当前位置移动</span><br><span class="line"># <span class="keyword">cursor</span>.scroll(<span class="number">0</span>,mode=<span class="string">'absolute'</span>) # 相对绝对位置移动</span><br><span class="line"># print(<span class="keyword">cursor</span>.fetchone())</span><br><span class="line"></span><br><span class="line">conn.<span class="keyword">commit</span>()</span><br><span class="line">conn.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure>



<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> pymysql</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">import</span> pymysql</span><br><span class="line">#</span><br><span class="line"># conn = pymysql.<span class="keyword">Connect</span>(host=<span class="string">'localhost'</span>, <span class="keyword">user</span>=<span class="string">'root'</span>, <span class="keyword">password</span>=<span class="string">'0000'</span>, <span class="keyword">database</span>=<span class="string">'flask_code'</span>, charset=<span class="string">'utf8'</span>)</span><br><span class="line">#</span><br><span class="line"># # <span class="keyword">cursor</span> = conn.<span class="keyword">cursor</span>()   # 每一行是元组</span><br><span class="line"># <span class="keyword">cursor</span> = conn.<span class="keyword">cursor</span>(<span class="keyword">cursor</span>=pymysql.cursors.DictCursor)   # 每一行是字典</span><br><span class="line"></span><br><span class="line"># <span class="keyword">sql</span> = "select * from userinfo where username='&#123;0&#125;' and password='&#123;1&#125;'".format(<span class="string">'zhangsan'</span>,<span class="string">'317bc264bfd3d562fa415dbb905e2d8a'</span>)</span><br><span class="line"># <span class="keyword">sql</span>注入</span><br><span class="line"># <span class="keyword">sql</span> = "select * from userinfo where username='&#123;0&#125;' and password='&#123;1&#125;'".format("xx ' or 1=1 -- ",<span class="string">'317bc264bfd3d562fa415dbb905e2d8a'</span>)</span><br><span class="line"># <span class="keyword">sql</span> = "select * from userinfo where username='%s' and password ='%s'" %("xiao ' or 1=1 -- ","47f5abdd7f4083f0cc5c94d587fa3ca4")</span><br><span class="line"># print(<span class="keyword">sql</span>)</span><br><span class="line"># <span class="keyword">cursor</span>.<span class="keyword">execute</span>(<span class="keyword">sql</span>)</span><br><span class="line"># <span class="keyword">cursor</span>.<span class="keyword">execute</span>("select * from userinfo where username=%s and password=%s",("xx ' or 1=1 --",<span class="string">'317bc264bfd3d562fa415dbb905e2d8a'</span>))</span><br><span class="line"># <span class="keyword">cursor</span>.<span class="keyword">execute</span>("select * from userinfo where username=%s and password=%s",(<span class="string">'zhangsan'</span>,<span class="string">'317bc264bfd3d562fa415dbb905e2d8a'</span>))</span><br><span class="line"># <span class="keyword">cursor</span>.<span class="keyword">execute</span>("select * from userinfo where username=%(us)s and password=%(pw)s",&#123;<span class="string">'us'</span>:<span class="string">'zhangsan'</span>,<span class="string">'pw'</span>:<span class="string">'317bc264bfd3d562fa415dbb905e2d8a'</span>&#125;)</span><br><span class="line"># <span class="keyword">cursor</span>.<span class="keyword">execute</span>("select id,username,password from userinfo where username=%(us)s and password=%(pw)s",&#123;<span class="string">'us'</span>:<span class="string">'zhangsan'</span>,<span class="string">'pw'</span>:<span class="string">'317bc264bfd3d562fa415dbb905e2d8a'</span>&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># data = <span class="keyword">cursor</span>.fetchall()</span><br><span class="line"># data = <span class="keyword">cursor</span>.fetchone()</span><br><span class="line">#</span><br><span class="line"># print(data[<span class="string">'id'</span>],data[<span class="string">'username'</span>])</span><br><span class="line">#</span><br><span class="line"># <span class="keyword">cursor</span>.<span class="keyword">close</span>()</span><br><span class="line"># conn.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line">pymysql</span><br></pre></td></tr></table></figure>



<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> 数据库连接池</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> DBUtils.PooledDB import PooledDB, SharedDBConnection</span><br><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">POOL = PooledDB(</span><br><span class="line">    <span class="attribute">creator</span>=pymysql,  # 使用链接数据库的模块</span><br><span class="line">    <span class="attribute">maxconnections</span>=6,  # 连接池允许的最大连接数，0和None表示不限制连接数</span><br><span class="line">    <span class="attribute">mincached</span>=2,  # 初始化时，链接池中至少创建的空闲的链接，0表示不创建</span><br><span class="line">    <span class="attribute">maxcached</span>=5,  # 链接池中最多闲置的链接，0和None不限制</span><br><span class="line">    <span class="attribute">maxshared</span>=3,  # 链接池中最多共享的链接数量，0和None表示全部共享。PS: 无用，因为pymysql和MySQLdb等模块的 threadsafety都为1，所有值无论设置为多少，_maxcached永远为0，所以永远是所有链接都共享。</span><br><span class="line">    <span class="attribute">blocking</span>=<span class="literal">True</span>,  # 连接池中如果没有可用连接后，是否阻塞等待。<span class="literal">True</span>，等待；<span class="literal">False</span>，不等待然后报错</span><br><span class="line">    <span class="attribute">maxusage</span>=None,  # 一个链接最多被重复使用的次数，None表示无限制</span><br><span class="line">    setsession=[],  # 开始会话前执行的命令列表。如：[<span class="string">"set datestyle to ..."</span>, <span class="string">"set time zone ..."</span>]</span><br><span class="line">    <span class="attribute">ping</span>=0,</span><br><span class="line">    #<span class="built_in"> ping </span>MySQL服务端，检查是否服务可用。# 如：0 = None = never, 1 =<span class="built_in"> default </span>= whenever it is requested, 2 = when a cursor is created, 4 = when a query is executed, 7 = always</span><br><span class="line">    <span class="attribute">host</span>=<span class="string">'127.0.0.1'</span>,</span><br><span class="line">    <span class="attribute">port</span>=3306,</span><br><span class="line">    <span class="attribute">user</span>=<span class="string">'root'</span>,</span><br><span class="line">    <span class="attribute">password</span>=<span class="string">'0000'</span>,</span><br><span class="line">    <span class="attribute">database</span>=<span class="string">'flask_code'</span>,</span><br><span class="line">    <span class="attribute">charset</span>=<span class="string">'utf8'</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">数据库连接池</span><br></pre></td></tr></table></figure>



<p><img src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="img"> MysqlHelper</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf<span class="number">-8</span> -*-</span><br><span class="line"></span><br><span class="line">"""</span><br><span class="line">@Datetime: 2018/12/26</span><br><span class="line">@Author: Zhang Yafei</span><br><span class="line">"""</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">from</span> settings <span class="keyword">import</span> POOL</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="keyword">connect</span>():</span><br><span class="line">    conn = POOL.<span class="keyword">connection</span>()</span><br><span class="line">    <span class="keyword">cursor</span> = conn.<span class="keyword">cursor</span>(<span class="keyword">cursor</span>=pymysql.cursors.DictCursor)</span><br><span class="line">    <span class="keyword">return</span> conn, <span class="keyword">cursor</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def connect_close(conn, <span class="keyword">cursor</span>):</span><br><span class="line">    <span class="keyword">cursor</span>.<span class="keyword">close</span>()</span><br><span class="line">    conn.<span class="keyword">close</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def fetchone(<span class="keyword">sql</span>, arg=list()):</span><br><span class="line">    conn, <span class="keyword">cursor</span> = <span class="keyword">connect</span>()</span><br><span class="line">    <span class="keyword">cursor</span>.<span class="keyword">execute</span>(<span class="keyword">sql</span>, arg)</span><br><span class="line">    data = <span class="keyword">cursor</span>.fetchone()</span><br><span class="line">    connect_close(conn, <span class="keyword">cursor</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def fetchall(<span class="keyword">sql</span>, arg=list()):</span><br><span class="line">    conn, <span class="keyword">cursor</span> = <span class="keyword">connect</span>()</span><br><span class="line">    <span class="keyword">cursor</span>.<span class="keyword">execute</span>(<span class="keyword">sql</span>, arg)</span><br><span class="line">    data = <span class="keyword">cursor</span>.fetchall()</span><br><span class="line">    connect_close(conn, <span class="keyword">cursor</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="keyword">insert</span>(<span class="keyword">sql</span>, arg=list()):</span><br><span class="line">    conn, <span class="keyword">cursor</span> = <span class="keyword">connect</span>()</span><br><span class="line">    <span class="keyword">row</span> = <span class="keyword">cursor</span>.<span class="keyword">execute</span>(<span class="keyword">sql</span>, arg)</span><br><span class="line">    conn.<span class="keyword">commit</span>()</span><br><span class="line">    connect_close(conn, <span class="keyword">cursor</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">row</span></span><br><span class="line"></span><br><span class="line">MysqlHelper</span><br></pre></td></tr></table></figure>



<p>补充：数据库优化方案</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>避免使用select * </span><br><span class="line"><span class="bullet">- </span>固定长度在前面</span><br><span class="line"><span class="bullet">- </span>内存代替表，如：性别等</span><br><span class="line"><span class="bullet">- </span>读写分离</span><br><span class="line"><span class="bullet">- </span>分库</span><br><span class="line"><span class="bullet">- </span>分表</span><br><span class="line"><span class="bullet">- </span>水平分表</span><br><span class="line"><span class="bullet">- </span>垂直分表</span><br><span class="line"><span class="bullet">- </span>命中索引</span><br><span class="line"><span class="bullet">- </span>组合索引代替索引合并</span><br><span class="line"><span class="bullet">- </span>尽量使用短索引</span><br><span class="line"><span class="bullet">- </span>如果取一条数据时，使用limit 1</span><br><span class="line">select id,name from tb where name =<span class="emphasis">'alex'</span> limit 1;</span><br><span class="line"><span class="bullet">- </span>使用连接（JOIN）来代替子查询(Sub-Queries)</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章推荐</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2008\01\04\python\2008-01-04-python-draft\" rel="bookmark">python-draft</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2008\01\05\python\2008-01-04-python-ruan\" rel="bookmark">python-ruan</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2021\11\24\python\python_基础篇\第10篇：列表和元组的应用\" rel="bookmark">第10篇：列表和元组的应用</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2021\11\25\python\python_基础篇\基础篇-目录\" rel="bookmark">基础篇</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\2021\11\24\python\python_基础篇\第11篇：高级数据类型之集合\" rel="bookmark">第11篇：高级数据类型之集合</a></div>
    </li>
  </ul>

        <div class="reward-container">
  <div>赞赏一下吧～</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="tongsiying 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>tongsiying
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tongsiying.github.io/2022/01/18/python/python_%E5%9F%BA%E7%A1%80%E7%AF%87/%E7%AC%AC36%E7%AF%87%EF%BC%9AMySQL%E8%BF%9B%E9%98%B6/" title="第36篇：MySQL进阶">https://tongsiying.github.io/2022/01/18/python/python_基础篇/第36篇：MySQL进阶/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/python/" rel="tag"># python</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/01/18/python/python_%E5%9F%BA%E7%A1%80%E7%AF%87/%E7%AC%AC35%E7%AF%87%EF%BC%9AMySQL%E5%9F%BA%E7%A1%80/" rel="prev" title="第35篇：MySQL基础">
      <i class="fa fa-chevron-left"></i> 第35篇：MySQL基础
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/01/19/python/python_%E5%9F%BA%E7%A1%80%E7%AF%87/%E7%AC%AC37%E7%AF%87%EF%BC%9AHTML/" rel="next" title="第37篇：HTML">
      第37篇：HTML <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一、视图"><span class="nav-text">一、视图</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库视图的优点"><span class="nav-text">数据库视图的优点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库视图的缺点"><span class="nav-text">数据库视图的缺点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-创建视图"><span class="nav-text">1. 创建视图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-查看视图"><span class="nav-text">2. 查看视图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-视图的更改"><span class="nav-text">3. 视图的更改</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-CREATE-OR-REPLACE-VIEW语句修改视图"><span class="nav-text">3.1 CREATE OR REPLACE VIEW语句修改视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-ALTER语句修改视图"><span class="nav-text">3.2 ALTER语句修改视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-DML操作更新视图"><span class="nav-text">3.3 DML操作更新视图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-使用WITH-CHECK-OPTION约束"><span class="nav-text">4. 使用WITH CHECK OPTION约束</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-定义视图时的其他选项"><span class="nav-text">5. 定义视图时的其他选项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-视图查询语句的处理"><span class="nav-text">6. 视图查询语句的处理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、存储过程"><span class="nav-text">二、存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#存储过程的优点"><span class="nav-text">存储过程的优点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#存储过程的缺点"><span class="nav-text">存储过程的缺点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-创建存储过程"><span class="nav-text">1. 创建存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-调用存储过程"><span class="nav-text">2. 调用存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-删除存储过程"><span class="nav-text">3. 删除存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-其他常用命令"><span class="nav-text">4. 其他常用命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-存储过程实例"><span class="nav-text">5. 存储过程实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-创建存储过程"><span class="nav-text">5.1 创建存储过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-删除存储过程"><span class="nav-text">5.2 删除存储过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-执行存储过程"><span class="nav-text">5.3 执行存储过程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、触发器"><span class="nav-text">三、触发器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-创建触发器"><span class="nav-text">1. 创建触发器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-查看触发器"><span class="nav-text">2. 查看触发器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-删除触发器"><span class="nav-text">3. 删除触发器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-触发器的执行顺序"><span class="nav-text">4. 触发器的执行顺序</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四、索引"><span class="nav-text">四、索引</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-索引简介："><span class="nav-text">1. 索引简介：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-索引作用："><span class="nav-text">2. 索引作用：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-索引种类："><span class="nav-text">3. 索引种类：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-创建索引语法"><span class="nav-text">4. 创建索引语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-索引测试实验"><span class="nav-text">5. 索引测试实验</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-正确使用索引"><span class="nav-text">6. 正确使用索引</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五、函数"><span class="nav-text">五、函数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#六、事务"><span class="nav-text">六、事务</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#七、数据库授权"><span class="nav-text">七、数据库授权</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-创建用户"><span class="nav-text">1. 创建用户</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-授权"><span class="nav-text">2. 授权:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-设置与更改用户密码"><span class="nav-text">3.设置与更改用户密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-撤销用户权限"><span class="nav-text">4. 撤销用户权限</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-删除用户"><span class="nav-text">5. 删除用户</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#八、pymysql模块"><span class="nav-text">八、pymysql模块</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="tongsiying"
      src="/images/gutianle.gif">
  <p class="site-author-name" itemprop="name">tongsiying</p>
  <div class="site-description" itemprop="description">问渠那得清如许？为有源头活水来。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">426</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">46</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/tongsiying" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tongsiying" rel="noopener external nofollow noreferrer" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wxtlucky1015@163.com" title="E-Mail → mailto:wxtlucky1015@163.com" rel="noopener external nofollow noreferrer" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/2964109344" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;2964109344" rel="noopener external nofollow noreferrer" target="_blank"><i class="weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/" title="tongsiying → https:&#x2F;&#x2F;tongsiying.github.io"><i class="wrench fa-fw"></i>tongsiying</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/ReadingNotes/" title="ReadingNotes → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;ReadingNotes&#x2F;"><i class="book fa-fw"></i>ReadingNotes</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/blog/" title="blog → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;blog&#x2F;"><i class="book fa-fw"></i>blog</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/blog/tools/" title="tools → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;blog&#x2F;tools&#x2F;"><i class="wrench fa-fw"></i>tools</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/lanlan/" title="lanlan → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;lanlan&#x2F;"><i class="wrench fa-fw"></i>lanlan</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/Music/" title="note → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;Music&#x2F;"><i class="wrench fa-fw"></i>note</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/sound/" title="Music → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;sound&#x2F;"><i class="wrench fa-fw"></i>Music</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/JSONFormat/" title="JSONFormat → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;JSONFormat&#x2F;"><i class="wrench fa-fw"></i>JSONFormat</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/HTML5-Canvas/" title="Canvas → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;HTML5-Canvas&#x2F;"><i class="wrench fa-fw"></i>Canvas</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/games/" title="games → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;games&#x2F;"><i class="wrench fa-fw"></i>games</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/love/" title="love → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;love&#x2F;"><i class="wrench fa-fw"></i>love</a>
      </span>
  </div>



		<div style="">
  <canvas id="canvas" style="width:60%;">��ǰ�������֧��canvas������������������</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //����canvas�Ŀ���
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //�洢ʱ������
    var data = [];
    //�洢�˶���С��
    var balls = [];
    //�������Ӱ뾶
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //�洢ʱ�����֣���ʮλСʱ����λСʱ��ð�š�ʮλ���ӡ���λ���ӡ�ð�š�ʮλ���ӡ���λ������7���������
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*���ɵ�������*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*����ʱ��*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //ʱ�䷢���仯
            if(NewData[i] !== data[i]){
                //���仯������ֵ����data�����е������洢��changeNumArray������
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //����С��
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*����С��״̬*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*����Ҫ�˶���С��*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*��Ⱦ*/
    function render(){
        //���û������ȣ��ﵽ��ջ�����Ч��
        canvas.height = 100;
        //��Ⱦʱ��
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //��ȾС��
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //����ʱ��
        updateDigitTime();
        //����С��״̬
        updateBalls();
        //��Ⱦ
        render();
    },50);
}

})();
</script>
      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; Weeny – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tongsiying</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">6.2m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">94:30</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
