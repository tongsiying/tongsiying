<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/hedgehog.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/hedgehog.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tongsiying.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","b2t":true,"scrollpercent":true,"padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="article">
<meta property="og:title" content="python-fishc">
<meta property="og:url" content="https://tongsiying.github.io/2008/01/04/python/2008-01-04-python-fishc/index.html">
<meta property="og:site_name" content="tongsiying">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2008-01-04T10:37:19.000Z">
<meta property="article:modified_time" content="2021-02-11T09:48:51.593Z">
<meta property="article:author" content="tongsiying">
<meta property="article:tag" content="python-fishc">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tongsiying.github.io/2008/01/04/python/2008-01-04-python-fishc/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>python-fishc | tongsiying</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
<!-- 加入APlayer音乐播放器 -->
<link rel="stylesheet" href="/dist/APlayer.min.css">
<div id="aplayer"></div>
<script type="text/javascript" src="/dist/APlayer.min.js"></script>
<script type="text/javascript" src="/dist/music.js"></script>
  <div class="container use-motion">
    <div class="headband"></div>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">tongsiying</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">阅读|运动|自律</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/catalog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-目录">

    <a href="/catalog/" rel="section"><i class="fa fa fa-th fa-fw"></i>目录</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-读书清单">

    <a href="/read" rel="section"><i class="fa fa-book fa-fw"></i>读书清单</a>

  </li>
        <li class="menu-item menu-item-读书笔记">

    <a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="section"><i class="fa fa-book fa-fw"></i>读书笔记</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tongsiying.github.io/2008/01/04/python/2008-01-04-python-fishc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/gutianle.gif">
      <meta itemprop="name" content="tongsiying">
      <meta itemprop="description" content="问渠那得清如许？为有源头活水来。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tongsiying">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          python-fishc
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2008-01-04 18:37:19" itemprop="dateCreated datePublished" datetime="2008-01-04T18:37:19+08:00">2008-01-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-11 17:48:51" itemprop="dateModified" datetime="2021-02-11T17:48:51+08:00">2021-02-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>60k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>54 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p class="description"></p>
<a id="more"></a>

<h1 id="FISHC-note"><a href="#FISHC-note" class="headerlink" title="FISHC-note"></a>FISHC-note</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br></pre></td><td class="code"><pre><span class="line">掘墓人的小铲子  https:&#x2F;&#x2F;juemuren4449.com&#x2F;categories</span><br><span class="line">http:&#x2F;&#x2F;www.webhuang.cn&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;www.cnblogs.com&#x2F;wongbingming&#x2F;p&#x2F;9028851.html</span><br><span class="line">https:&#x2F;&#x2F;www.bbsmax.com&#x2F;R&#x2F;E35pMOEydv&#x2F;</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">集合：在我的世界里，你就是唯一</span><br><span class="line">&gt;&gt;&gt;numl&#x3D;&#123;&#125;</span><br><span class="line">&gt;&gt;&gt;type(numl)</span><br><span class="line">&lt;class &#39;dict&gt;</span><br><span class="line">&gt;&gt;num2&#x3D;&#123;1,2,3,4,5&#125;</span><br><span class="line">&gt;&gt;&gt;type(num2)</span><br><span class="line">&lt;class&#39;set&gt;</span><br><span class="line"></span><br><span class="line">你们确实没有眼花,在Python3里,如果用大括号括起一堆数字但没有体现映射关系,那么Python就会认为这堆玩意儿就是个集合.</span><br><span class="line">好,说回主题,集合在Python中几乎起到的所有作用就是两个字:唯一.举个例子:</span><br><span class="line">&gt;&gt;&gt;num&#x3D;&#123;1,2,3,4,5,4,3,2,1&#125;</span><br><span class="line">&gt;&gt;&gt;num</span><br><span class="line">&#123;1,2,3,4,5&#125;</span><br><span class="line">大家看到,我们根本不需要做什么,集合就会帮我们把重复的数据清理掉,这样是不是很方便呢?但要注意的是,集合是无序的,也就是你不能试图去索引集合中的某一个元素:</span><br><span class="line">&gt;&gt;&gt;num[2]</span><br><span class="line">Traceback(most recent call last): </span><br><span class="line">	File&quot;&lt;pyshel1#81&gt;&quot;,1ine 1,in&lt;module&gt;</span><br><span class="line">		num[2]</span><br><span class="line">	TypeError:&#39;set&#39;object does not support indexing</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">创建集合</span><br><span class="line">创建集合有两种方法:一种是直接把一堆元素用大括号(&#123;&#125;)括起来;另一种是用set()。</span><br><span class="line">&gt;&gt;&gt;set1&#x3D;&#123;&quot;小甲鱼&quot;,&quot;小鱿鱼&quot;,&quot;小护士&quot;,&quot;小甲鱼&quot;&#125;</span><br><span class="line">&gt;&gt;&gt;set2&#x3D;set([&quot;小甲鱼&quot;,&quot;小鱿鱼&quot;,&quot;小护士&quot;,&quot;小甲鱼&quot;])</span><br><span class="line">&gt;&gt;&gt;set1&#x3D;&#x3D;set2</span><br><span class="line">True</span><br><span class="line">现在要求去除列表[1,2,3,4,5,5,3,1,0]中重复的元素.如果还没有学习过集合,你可能会这么写:</span><br><span class="line">&gt;&gt;&gt;1ist1&#x3D;[1,2,3,4,5,5,3,1,0]</span><br><span class="line">&gt;&gt;temp&#x3D;list1[:]</span><br><span class="line">&gt;&gt;list1.clear()</span><br><span class="line">&gt;&gt;&gt;for each in temp:</span><br><span class="line">	if each not in list1:</span><br><span class="line">		1ist1.append(each)</span><br><span class="line">&gt;&gt;&gt;list1</span><br><span class="line">[1,2,3,4,5,0]</span><br><span class="line">当你学习了集合之后,就可以这么干:</span><br><span class="line">&gt;&gt;&gt;list1&#x3D;[1,2,3,4,5,5,3,1,0]</span><br><span class="line">&gt;&gt;&gt;list1&#x3D;list(set(list1))</span><br><span class="line">&gt;&gt;&gt;list1</span><br><span class="line">[0,1,2,3,4,5]</span><br><span class="line"></span><br><span class="line">看,知识才是第一生产力!不过大家发现没有?由于set()创造了的集合内部是无序的,所以再调用list()将无序的集合转换成列表就不能保证原来的列表的顺序了(这里Python好心办坏事儿,把0放到前边了),所以如果关注列表中元素的前后顺序问题,使用set()这个函数时就要提高警惕啦!</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">访问集合</span><br><span class="line">由于集合中的元素是无序的,所以并不能像序列那样用下标来进行访问,但是可以使用代把集合中的数据一个个读取出来:</span><br><span class="line">&gt;&gt;&gt; set1 &#x3D;&#123;1, 2, 3, 4, 5, 4, 3, 2, 1, 0&#125;</span><br><span class="line">&gt;&gt; for each in setl:</span><br><span class="line">	print(each, end &#x3D;&#39;&#39;)</span><br><span class="line">0 1 2 3 4 5</span><br><span class="line"></span><br><span class="line">当然也可以使用in和not in判断一个元素是否在集合中已经存在:</span><br><span class="line">&gt;&gt;0 in setl</span><br><span class="line">True</span><br><span class="line">&gt;&gt; &#39;oo&#39; in set1</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt;&#39;xx&#39; not in set1</span><br><span class="line">True</span><br><span class="line"></span><br><span class="line">使用add()方法可以为集合添加元素,使用remove()方法可以删除集合中已知的元素:</span><br><span class="line">&gt;set1.add(6)</span><br><span class="line">&gt;&gt; set1</span><br><span class="line">(0, 1, 2, 3, 4, 5, 6&#125;</span><br><span class="line">&gt;&gt; set1.remove(5)</span><br><span class="line">&gt;&gt; set1</span><br><span class="line">&#123;0, 1, 2, 3, 4, 6&#125;</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">不可变集合</span><br><span class="line">有些时候希望集合中的数据具有稳定性,也就是说,像元组一样不能随意地增加或删除集合中的元素.那么我们可以定义不可变集合,这里使用的是frozenset()函数,没错,就是把元素给frozen(冰冻)起来:</span><br><span class="line">&gt;&gt;&gt;set1 &#x3D; frozenset(&#123;1,2,3,4,5&#125;)</span><br><span class="line">&gt;&gt; set1.add(6)</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt;pyshell#112&gt;&quot;,1ine 1,in &lt;module&gt;</span><br><span class="line">		set1.add(6)</span><br><span class="line">AttributeError:&#39;frozenset&#39;obiect has no attribute&#39;add</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">永久存储</span><br><span class="line">在你编写代码的时候,操作系统为了更快地做出啊应,把所有当前时数据都放在内存中,因为内存和CPU数据传输的速度要比在硬盘和CPU之间传输的速度快很多倍.</span><br><span class="line">但内存有一个天生的不足,就是一旦断电就没戏,所以小甲鱼在这里再一次呼吁广大未来即将成为伟大程序员的读者们:请养成一个优雅的习惯,随时使用快捷键Ctrl+S保存你的数据.</span><br><span class="line">由于Windows是以扩展名来指出文件是什么类型,所以相信很多习惯使用Windows的朋友很快就反应过来了,.exe是可执行文件格式,,txt是文本文件,.ppt是PowerPoint的专用格式 所有这些都称为文件.</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">打开文件</span><br><span class="line">在Python 中,使用open()这个函数来打开文件并返回文件对象:open(file,mode &#x3D;&#39;r&#39;,buffering &#x3D;-1,encoding &#x3D; None,errors &#x3D; None,newline &#x3D; None,closefd &#x3D;True,opener &#x3D; None)</span><br><span class="line">open()这个函数有很多参数,但作为初学者的我们,只需要先关注第一个和第二个参数即可.第一个参数是传入的文件名,如果只有文件名,不带路径的话,那么Python会在当前文件夹中去找到该文件并打开.</span><br><span class="line"></span><br><span class="line">有的读者可能会问:如果我要打开的文件事实上并不存在呢?</span><br><span class="line">那就要看第二个参数了,第二个参数指定文件打开模式</span><br><span class="line">打开模式	执行操作</span><br><span class="line">&#39;r&#39;			以只读方式打开文件（默认）</span><br><span class="line">&#39;w&#39;			以写入的方式打开文件，会覆盖已存在的文件</span><br><span class="line">&#39;x&#39;			如果文件已经存在，使用此模式打开将引发异常</span><br><span class="line">&#39;a&#39;			以写入模式打开，如果文件存在，则在末尾追加写入</span><br><span class="line">&#39;b&#39;			以二进制模式打开文件</span><br><span class="line">&#39;t&#39;			以文本模式打开（默认）</span><br><span class="line">&#39;+&#39;			可读写模式（可添加到其他模式中使用）</span><br><span class="line">&#39;U&#39;			通用换行符支持</span><br><span class="line"></span><br><span class="line">使用open()成功打开一个文件之后,它会返回一个文件对象,拿到这个文件对象,就可以读取或修改这个文件:</span><br><span class="line">&gt;&gt;#先将record.txt文件放到Python的根目录下(如C:\Python34)</span><br><span class="line">&gt;&gt; f&#x3D;open(&quot;record.txt&quot;)</span><br><span class="line">没有消息就是好消息,说明我们的文件成功被打开了.</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">文件对象的方法</span><br><span class="line">表8-2文件对象方法</span><br><span class="line">文件对象的方法			执行操作</span><br><span class="line">closeC)					关闭文件</span><br><span class="line">read(size&#x3D;-1)			从文件读取size个字符,当未给定size或给定负值的时候,读取剩余的所有字符,然后作为字符申返回</span><br><span class="line">readlin					以写人模式打开,如果文件存在,则在末尾追加写入 </span><br><span class="line">write(str)				将字符串str写入文件</span><br><span class="line">writelines(seq)			向文件写入字符串序列seq,seq应该是一个返回字符串的可迭代对象</span><br><span class="line">seek(offset,from)		在文件中移动文件指针,从from(0代表文件起始位置,1代表当前位置,2代表文件末尾)偏移offset个字节</span><br><span class="line">tell()					返回当前在文件中的位置</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">文件的关闭</span><br><span class="line">Python拥有垃圾收集机制,会在文件对象的引用计数降至零的时候自动关闭文件,所以在Python编程里,如果忘记关闭文件并不会造成内存泄露那么危险的结果.</span><br><span class="line"></span><br><span class="line">但并不是说就可以不要关闭文件,如果你对文件进行了写入操作,那么应该在完成写入之后关闭文件.因为Python可能会缓存你写入的数据,如果中途发生类似断电之类的事故,那些缓存的数据根本就不会写入到文件中.所以,为了安全起见,要养成使用完文件后立刻关闭的好习惯</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">文件的读取和定位</span><br><span class="line">文件的读取方法很多,可以使用文件对象的read()和readline()方法,也可以直接list(f)或者直接使用迭代来读取。read()是按字节为单位读取,如果不设置参数,那么会全部读取出来,文件指针指向文件末尾。tell()方法可以告诉你当前文件指针的位置:</span><br><span class="line">&gt;&gt;&gt; f.read()</span><br><span class="line">&#39;小客服:小甲鱼,有个好评很好笑哈.\n小甲鱼:哦?\n小客服:&quot;有了小甲鱼,以后妈妈再也不用担心我的学习了~&quot;\n小甲鱼:哈哈哈,我看到啊,我还发微博了呢~\n小客服:嗯嗯,我看了你的微博r~\n小甲鱼:OK~\n小客服:那个有条回复&quot;左手拿着小甲鱼,右手拿着打火机,哪里不会点哪里,so easy^&quot;\n小甲鱼:TT&#39;</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; f.tell()</span><br><span class="line">284</span><br><span class="line"></span><br><span class="line">刚才提到的文件指针是啥?你可以认为它是一个&quot;书签&quot;,起到定位的作用。使用seek()方法可以调整文件指针的位置。</span><br><span class="line">seek(offset,from)方法有两个参数,表示从from(0代表文件起始位置,1代表当前位置,2代表文件末尾)偏移offset字节。因此将文件指针设置到文件起始位置,使用seek(0,0)即可:</span><br><span class="line">&gt;&gt;&gt; f.tell()</span><br><span class="line">284</span><br><span class="line">&gt;&gt;&gt; f.seek(0,0)</span><br><span class="line">0</span><br><span class="line">&gt;&gt;&gt; f.read(5)</span><br><span class="line">&#39;小客服:小&#39;</span><br><span class="line">&gt;&gt;&gt; f.tell()</span><br><span class="line">9</span><br><span class="line">(注:因为1个中文字符占用2个字节的空间,所以4个中文加1个英文冒号刚好到位置9。)</span><br><span class="line"></span><br><span class="line">readline()方法用于在文件中读取一整行,就是从文件指针的位置向后读取,直到遇到换行符(\n)结束:</span><br><span class="line">&gt;&gt;&gt;f.readline()</span><br><span class="line">&#39;甲鱼,有个好评很好笑哈.\n&#39;</span><br><span class="line"></span><br><span class="line">此前介绍过列表的强大,说什么都可以往里放,这不,也可以把整个文件的内容放到列表中:</span><br><span class="line">&gt;&gt;&gt; list(f)</span><br><span class="line">[&#39;小甲鱼:哦?\n&#39;,小客服:&quot;有了小甲鱼,以后妈妈再也不用担心我的学习了~&quot;\n&#39;,&#39;小甲鱼:哈哈哈,我看到叮,我还发微博了呢~\n&#39;,,小客服:嗯嗯,我看了你的微博r~\n&#39;,,小甲鱼:OK~\n&#39;,小客服那个有条回复&quot;左手拿着小甲鱼,右手拿着打火机,哪里不会点哪里,so easy ~-&quot;\n&#39;,&#39;小甲鱼:TT&#39;]</span><br><span class="line"></span><br><span class="line">对于迭代读取文本文件中的每一行,有些读者可能会这么写:</span><br><span class="line">&gt;&gt;&gt; f.seek(0,0)</span><br><span class="line">0</span><br><span class="line">&gt;&gt; lines &#x3D; 1ist(f)</span><br><span class="line">&gt;&gt; for each line in lines:</span><br><span class="line">	print(each line)</span><br><span class="line">	</span><br><span class="line">这样写并没有错,但给人的感觉就像是你拿酒精灯去烧开水,水是烧得开,不过效率不是很高.因为文件对象自身是支持迭代的,所以没必要绕圈子,直接使用for语句把内容迭代读取出来即可:</span><br><span class="line">&gt;&gt;&gt; f.seek(0,0)</span><br><span class="line">0</span><br><span class="line">&gt;&gt;&gt; for each_line in f:</span><br><span class="line">		print(each_line)</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">文件的写入</span><br><span class="line">如果需要写入文件,请确保之前的打开模式有&#39;w&#39;或&#39;a&#39;,否则会出错:</span><br><span class="line">&gt;&gt;&gt;f &#x3D; open(&quot;record.txt&quot;)</span><br><span class="line">&gt;&gt;&gt;f.write(&quot;这是一段待写人的数据&quot;)</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt; pyshell#135 &gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		f.write(&quot;这是一段待写人的数据&quot;)</span><br><span class="line">io.UnsupportedOperation:not writable</span><br><span class="line">&gt;&gt; f.close()</span><br><span class="line">&gt;&gt;&gt; f &#x3D; open(&quot;record.txt&quot;,&quot;w&quot;)</span><br><span class="line">&gt;&gt; f.writel(&quot;这是一段待写人的数据&quot;)</span><br><span class="line">10</span><br><span class="line">&gt;&gt;&gt; f.close()</span><br><span class="line"></span><br><span class="line">然而一定要小心的是:使用,w&#39;模式写入文件,此前的文件内容会被全部删除!</span><br><span class="line">如果要在原来的内容上追加，一定要使用&#39;a&#39;模式打开文件哦</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">一个任务</span><br><span class="line">本节要求读者朋友独立来完成一个任务-将文件（record2.txt）中的数据进行分割并按照以下规则保存起来：</span><br><span class="line">(1)将小甲鱼的对话单独保存为boy-*.txt的文件(去掉&quot;小甲鱼:&quot;).</span><br><span class="line">(2)将小客服的对话单独保存为girl-*.txt的文件(去掉&quot;小客服:&quot;).</span><br><span class="line">(3)文件中总共有三段对话,分别保存为boy_1.txt,girl_1.txt,boy_2.txt，girl_2.txt，boy_3.txt,girl_3.txt共6个文件(提示:文件中不同的对话间已经使用&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;分割)。</span><br><span class="line">大家一定要自己先动动手再参考答案:</span><br><span class="line">#p8-1.py</span><br><span class="line">count &#x3D;1</span><br><span class="line">boy &#x3D; []</span><br><span class="line">girl &#x3D; []</span><br><span class="line">f &#x3D; open(&#39;record.txt&#39;)</span><br><span class="line">for each_line in f:</span><br><span class="line">    if each_line[:6] !&#x3D; &#39;&#x3D;&#x3D; &#x3D;&#x3D; &#x3D;&#x3D;&#39;:</span><br><span class="line">        (role, line_spoken) &#x3D; each_line.split(&#39;:&#39;, 1)</span><br><span class="line">        if role &#x3D;&#x3D;&#39;小甲鱼&#39;:</span><br><span class="line">           boy. append(line_spoken)</span><br><span class="line">        if role &#x3D; &#39;小客服&#39;:</span><br><span class="line">           girl. append(line_spoken)</span><br><span class="line">    else:</span><br><span class="line">        file_name_boy &#x3D; &#39;boy_&#39; + str(count) + &#39;.txt&#39;</span><br><span class="line">        file_name_girl &#x3D; &#39;girl_&#39; + str(count) + &#39;.txt&#39;</span><br><span class="line">        boy_file &#x3D; open(file_name_boy, &#39;w&#39;)</span><br><span class="line">        girl_file &#x3D; open(file_name girl, &#39;w&#39;)</span><br><span class="line">        boy_file.writelines ( boy)</span><br><span class="line">        girl_file.writelines(girl)</span><br><span class="line">        boy &#x3D;[]</span><br><span class="line">        girl &#x3D;[]</span><br><span class="line">        count +&#x3D; 1</span><br><span class="line">file_name_boy &#x3D; &quot;boy_&#39; + str(count) + &#39;.txt</span><br><span class="line">file_name_girl &#x3D; &#39;girl_&#39;+ str(count)+ &#39;.txt</span><br><span class="line">boy_file &#x3D;open(file_name_boy, &#39;w&#39;)</span><br><span class="line">girl_file &#x3D; open(file_name_girl, &#39;w&#39;)</span><br><span class="line">boy_file.writelines(boy)</span><br><span class="line">girl_file.writelines(girl)</span><br><span class="line">boy_file.close()</span><br><span class="line">girl_file.close()</span><br><span class="line"></span><br><span class="line">事实上可以利用函数封装得更好看一些:</span><br><span class="line">#p82.py </span><br><span class="line">def save_file(boy,girl,count):</span><br><span class="line">    file_name_boy &#x3D;&#39;boy&#39;+ str(count) + &#39;.txt </span><br><span class="line">    file_name_girl &#x3D;&#39;girl&#39;+ str(count) + &#39;.txt&#39;</span><br><span class="line">    boy_file &#x3D; open(file_name_boy,&#39;w&#39;)</span><br><span class="line">    girl_file &#x3D; open(file_name-girl,&#39;w&#39;)</span><br><span class="line">    boy_file.writelines(boy)</span><br><span class="line">    girl_file.writelines(girl)</span><br><span class="line">    boy_file.close()</span><br><span class="line">    girl_file.close()</span><br><span class="line"></span><br><span class="line">def split_file(file_name):</span><br><span class="line">    count &#x3D; 1</span><br><span class="line">    boy &#x3D;[]</span><br><span class="line">    girl &#x3D;[]</span><br><span class="line">    f&#x3D; open(file_name)</span><br><span class="line">    for each_line in f:</span><br><span class="line">        if each_line[:6] !&#x3D; &#39;&#x3D;&#x3D; &#x3D;&#x3D; &#x3D;&#x3D;&#39;:</span><br><span class="line">            (role,line_spoken)&#x3D; each_line.split(&#39;:&#39;,1)</span><br><span class="line">            if role &#x3D;&#x3D; &#39;小甲鱼&#39;:</span><br><span class="line">                boy.append(line_spoken)</span><br><span class="line">            if role &#x3D;&#x3D;&#39;小客服&#39;:</span><br><span class="line">                girl.append(line_spoken)</span><br><span class="line">        else:</span><br><span class="line">            save_file(boy,girl,count)</span><br><span class="line">            boy &#x3D;[]</span><br><span class="line">            girl &#x3D;[]</span><br><span class="line">            count +&#x3D; 1</span><br><span class="line">    save_file(boy,girl,count)</span><br><span class="line">    f.close()</span><br><span class="line">split file(&#39;record.txt&#39;)</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">文件系统：介绍一个高大上的东西</span><br><span class="line">模块是什么?其实我们写的每一个源代码文件(*.py)都是一个模块。Python自身带有非常多实用的模块,在日常编程中,如果能够熟练地掌握它们,将事半功倍</span><br><span class="line">比如刚开始介绍的文字小游戏,里边就用random模块的randint()函数来生成随机数.</span><br><span class="line">然而要使用这个randint()函数,直接就调用可不行:</span><br><span class="line">&gt;&gt;random.randint(0,9)</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt;pyshell#140&gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		random.randint(0,9)</span><br><span class="line">NameError:name&#39;random&#39;is not defined</span><br><span class="line">正确的做法应该是先使用import语句导入模块,然后再使用:</span><br><span class="line">&gt;&gt; import random</span><br><span class="line">&gt;&gt; random.randint(0,9)</span><br><span class="line">3</span><br><span class="line">&gt;&gt; random.randint(0,9)</span><br><span class="line">1</span><br><span class="line">&gt;&gt; random.randint(0,9)</span><br><span class="line">8</span><br><span class="line">首先要介绍的是高大上的OS模块,OS就是Operating System的缩写,意思是操作系统,之所以说OS模块高大上,是因为对于文件系统的访问,Python一般是通过OS模块来实现的.我们所知道常用的操作系统就有Windows,Mac OS,Linux,UNIX等,这些操作系统底层对于文件系统的访问工作原理是不一样的,因此你可能就要针对不同的系统来考虑使用哪些文件系统模块…这样的做法是非常不友好且麻烦的,因为这意味着当你的程序运行环境一旦改变,你就要相应地去修改大量的代码来应付.</span><br><span class="line"></span><br><span class="line">但是Python是跨平台的语言,也就是说,同样的源代码在不同的操作系统不需要修改就可以同样实现.有了OS模块,不需要关心什么操作系统下使用什么模块,OS模块会帮你选择正确的模块并调用。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">表8-3 Os模块中关于文件&#x2F;目录常用的函数使用方法</span><br><span class="line">函数名						使用方法</span><br><span class="line">getcwd()					返回当前工作目录</span><br><span class="line">chdir(path)					改变工作目录</span><br><span class="line">listdir(path&#x3D;&#39;.&#39;)			列举指定目录中的文件名(.&#39;表示当前目录,&#39;.&#39;表示上一级目录)</span><br><span class="line">mkdir(path)					创建单层目录,如该目录已存在抛出异常</span><br><span class="line">makedirs(path)				递归创建多层目录,如果该目录已存在则抛出异常,注意:&#39;E:\allb和&#39;E:\allc&#39;并不会冲突</span><br><span class="line">remove(path)				删除文件</span><br><span class="line">rmdir(path)					删除单层目录,如果该目录非空则抛出异常</span><br><span class="line">removedirs(path)			递归删除目录,从子目录到父目录逐层尝试删除,遇到目录非空则抛出异常</span><br><span class="line">rename(old,new)				将文件old重命名为new </span><br><span class="line">system(command)				运行系统的shell命令</span><br><span class="line">以下是支持路径操作中常用到的一些定义,支持所有平台</span><br><span class="line">os.curdir					指代当前目录(&#39;.&#39;)</span><br><span class="line">os.pardir					指代上一级目录(..&#39;)</span><br><span class="line">os.sep						输出操作系统特定的路径分隔符(在Windows下为&#39;,Linux下为&#39;&#x2F;1)</span><br><span class="line">os.linesep					当前平台使用的行终止符(在Windows下为&quot;\rn&#39;,Linux下为&quot;\n&#39;)</span><br><span class="line">os.name						指代当前使用的操作系统(包括,posix&#39;,&#39;nt&#39;,&#39;mac&#39;,&#39;os2&#39;,&#39;ce&#39;,&#39;java&#39;)</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">getcwd()</span><br><span class="line">在有些情况下我们需要获得应用程序当前的工作目录(比如要保存临时文件),那么可以使用getcwd()函数获得:</span><br><span class="line">&gt;&gt;&gt;import os</span><br><span class="line">&gt;&gt;&gt;os.getcwd()</span><br><span class="line">&#39;C:\\Fython34&#39;</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">chdir(path)</span><br><span class="line">用chdir()函数可以改变当前工作目录,比如可以切换到E盘:</span><br><span class="line">&gt;&gt;&gt;os.chdir(&quot;E:\\&quot;)</span><br><span class="line">&gt;&gt;&gt; os.getcwd()</span><br><span class="line">&quot;E:\\&quot;</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">listdir(path&#x3D;&#39;.&#39;)</span><br><span class="line">有时候你可能需要知道当前目录下有哪些文件和子目录,那么listdir()函数可以帮你列举出来。path参数用于指定列举的目录,默认值是&#39;.&#39;,代表根目录,也可以使用&#39;..&#39;代表上一层目录:</span><br><span class="line">&gt;&gt;&gt; os.listdir()</span><br><span class="line">[&#39;$ RECYCLE.BIN&#39;,&#39;Arduino&#39;,&#39;Systen Volume Information&#39;,&#39;工作室,&#39;工具箱,&#39;鱼c光盘&#39;,&#39;鱼c工作室编程教学&#39;]</span><br><span class="line">&gt;&gt;&gt; os.listdir(&quot;C:\\&quot;)</span><br><span class="line">[&#39;$ 360Section&#39;,&#39;s Recycle.Bin&#39;,&quot;360SANDBOX&#39;,&#39;Boot&#39;,&#39;bootmgr&#39;,&#39;BOOTNXT,&#39;DRHyperbootSync</span><br><span class="line">&#39;Documents and Settings&#39;,&#39;hiberfil.sys&#39;,&#39;Intel&#39;,&#39;iSee&#39;,&#39;mfg&#39;,&#39;MSOCache&#39;,&#39;OneDriveT&#39;emp&#39;pagefile.sys&#39;,&#39;PerfLogs&#39;,&#39;Program Files&#39;,&#39;Program Files(x86)&#39;,&#39;ProgramData&#39;.&#39;Python27&#39;,&quot;Python34&#39;,&#39;Recovery&#39;,&#39;Recovery.txt&#39;,&#39;swapfile.sys&#39;,&#39;System Volume Information&#39;,&#39;Userst&#39;,&quot;Windows&#39;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2020&#x2F;3&#x2F;10</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">4.mkdir(path)</span><br><span class="line">mkdir()函数用于创建文件夹,如果该文件夹存在,则抛出FileExistsError异常:</span><br><span class="line">&gt;&gt; os.mkdir(&quot;test&quot;)</span><br><span class="line">&gt;&gt;&gt; os.listdir()</span><br><span class="line">[&#39;$ RECYCLE.BIN&#39;,&#39;Arduino&#39;,&#39;System Volume Information&#39;,&#39;test&#39;,&#39;工作室&#39;,&#39;工具箱&#39;,&#39;鱼c光盘&#39;,&#39;鱼C工作室编程教学&#39;]</span><br><span class="line">&gt;&gt; os.mkdir(&quot;test&quot;)</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt;pyshell#156&gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		os.mkdir(&quot;test&quot;)</span><br><span class="line">FileExistsError:[WinError 183]当文件已存在时,无法创建该文件.:&#39;test&#39;</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">5.makedirs(path)</span><br><span class="line">makedirs()函数可以用于创建多层目录:</span><br><span class="line">&gt;&gt; os.makedirs(r&quot;.\a\b\c&quot;)</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">6.remove(path)、rmdir(path)和removedirs(path)</span><br><span class="line">remove()函数用于删除指定的文件,注意是删除文件,不是删除目录.如果要删除目录,则用rmdir()函数;如果要删除多层目录,则用removedirs()函数.</span><br><span class="line">&gt;&gt; os.listdir()</span><br><span class="line">[&#39;a&#39;,&quot;b&#39;,&#39;test.txt&#39;]</span><br><span class="line">&gt;&gt;&gt;#当前工作目录结构为a\b\c,b\,test.txt</span><br><span class="line">&gt;&gt; os.remove(&quot;test.txt&quot;)</span><br><span class="line">&gt;&gt; os.rmdir(&quot;b&quot;)</span><br><span class="line">&gt;&gt; os.removedirs(r&quot;a\b\c&quot;)</span><br><span class="line">&gt;&gt;&gt; os.listdir()</span><br><span class="line">[]</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">7.rename(old,new)</span><br><span class="line">rename()函数用于重命名文件或文件夹:</span><br><span class="line">&gt;&gt;&gt; os.listdir()</span><br><span class="line">[&#39;a&#39;,&#39;a.txt&#39;]</span><br><span class="line">&gt;&gt;&gt; os.rename(&quot;a&quot;,&quot;b&quot;)</span><br><span class="line">&gt;&gt; os.rename(&quot;a.txt&quot;,&quot;b.txt&quot;)</span><br><span class="line">&gt; os.listdir()</span><br><span class="line">[&#39;b&#39;,&#39;b.txt&#39;]</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">8.system(command)</span><br><span class="line">几乎每个操作系统都会提供一些小工具,system()函数用于使用这些小工具:</span><br><span class="line">&gt;&gt; os.systen(&quot;calc&quot;)#calc是Windows系统自带的计算器回车后即弹出计算器</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">9.walk(top)</span><br><span class="line">最后是walk()函数,这个函数在有些时候确实非常有用,可以省去你很多麻烦.该函娄的作用是遍历top参数指定路径下的所有子目录,并将结果返回一个三元组(路径,[包含目录],[包含文件]),来看下面的例子:</span><br><span class="line">&gt;&gt; for i in os.walk(&quot;test&quot;):</span><br><span class="line">	print(i)</span><br><span class="line">(&quot;test&#39;,[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,[])</span><br><span class="line">(&#39;test\\a&#39;,[],[&#39;a.txt&#39;])</span><br><span class="line">(&#39;test\\b&#39;,[&#39;bl&#39;,&#39;b2&#39;],[&#39;b.txt&#39;])</span><br><span class="line">(&quot;test\\b\\b1&#39;,[],[&#39;bl.txt&#39;])</span><br><span class="line">(&#39;test\\b\\b2&#39;,[],[&#39;b2.txt&#39;])</span><br><span class="line">(&#39;test\\c&#39;,[&#39;cl&#39;], [])</span><br><span class="line">(&#39;test\\c\\cl&#39;,[&#39;c11&#39;], [])</span><br><span class="line">(&#39;test\\c\\cl\\cll&#39;,[],[&#39;c11.txt&#39;])</span><br><span class="line"></span><br><span class="line">另外path模块还提供了一些很实用的定义,分别是:os.curdir表示当前目录;os.pardir表示上一级目录(&#39;..&#39;);os.sep表示路径的分隔符,比如Windows系统下为&#39;\\&#39;,Linux下为&#39;&#x2F;&#39;;os.linesep表示当前平台使用的行终止符(在Windows下为&#39;\r\n&#39;,Linux下为&#39;\n&#39;);os.name表示当前使用的操作系统.</span><br><span class="line">另一个强大的模块是os.path,它可以完成一些针对路径名的操作.表8-4列举了os.path中常用到的函数使用方法.</span><br><span class="line"></span><br><span class="line">表8-4 os.path模块中关于路径常用的函数使用方法</span><br><span class="line">函数名								使用方法</span><br><span class="line">basename(path)						去掉目录路径,单独返回文件名</span><br><span class="line">dirname(path)						去掉文件名,单独返回目录路径</span><br><span class="line">join(path[,path2[,...)				将path1和path2各部分组合成一个路径名</span><br><span class="line">split(path)							分割文件名与路径,返回(f-path,f-name)元组.如果完全使用目录,它也会将最后一个目录作为文件名分离,且不会判断文件或者目录是否存在</span><br><span class="line">plitext(path)						分离文件名与扩展名,返回(f-name,f-extension)元组</span><br><span class="line">getsize(file)						返回指定文件的尺寸,单位是字节</span><br><span class="line">getatime(file)						返回指定文件最近的访问时间(浮点型秒数,可用time模块的gmtime()或localtime()函数换算)</span><br><span class="line">getctime(file)						返回指定文件的创建时间(浮点型秒数,可用time模块的gmtime()或localtime()函数换算)</span><br><span class="line">getmtime(file)						返回指定文件最新的修改时间(浮点型秒数,可用time模块的gmtime()或localtime()函数换算)</span><br><span class="line">以下为函数返回True或False </span><br><span class="line">exists(path)						判断指定路径(目录或文件)是否存在</span><br><span class="line">isabs(path) 						判断指定路径是否为绝对路径</span><br><span class="line">isdir(path) 						判断指定路径是否存在且是一个目录</span><br><span class="line">isfile(path)						判断指定路径是否存在且是一个文件</span><br><span class="line">islink(path)						判断指定路径是否存在且是一个符号链接</span><br><span class="line">smount(path)						判断指定路径是否存在且是一个挂载点</span><br><span class="line">samefile(pathl,path2)               判断path1和path2两个路径是否指向同一个文件</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">10.basename(path)和dirname(path)</span><br><span class="line">basename()和dirname()函数分别用于获得文件名和路径名:</span><br><span class="line">&gt;&gt; os.path.dirname(r&quot;a\b\test.txt&quot;)</span><br><span class="line">&#39;a\\b&#39;</span><br><span class="line">&gt;&gt; os.path.basename(r&quot;a\b\text.txt&quot;)</span><br><span class="line">&#39;text.txt&#39;</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">11.join(path1[,path2[,...]])</span><br><span class="line">join()函数跟BIF的那个join()函数不同,os.path.join()是用于将路径名和文件名组合成一个完整的路径:</span><br><span class="line">&gt;&gt;&gt;os.path.join(r&quot;C:\Python34\Test&quot;,&quot;FishC.txt&quot;)</span><br><span class="line">&quot;C:\\Python34\\Test\\FishC.txt&#39;</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">12.split(path)和splitext(path)</span><br><span class="line">split()和splitext()函数都用于分割路径,split()函数分割路径和文件名(如果完全使用目录,它也会将最后一个目录作为文件名分离,且不会判断文件或者目录是否存在);splitext()函数则是用于分割文件名和扩展名:</span><br><span class="line">&gt;&gt;&gt;os.path.split(r&quot;a\b\test.txt&quot;)</span><br><span class="line">(&#39;a\\b&#39;,&#39;test.txt&#39;)</span><br><span class="line">&gt;&gt;&gt;os.path.splitext(r&quot;a\b\test.txt&quot;)</span><br><span class="line">(&#39;a\\b\test&#39;,&#39;.txt&#39;)</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">13.getsize(file)</span><br><span class="line">getsize()函数用于获取文件的尺寸,返回值是以字节为单位:</span><br><span class="line">&gt;&gt;&gt; os.chdir(r&quot;C:\Python34&quot;)</span><br><span class="line">&gt;&gt; os.path.getsize(&quot;python.exe&quot;)</span><br><span class="line">40960</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">14.getatime(file)、getctime(file)和getmtime(file)</span><br><span class="line">getatime()、getctime()和getmtime()分别用于获得文件的最近访问时间、创建时间和修改时间.不过返回值是浮点型秒数,可用time模块的gmtime()或localtime()函数换算:</span><br><span class="line">&gt;&gt;&gt;import time</span><br><span class="line">&gt;&gt;&gt;temp&#x3D; time.localtime(os.path.getatime(&quot;python.exe&quot;))</span><br><span class="line">&gt;&gt;&gt; print(&quot;python.exe被访问的时间是:&quot;,time.strftime(&quot;%d %b %Y %H:%M:%S&quot;,temp))</span><br><span class="line">python.exe被访问的时间是:27 May 2015 21:16:59</span><br><span class="line">&gt;&gt; temp&#x3D; time.localtime(os.path.getctime(&quot;python.exe&quot;))</span><br><span class="line">&gt;&gt;&gt; print(&quot;python.exe被创建的时间是:&quot;,time.strftime(&quot;%d %b  %Y %H: %M :%S&quot;,temp))</span><br><span class="line">python.exe被创建的时间是:24 Feb 2015 22:44:44</span><br><span class="line">&gt;&gt; temp &#x3D; time.localtime(os,path.getmtime(&quot;python.exe&quot;))</span><br><span class="line">&gt;&gt;&gt; print(&quot;python.exe被修改的时间是:&quot;,time.strftime(&quot;%d %b %Y %H: %M :%S&quot;,temp))</span><br><span class="line"></span><br><span class="line">python.exe被修改的时间是:24 Feb 2015 22:44:44</span><br><span class="line">还有一些函数返回布尔类型的值,具体的解释见表8-4,这里就不一一举例了</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">pickle：腌制一缸美味的泡菜</span><br><span class="line">从一个文件里读取字符串非常简单,但如果想要读取出数值,那就需要多费点儿周折.因为无论是read()方法,还是readline()方法,都是返回一个字符串,如果希望从字符串里边提取出数值的话,可以使用int()函数或float()函数把类似123或&#39;3.14&#39;这类字符串强制转换为具体的数值.</span><br><span class="line"></span><br><span class="line">此前一直在讲保存文本,然而当要保存的数据像列表、字典甚至是类的实例这些更复杂的数据类型时,普通的文件操作就会变得不知所措.也许你会把这些都转换为字符串,再写入到一个文本文件中保存起来,但是很快你就会发现要把这个过程反过来,从文本文件恢复数据对象,就变得异常麻烦了.</span><br><span class="line"></span><br><span class="line">所幸的是,Python提供了一个标准模块,使用这个模块,就可以非常容易地将列表、字典这类复杂数据类型存储为文件了.这个模块就是本节要介绍的pickle模块.</span><br><span class="line">pickle就是泡菜,腌菜的意思,相信很多女读者都对韩国泡菜尤其情有独钟.至于Python的作者为何把这么一个高大上模块命名为泡菜,我想应该是跟韩剧脱不了干系.</span><br><span class="line">好,说回这个泡菜.用官方文档中的话说,这是一个令人惊叹(amazing)的模块,它几乎可以把所有Python的对象都转化为二进制的形式存放,这个过程称为pickling,那么从二进制形式转换回对象的过程称为unpickling.</span><br><span class="line">说了这么多,还是来点干货吧:</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">说了这么,还是来点干货吧:</span><br><span class="line">#pe83.py </span><br><span class="line">import pickle </span><br><span class="line">my_list&#x3D;[123,3.14,&#39;小甲鱼,[&#39;another list&#39;]]</span><br><span class="line">pickle_file &#x3D; open(&#39;E:\\my_list.pkl&#39;,&#39;wb&#39;)</span><br><span class="line">pickle.dump(my_list,pickle_file)</span><br><span class="line">pickle_file.close()</span><br><span class="line">分析一下:这里希望把这个列表永久保存起来(保存成文件),打开的文件一定要以二进制的形式打开,后缀名倒是可以随意,不过既然是使用pickle保存,为了今后容易记忆,建议还是使用.pkl或.pickle,使用dump方法来保存数据,完成后记得保存,跟操作普通文本文件一样.</span><br><span class="line">	程序执行之后E盘会出现一个my_list.pkl的文件,用记事本打开之后显示乱码(因为它保存的是二进制形式),如图8-5所示.</span><br><span class="line">	那么在使用的时候只需用二进制模式先把文件打开,然后用load把数据加载进来:</span><br><span class="line">#p84. py </span><br><span class="line">import pickle </span><br><span class="line">pickle_file &#x3D; open(&quot;E:\\my_list.pkl&quot;,&quot;rb&quot;)</span><br><span class="line">my_list &#x3D; pickle.load(pickle_file)</span><br><span class="line">print(my_list)</span><br><span class="line"></span><br><span class="line">程序执行后又取回我们的列表啦:</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[123,3.14,&#39;小甲鱼&#39;,[&#39;another list&#39;]]</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">利用pickle模块,不仅可以保存列表,事实上pickle可以保存任何你能想象得到的东西.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">异常处理</span><br><span class="line">你不可能总是对的：程序出现逻辑错误或者用户输入不合法都会引发异常,但这些异常并不是致命的,不会导致程序崩溃死掉.可以利用Python提供的异常处理机制,在异常出现的时候及时捕获,并从内部自我消化掉.</span><br><span class="line">那么什么是异常呢?举个例子:</span><br><span class="line">#p9_1.py </span><br><span class="line">file-name &#x3D; input(&#39;请输入要打开的文件名:&#39;)</span><br><span class="line">f &#x3D; open(file_name,&#39;r&#39;)</span><br><span class="line">print(&#39;文件的内容是:&#39;)</span><br><span class="line">for each_line in f:</span><br><span class="line">print(each_line)</span><br><span class="line"></span><br><span class="line">这里当然假设用户的输入是正确的,但只要用户输入一个不存在的文件名,那么上面的代码就不堪一击:</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">请输入要打开的文件名:我为什么是一个文档.txt </span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;E:\p9_1.py&quot;,line 2,in &lt;module&gt;</span><br><span class="line">		f &#x3D; open(file_name,&#39;r&#39;)</span><br><span class="line">FileNotFoundError:[Errno 2]No such file or directory:&#39;我为什么是一个文档.txt&#39;</span><br><span class="line">上面的例子就抛出了一个FileNotFoundError异常</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">1.AssertionError：断言语句（assert）失败</span><br><span class="line">大家还记得断言语句吧？在关于分支和循环的章节里讲过。当assert这个关键字后边的条件为假的时候，程序将停止并抛出AssertionError异常。assert语句一般是在测试程序的时候用于在代码中置入检查点：</span><br><span class="line">&gt;&gt;my_list &#x3D;[&quot;小甲鱼&quot;]</span><br><span class="line">&gt;&gt; assert len(my_list)&gt;0</span><br><span class="line">&gt;&gt; my_list.pop()</span><br><span class="line">&#39;小甲鱼&#39;</span><br><span class="line">&gt;&gt; assert len(my＿list)　&gt;0</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt; pyshell#3&gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		assert len(my_list)&gt;0 </span><br><span class="line">AssertionError</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">2.AttributeError:尝试访问未知的对象属性</span><br><span class="line">当试图访问的对象属性不存在时抛出的异常:</span><br><span class="line">&gt;&gt;&gt; my_list &#x3D;[]</span><br><span class="line">&gt;&gt;&gt; my_list.fishc </span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt; pyshell#5&gt;&quot;,line 1,in &lt;module &gt;</span><br><span class="line">		my list.fishc </span><br><span class="line">AttributeError:&#39;list&#39;object has no attribute&#39;fishc&#39;</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">3.IndexError:索引超出序列的范围在使用序列的时候就常常会遇到IndexError异常,原因是索引超出序列范围的内容:</span><br><span class="line">&gt;&gt;&gt; my list&#x3D;[1,2,3]</span><br><span class="line">&gt;&gt;&gt; my list[3]</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt;pyshell#7&gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		my list[3]</span><br><span class="line">IndexError:list index out of range</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">4.KeyError:字典中查找一个不存在的关键字</span><br><span class="line">当试图在字典中查找一个不存在的关键字时就会引发KeyError异常,因此建议使用dict.get()方法:</span><br><span class="line">&gt;&gt; my_dict &#x3D;&#123;&quot;one&quot;:1,&quot;two&quot;:2,&quot;three&quot;:3&#125;</span><br><span class="line">&gt;&gt;&gt; my_dict[&quot;one&quot;]</span><br><span class="line">1</span><br><span class="line">&gt;&gt;ny dict[&quot;four&quot;]</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt;pyshell#10&gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		my_dict[&quot;four&quot;]</span><br><span class="line">KeyError:&#39;four</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">5.NameError：尝试访问一个不存在的变量</span><br><span class="line">当尝试访问一个不存在的变量时，Python会抛出NameError异常：</span><br><span class="line">&gt;&gt; fishc </span><br><span class="line">Traceback (most recent call last): </span><br><span class="line">	File &quot;&lt; pyshell#11&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">		fishc </span><br><span class="line">NameError: name &#39;fishc&#39; is not defined</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">6.OSError:操作系统产生的异常</span><br><span class="line">OSError顾名思义就是操作系统产生的异常,像打开一个不存在的文件会引发FileNotFoundError,而这个FileNotFoundError就是OSError的子类.例子上面已经演示过,这里就不再重复.</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">7.SyntaxError:Python的语法错误</span><br><span class="line">如果遇到SyntaxError是Python的语法错误,这时Python的代码并不能继续执行,你应该先找到并改正错误:</span><br><span class="line">&gt;&gt;&gt; print &quot;I love fishc.com&quot;</span><br><span class="line">SyntaxRrror:Missing parentheses in call to&#39;print&#39;</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">8.TypeError:不同类型间的无效操作</span><br><span class="line">有些类型不同是不能相互进行计算的,否则会抛出TypeError异常:</span><br><span class="line">&gt;&gt;&gt;&gt;1 + &quot;1&quot;</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt;pyshell#15&gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		1 + &quot;1&quot;</span><br><span class="line">TypeError:unsupported operand type(s) for +:&#39;int&#39; and &#39;str&#39;</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">9.ZeroDivisionError:除数为零</span><br><span class="line">地球人都知道除数不能为零,所以除以零就会引发ZeroDivisionError异常:</span><br><span class="line">&gt;&gt;&gt;5 &#x2F; 0</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt;pyshell#16&gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		5&#x2F;0</span><br><span class="line">ZeroDivisionError:division by zero</span><br><span class="line">好了,知道程序抛出异常就说明这个程序有问题,但问题并不致命,所以可以通过捕获这些异常,并纠正这些错误就行.那应该如何捕获和处理异常呢?</span><br><span class="line">异常捕获可以使用try语句来实现,任何出现在try语句范围内的异常都会被及时捕获到.try语句有两种实现形式:一种是try-except,另一种是try-finally.</span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">try-except语句</span><br><span class="line">try-except 语句格式如下：</span><br><span class="line">try：</span><br><span class="line">	检测范围</span><br><span class="line">except Exception[as reason]:</span><br><span class="line">	出现异常(Exception)后的处理代码</span><br><span class="line"></span><br><span class="line">try-except语句用于检测和处理异常,举个例子来说明这一切是如何工作的:</span><br><span class="line">#p92.py </span><br><span class="line">f &#x3D; open(&#39;我为什么是一个文档.txt&#39;)</span><br><span class="line">print(f.read())</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">以上代码在&quot;我为什么是一个文档.txt&quot;这个文档不存在的时候,Python就会报错说文件不存在:</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;E:\p92.py&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		f&#x3D; open(&#39;我为什么是一个文档.txt&#39;)</span><br><span class="line">FileNotFoundError:[Errno 2]No such file or directory:&#39;我为什么是一个文档.txt&#39;</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">显然这样的用户体验不好,因此可以这么修改:</span><br><span class="line">#p93.py </span><br><span class="line">try:</span><br><span class="line">    f&#x3D; open(&#39;我为什么是一个文档.txt&#39;)</span><br><span class="line">    print(f.read())</span><br><span class="line">    f.close()</span><br><span class="line">except OSError:</span><br><span class="line">    print(&#39;文件打开的过程中出错啦TT&#39;)</span><br><span class="line"></span><br><span class="line">上面的例子由于使用了大家习惯的语言来表述错误信息,用户体验当然会好很多:</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">文件打开的过程中出错啦TT</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"></span><br><span class="line">但是从程序员的角度来看,导致OSError异常的原因有很多(例如FileExistsError、FileNotFoundError,PermissionError等等),所以可能会更在意错误的具体内容,这里可以使用as把具体的错误信息给打印出来:</span><br><span class="line">except OSError as reason:</span><br><span class="line">     print(&#39;文件出错啦T-TYn错误原因是:&#39;+ str(reason))</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">针对不同异常设置多个except</span><br><span class="line">一个try语句还可以和多个except语句搭配,分别对感兴趣的异常进行检测处理:</span><br><span class="line">#p94.py </span><br><span class="line">try:</span><br><span class="line">   sum &#x3D;1 + &#39;1&#39;</span><br><span class="line">   f-&#x3D; open(&#39;我是一个不存在的文档.txt&quot;)</span><br><span class="line">   print(f.read())</span><br><span class="line">   f.close()</span><br><span class="line">except OSError as reason:</span><br><span class="line">   print(&#39;文件出错啦T_T\n错误原因是:&#39;+ str(reason))</span><br><span class="line">except TypeError as reason:</span><br><span class="line">   print(&#39;类型出错啦T_T\n错误原因是:&#39;+ str(reason))</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">对多个异常统一处理</span><br><span class="line">except后边还可以跟多个异常,然后对这些异常进行统一的处理:</span><br><span class="line">#p9_5.py </span><br><span class="line">try:</span><br><span class="line">    int(&#39;abe&#39;)</span><br><span class="line">    sum &#x3D;1 +&quot;11</span><br><span class="line">    f &#x3D; open(&#39;我是一个不存在的文档.txt&#39;)</span><br><span class="line">    print(f.read())</span><br><span class="line">    f.close()</span><br><span class="line">except(OSError,TypeError):</span><br><span class="line">    print(&#39;出错啦T_T\n错误原因是:&#39;+ str(reason))</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">9.2.3捕获所有异常</span><br><span class="line">如果你无法确定要对哪一类异常进行处理,只是希望在try语句块里一旦出现任何异常,可以给用户一个&quot;看得懂&quot;的提醒,那么可以这么做</span><br><span class="line">...</span><br><span class="line">except:</span><br><span class="line">   print(&#39;出错啦~&#39;)</span><br><span class="line">...</span><br><span class="line">不过通常不建议你这么做,因为它会隐藏所有程序员未想到并且未做好处理准备的错误,例如当用户输入Ctrl+C试图终止程序,却被解释为KeyboardInterrupt异常.另外要注意的是,try语句检测范围内一旦出现异常,剩下的语句将不会被执行。</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">try-finally语句</span><br><span class="line">如果&quot;我是一个不存在的文档&quot;确实存在,open()函数正常返回文件对象,但异常却发生在成功打开文件后的sum&#x3D;1 +&#39;1&#39;,语句上.此时Python将直接跳到except语句,也就是说,文件打开了,但并没有执行关闭文件的命令:</span><br><span class="line">#p96.py </span><br><span class="line">try:</span><br><span class="line">   f&#x3D;open(&#39;我是一个不存在的文档.txt&#39;)</span><br><span class="line">print(f.read())</span><br><span class="line">   sum &#x3D;1 + &#39;1&#39;</span><br><span class="line">   f.close()</span><br><span class="line">except:</span><br><span class="line">   print(&#39;出错啦&#39;)</span><br><span class="line">为了实现像这种&quot;就算出现异常,但也不得不执行的收尾工作(比如在程序崩溃前保存用户文档)&quot;，引人了finally来扩展try：</span><br><span class="line">#p9_7.py </span><br><span class="line">try:</span><br><span class="line">   f&#x3D;open(&#39;我是一个不存在的文档.txt&#39;)</span><br><span class="line">print(f.read())</span><br><span class="line">   sum &#x3D;1 + &#39;1&#39;</span><br><span class="line">except:</span><br><span class="line">   print(&#39;出错啦&#39;)</span><br><span class="line">finally:</span><br><span class="line">   f.close()</span><br><span class="line">如果try语句块中没有出现任何运行时错误,会跳过except语句块执行finally语句块的内容.如果出现异常,则会先执行except语句块的内容再执行finally语句块的内容.总之finally语句块中的内容就是确保无论如何都将被执行的内容.</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">raise语句</span><br><span class="line">有读者可能会问,我的代码能不能自己抛出一个异常呢?答案是可以的,你可以使月raise语句抛出一个异常:</span><br><span class="line">&gt;&gt; raise ZeroDivisionError </span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt;pyshell#0&gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		raise ZeroDivisionError </span><br><span class="line">ZeroDivisionError</span><br><span class="line">抛出的异常还可以带参数,表示异常的解释:</span><br><span class="line">&gt;&gt; raise ZeroDivisionError(&quot;除数不能为零!&quot;)</span><br><span class="line">Traceback(most recent call last):</span><br><span class="line">	File&quot;&lt;pyshell#2&gt;&quot;,line 1,in &lt;module&gt;</span><br><span class="line">		raise ZeroDivisionError(&quot;除数不能为零!&quot;)</span><br><span class="line">ZeroDivisionError:除数不能为零!</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">丰富的else语句</span><br><span class="line">在Python里，else语句的功能更加丰富。</span><br><span class="line">在Python中，else语句不仅能跟if语句搭，构成&quot;要么怎样，要么不怎样&quot;的句式；</span><br><span class="line">它还能跟循环语句（for语句或者while语句），构成&quot;干完了能怎样，干不完就别想怎样&quot;的句式；</span><br><span class="line">其实else语句还能够跟刚刚讲的异常处理进行搭配，构成&quot;没有问题？那就干吧&quot;的句式，下边逐个给大家解释。</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">1.要么怎样，要么不怎样</span><br><span class="line">典型的if-else搭配：</span><br><span class="line">if条件:</span><br><span class="line">  条件为真执行</span><br><span class="line">else:</span><br><span class="line">  条件为假执行</span><br><span class="line">---------------------------------------------------------------------------------------------------</span><br><span class="line">2.干完了能怎样,干不完就别想怎样</span><br><span class="line">else可以跟for和while循环语句配合使用,但else语句块只在循环完成后执行,也就是说,如果循环中间使用break语句跳出循环,那么else里边的内容就不会被执行了.举个例子:</span><br><span class="line">#p9_8.py</span><br><span class="line">def showMaxFactor (num):</span><br><span class="line">    count &#x3D;num&#x2F;&#x2F;2</span><br><span class="line">    while count &gt; 1：</span><br><span class="line">        if num  count &#x3D;&#x3D; 0：</span><br><span class="line">            print(&#39;%d最大的约数是%d&#39; % (num， count))</span><br><span class="line">            break</span><br><span class="line">        count-&#x3D;1</span><br><span class="line">    else：</span><br><span class="line">        print(&#39;%d是素数!&#39; % num)</span><br><span class="line">num &#x3D; int（input(&#39;请输入一个数:&#39;))</span><br><span class="line">showlaxFactor (num)</span><br><span class="line">这个小程序主要是求用户输入的数的最大约数,如果是素数的话就顺便提醒&quot;这是一个素数&quot;.注意要使用地板除法(count&#x3D;num&#x2F;&#x2F;2)哦,否则结果会出错.使用暴力的方法一个个尝试(num%count &#x3D;&#x3D;0),如果符合条件则打印出最大的约数,并break,同时不会执行else语句块的内容了.但如果一直没有遇到合适的条件,则会执行else语句块内容.</span><br><span class="line">for语句的用法跟while一样,这里就不重复举例了.</span><br><span class="line">-------------------------------------------------------------------------------------</span><br><span class="line">3.没有问题？那就干吧</span><br><span class="line">  else语句还能跟刚刚学的异常处理进行搭配，实现跟与循环语句搭配差不多：只要tryi句块里没有出现任何异常，那么就会执行else语句块里的内容啦。举个例子：</span><br><span class="line">#p99.py</span><br><span class="line">try:</span><br><span class="line">   int (&#39;abc&#39;)</span><br><span class="line">except ValueError as reason:</span><br><span class="line">   print(&#39;出错啦:&#39; + str(reason))</span><br><span class="line">else:</span><br><span class="line">   print(&#39;没有任何异常!&#39;)</span><br><span class="line">-------------------------------------------------------------------------------------</span><br><span class="line">简洁的with语句</span><br><span class="line">有读者可能觉着打开文件又要关闭文件，还要关注异常处理有点烦人，所以Python提了一个with语句，利用这个语句抽象出文件操作中频繁使用的try&#x2F;except&#x2F;finally相关的细节。对文件操作使用with语句，将大大减少代码量，而且你再也不用担心出现文件打开了记关闭的问题了（with会自动帮你关闭文件）。举个例子：</span><br><span class="line">#p9_10. рy</span><br><span class="line">try:</span><br><span class="line">   f &#x3D; open( &#39;data.txt&#39;, &#39;w&#39;)</span><br><span class="line">   for each_line in f:</span><br><span class="line">      print(each_line)</span><br><span class="line">except OSError as reason:</span><br><span class="line">   print(&#39;出错啦:&#39; + str(reason))</span><br><span class="line">finally:</span><br><span class="line">   f.close()</span><br><span class="line"></span><br><span class="line">使用with语句,可以改成这样:</span><br><span class="line">#p9-11.py</span><br><span class="line">try:</span><br><span class="line">   with open(&#39;data.txt&#39;,&#39;w&#39;) as f:</span><br><span class="line">      for each_line in f:</span><br><span class="line">         print(each_line)</span><br><span class="line">except OSError as reason:</span><br><span class="line">print(&#39;出错啦:&#39; +str(reason))</span><br><span class="line"></span><br><span class="line">有了with语句，就再也不用担心忘记关闭文件了。</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-------------------------------------------------------------------------------------</span></span><br><span class="line">图形用户界面入门</span><br><span class="line">本章给大家介绍图形用户界面编程,也就是平时常说的GUI(Graphical User Interface.读作[gu:i])编程,那些带有按钮、文本、输入框的窗口的编程,相信大家都不会陌生。</span><br><span class="line">目前有很多Python的GUI工具包可供选择, Python有一个非常简单的GUI工具包：EasyGui. EasyGui跟它的名字一样简单,一旦你的模块导入EasyGui,GUI操作就是一个简单地调用EasyGui函数的几个参数的问题了。</span><br><span class="line">EasyGui官网: http://easygui. sourceforge.net.</span><br><span class="line">本书配套资源: easygui-0.96.zip。</span><br><span class="line">使用标准方法安装:</span><br><span class="line"><span class="comment">--解压easygui-0.96.zip</span></span><br><span class="line"><span class="comment">--使用命令窗口切换到easygui-docs-0.96的目录下</span></span><br><span class="line"><span class="comment">--在Windows下执行C:\Python34\python.exe setup.py install</span></span><br><span class="line"><span class="comment">--在Linux或Mac下执行sudo /usr/bin/python34 setup.py install</span></span><br><span class="line">Windows下的安装界面如图10-1所示。</span><br><span class="line">图10-1 EasyGui的安装</span><br><span class="line">Microsoft uindows [版本6.3.96001</span><br><span class="line">(c) 2013 Microsoft Corporation,保留所有权利.</span><br><span class="line">C: \UsersV佳字cd C:\Python34\easygui-0.96</span><br><span class="line">C:\Python34\easygui-0.96c \Python34\python. exe setup.py <span class="keyword">install</span></span><br><span class="line">running <span class="keyword">install</span></span><br><span class="line">running <span class="keyword">build</span></span><br><span class="line">running build_py</span><br><span class="line">running insta11_1ib</span><br><span class="line">running install_egg_info</span><br><span class="line">Removing C: \Python34\Lib\site-packages \easygui<span class="number">-0.96</span>-py3<span class="number">.4</span>.egg-info</span><br><span class="line">lriting C: \Python34\Lib\site-packages\easygui<span class="number">-0.96</span>-py3<span class="number">.4</span>.egg-info</span><br><span class="line">C: \Python34\easygui<span class="number">-0.96</span>&gt;</span><br><span class="line">希望深入学习Python的读者,可以在本书配套资源中的easygui<span class="number">-0.96</span>.zip压缩包中找至EasyGui各个函数的实现源代码(下载地址<span class="keyword">http</span>://bs.fishc.com/<span class="keyword">thread</span><span class="number">-46069</span><span class="number">-1</span><span class="number">-1.</span>html).</span><br><span class="line">附件:easygui<span class="number">-0.96</span>.zip</span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------------</span></span><br><span class="line">导入EasyGui</span><br><span class="line">为了使用EasyGui这个模块,你应该先导入它.最简单的导人语句是<span class="keyword">import</span> easygui。</span><br><span class="line">如果使用这种形式导入的话,那么在使用EasyGui的函数的时候,必须在函数的前面加上前缀easygui:</span><br><span class="line">&gt;&gt; <span class="keyword">import</span> easygui</span><br><span class="line">&gt;&gt; easygui.msgbox(<span class="string">"嗨,大家好~"</span>)</span><br><span class="line">回车后即弹出消息框,如图<span class="number">10</span><span class="number">-2</span>所示.</span><br><span class="line">另一种选择是导入整个EasyGui包:<span class="keyword">from</span> easygui <span class="keyword">import</span>*,这样使得我们更容易调用EasyGui的函数,可以直接这样编写代码:</span><br><span class="line">&gt;&gt; <span class="keyword">from</span> easygui <span class="keyword">import</span>*</span><br><span class="line">&gt;&gt; msgbox(<span class="string">"嗨,小美女~"</span>)</span><br><span class="line">回车后即弹出消息框,如图<span class="number">10</span><span class="number">-3</span>所示.</span><br><span class="line">第三种方案是使用类似下边的<span class="keyword">import</span>语句(建议使用):<span class="keyword">import</span> easygui <span class="keyword">as</span> g,这样可以让你保持EasyGui的命名空间,同时减少输入字符的数量:</span><br><span class="line">&gt;&gt; <span class="keyword">import</span> easygui <span class="keyword">as</span> g</span><br><span class="line">&gt;&gt;&gt; g.msgbox(<span class="string">"嗨,鱼C~"</span>)</span><br><span class="line">回车后即弹出消息框,如图<span class="number">10</span><span class="number">-4</span>所示.</span><br><span class="line"><span class="comment">-------------------------------------------------------------------------------------</span></span><br><span class="line">使用EasyGui</span><br><span class="line">举一个简单的例子:</span><br><span class="line"><span class="comment">#p10_1. py</span></span><br><span class="line"><span class="keyword">import</span> easygui <span class="keyword">as</span> g</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">sys</span></span><br><span class="line"><span class="keyword">while</span> l:</span><br><span class="line">  g.msgbox(<span class="string">"嗨，欢迎进入第一个界面小游戏^_^“)</span></span><br><span class="line"><span class="string">  msg ="</span>请问你希望在鱼c工作室学习到什么知识呢?<span class="string">"</span></span><br><span class="line"><span class="string">  title ="</span>小游戏互动<span class="string">"</span></span><br><span class="line"><span class="string">  choices = ["</span>谈恋爱<span class="string">", "</span>编程<span class="string">", "</span>OOXX<span class="string">", "</span>琴棋书画<span class="string">"]</span></span><br><span class="line"><span class="string">  choice = g.choicebox(msg, title, choices)</span></span><br><span class="line"><span class="string">  #note that we convert choice to string, in case</span></span><br><span class="line"><span class="string">  #the user cancelled the choice, and we got None.</span></span><br><span class="line"><span class="string">  g.msgbox("</span>你的选择是:<span class="string">" + str(choice), "</span>结果<span class="string">")</span></span><br><span class="line"><span class="string">  msg = "</span>你希望重新开始小游戏吗?<span class="string">"</span></span><br><span class="line"><span class="string">  title= "</span>请选择<span class="string">"</span></span><br><span class="line"><span class="string">  if g.ccbox(msg, title): # show a Continue/Cancel dialog</span></span><br><span class="line"><span class="string">        pass # user chose Continue</span></span><br><span class="line"><span class="string">  else:</span></span><br><span class="line"><span class="string">        sys.exit(0) # user chose Cancel</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">修改默认设置</span></span><br><span class="line"><span class="string">  默认情况下显示的对话框非常大,而且字体也相对难看.这里可以手动调整EsayGui的参数修改.</span></span><br><span class="line"><span class="string">  修改位置为C:\Python34\Lib\site-packages\easygui.py</span></span><br><span class="line"><span class="string">  更改对话框尺寸;找到def choicebox,下边的rootwidth=int((screen-width*0.8))和rootheight=int((screen-height*0.5))分别改为root-width=int((screen width*0.4))和rootheight =int((screen-height*0.25))。</span></span><br><span class="line"><span class="string">  更改字体:找到PROPORTIONAL_FONT_FAMILY =("</span>MS<span class="string">","</span>Sans<span class="string">","</span>Serif<span class="string">")改为PROPORTIONAL_FONT _FAMILY=("</span>微软雅黑<span class="string">")</span></span><br><span class="line"><span class="string">  EasyGui提供了非常多的组件供我们实现一个完整的界面程序,刚才给大家演示的就是msgbox、choicebox和ccbox的用法.关于更多的组件使用,大家可以参考小甲鱼翻译改编的</span></span><br><span class="line"><span class="string">《EasyGui学习文档》:http://bbs.fishc.com/thread-46069-1-1.html</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br></pre></td><td class="code"><pre><span class="line">类和对象</span><br><span class="line">-------------------------------------------------------------------------------------</span><br><span class="line">给大家介绍对象</span><br><span class="line">  大家之前已经听说过封装的概念,把乱七八糟的数据扔进列表里边,这是一种封装,是数据层面的封装;把常用的代码段打包成一个函数,这也是一种封装,是语句层面的封装;本章学习的对象,也是一种封装的思想,不过这种思想显然要更先进一步<span class="symbol">:</span>对象的来源是模拟真实世界,把数据和代码都封装在了一起.</span><br><span class="line">打个比方,乌龟就是真实世界的一个对象,那么通常应该如何来描述这个对象呢?是不是把它分为两部分来说?</span><br><span class="line">(<span class="number">1</span>)可以从静态的特征来描述,例如,绿色的、有四条腿,<span class="number">10</span>kg重,有外壳,还有个大嘴巴,这是静态一方面的描述.</span><br><span class="line">(<span class="number">2</span>)还可以从动态的行为来描述,例如说它会爬,你如果追它,它就会跑,然后你把它逼急了,它就会咬人,被它咬到了,据说要打雷才会松开嘴巴…它的嘴巴的重要作用不是用来咬人,是用来吃东西的,然后它还会睡觉.这些都是从行为方面进行描述的.</span><br><span class="line">-------------------------------------------------------------------------------------</span><br><span class="line">对象=属性+方法</span><br><span class="line">Python中的对象也是如此,一个对象的特征称为<span class="string">"属性"</span>,一个对象的行为称为<span class="string">"方法"</span>.</span><br><span class="line">如果把<span class="string">"乌龟"</span>写成代码,将会是下边这样<span class="symbol">:</span></span><br><span class="line"><span class="comment">#p11_1.py </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Turtle</span>:</span></span><br><span class="line">  <span class="comment">#Python中的类名约定以大写字母开头</span></span><br><span class="line">  <span class="comment">#特征的描述称为属性,在代码层面来看其实就是变量</span></span><br><span class="line">  color =<span class="string">'green'</span></span><br><span class="line">  weight = <span class="number">10</span></span><br><span class="line">  legs =<span class="number">4</span></span><br><span class="line">  shell = True</span><br><span class="line">  mouth =<span class="string">'大嘴</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  #方法实际就是函数,通过调用这些函数来完成某些工作</span></span><br><span class="line"><span class="string">  def climb(self):</span></span><br><span class="line"><span class="string">    print("我正在很努力地向前爬.")</span></span><br><span class="line"><span class="string">  def run(self):</span></span><br><span class="line"><span class="string">    print("我正在飞快地向前跑.")</span></span><br><span class="line"><span class="string">  def bite(self):</span></span><br><span class="line"><span class="string">    print("咬死你咬死你!!")</span></span><br><span class="line"><span class="string">  def eat(self):</span></span><br><span class="line"><span class="string">    print("有得吃,真满足~-~")</span></span><br><span class="line"><span class="string">  def sleep( self):</span></span><br><span class="line"><span class="string">    print("困了,睡了,晚安, Zzzz")</span></span><br><span class="line"><span class="string">  以上代码定义了对象的特征(属性)和行为(方法),但还不是一个完整的对象,将定义的这些称为类(Class),需要使用类来创建一个真正的对象,这个对象就叫作这个类的一个实例(Instance),也叫实例对象(Instance Objects).</span></span><br><span class="line"><span class="string">  有些读者可能还不大理解,你可以这么想:这就好比工厂的流水线要生产一系列玩具,是不是要先做出这个玩具的模具,然后根据这个模具再进行批量生产,才得到真正的玩具?再举个例子:盖房子,是不是先要有个图纸,但光有个图纸你能不能住进去?显然不能,图纸只能告诉你这个房子长什么样,但图纸并不是真正的房子.要根据图纸用钢筋水泥建造出来的房子才能住人,另外根据一张图纸就能盖出很多的房子。好,说了这么多,那真正的实例对象怎么创建?创建一个对象,也叫类的实例化,其实非常简单:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;#先运行p11_1.py</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; tt = Turtle()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;</span></span><br><span class="line"><span class="string">  注意，类名后边跟着的小括号，这跟调用函数是一样的，所以在Python中，类名约定用大写字母开头，函数用小写字母开头，这样更容易区分。另外赋值操作并不是必需的，但如果没有把创建好的实例对象赋值给一个变量，那这个对象就没办法使用，因为没有任何引用指向这个实例，最终会被Python的垃圾收集机制自动回收。</span></span><br><span class="line"><span class="string">  那如果要调用对象里的方法，使用点操作符（.）即可，其实我们已经用了何止千百遍：</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; tt.climb()</span></span><br><span class="line"><span class="string">我正在很努力地向前爬.</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; tt.bite()</span></span><br><span class="line"><span class="string">咬死你咬死你!!</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; tt.sleep()</span></span><br><span class="line"><span class="string">困了,睡了,晚安,Zzzz</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">面向对象编程</span></span><br><span class="line"><span class="string">self是什么</span></span><br><span class="line"><span class="string">  细心的读者会发现对象的方法都会有一个self参数,那这个self到底是个什么东西呢?如果此前接触过其他面向对象的编程语言,例如C++,那么你应该很容易对号入座,Python的self其实就相当于C++的this指针.</span></span><br><span class="line"><span class="string">  这里为了照顾大部分的初学编程的读者,讲解下self到底是个什么东西.如果把类比作是图纸,那么由类实例化后的对象才是真正可以住的房子.根据一张图纸就可以设计出成千上万的房子,它们长得都差不多,但它们都有不同的主人.每个人都只能回自己的家里,陪伴自己的孩子……所以self这里就相当于每个房子的门牌号,有了self,你就可以轻松找到自己的房子.</span></span><br><span class="line"><span class="string">通过一个例子稍微感受下:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; class Ball:</span></span><br><span class="line"><span class="string">      def setName(self, name) :</span></span><br><span class="line"><span class="string">          self.name= name</span></span><br><span class="line"><span class="string">      def kick(self):</span></span><br><span class="line"><span class="string">          print("我叫 % s,噢~谁踢我?!" % self.name)</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; a = Ball()</span></span><br><span class="line"><span class="string">&gt;&gt; a.setName("飞火流星")</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;b = Ball()</span></span><br><span class="line"><span class="string">&gt;&gt; b.setName ("团队之星")</span></span><br><span class="line"><span class="string">&gt;&gt;c = Ball()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;c.setName("土豆") #乱入…</span></span><br><span class="line"><span class="string">&gt;&gt; a.kick()</span></span><br><span class="line"><span class="string">我叫飞火流星,噢~谁踢我?!</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; b.kick()</span></span><br><span class="line"><span class="string">我叫团队之星,噢~谁踢我?!</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; c.kick()</span></span><br><span class="line"><span class="string">我叫土豆,噢~谁踢我?!</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">你听说过Python的魔法方法吗</span></span><br><span class="line"><span class="string">  据说,Python的对象天生拥有一些神奇的方法,它们是面向对象的Python的一切.它们是可以给你的类增加魔力的特殊方法,如果你的对象实现了这些方法中的某一个,那么这个方法就会在特殊的情况下被Python所调用,而这一切都是自动发生的.</span></span><br><span class="line"><span class="string">  Python的这些具有魔力的方法,总是被双下划线所包围,今天就讲其中一个最基本的特殊方法:__init()__,关于其他Python的魔法方法,接下来会专门用一个章节来详细讲解.</span></span><br><span class="line"><span class="string">  通常把__init__()方法称为构造方法,__init__()方法的魔力体现在只要实例化一个对象,这个方法就会在对象被创建时自动调用(在C++里你也可以看到类似的东西,叫"构造函数")</span></span><br><span class="line"><span class="string">  其实,实例化对象时是可以传入参数的,这些参数会自动传入__init__()方法中,可以通过重写这个方法来自定义对象的初始化操作.举个例子:</span></span><br><span class="line"><span class="string">&gt;&gt;class Potato:</span></span><br><span class="line"><span class="string">    def __init__(self, name):</span></span><br><span class="line"><span class="string">        self.name = name</span></span><br><span class="line"><span class="string">    def kick(self):</span></span><br><span class="line"><span class="string">        print("我叫 % s,噢~谁踢我?!" % self.name)</span></span><br><span class="line"><span class="string">&gt;&gt; p = Potato("土豆")</span></span><br><span class="line"><span class="string">&gt;&gt; p.kick()</span></span><br><span class="line"><span class="string">我叫土豆，噢~我？！</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">公有和私有</span></span><br><span class="line"><span class="string">  一般面向对象的编程语言都会区分公有和私有的数据类型,像C++和Java们使用public和private关键字,用于声明数据是公有的还是私有的,但在Python中并没有用类似的关键字来修饰.</span></span><br><span class="line"><span class="string">  难道Python所有东西都是透明的?也不全是,默认上对象的属性和方法都是公开的,可以直接通过点操作符(.)进行访问:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; class Person:</span></span><br><span class="line"><span class="string">     name ="小甲鱼"</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; p = Person()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; p.name</span></span><br><span class="line"><span class="string">'</span>小甲鱼<span class="string">'</span></span><br><span class="line"><span class="string">  在Python中定义私有变量只需要在变量名或函数名前加上“__”两个下划线，那么这个函数或变量就会成为私有的了：</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; class Person:</span></span><br><span class="line"><span class="string">       __name = "小甲鱼</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;p = Person()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; p.__name</span></span><br><span class="line"><span class="string">Traceback (most recent call last):</span></span><br><span class="line"><span class="string">	File "&lt;pyshell#32&gt;", line 1, in &lt;module&gt;</span></span><br><span class="line"><span class="string">		P.name</span></span><br><span class="line"><span class="string">AttributeError: '</span>Person<span class="string">' object has no attribute'</span>__name<span class="string">'</span></span><br><span class="line"><span class="string">这样在外部将变量名"隐藏"起来了,理论上如果要访问,就需要从内部进行:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;class Person:</span></span><br><span class="line"><span class="string">     def __init__(self, name):</span></span><br><span class="line"><span class="string">          self.__name = nane</span></span><br><span class="line"><span class="string">     def getName(self):</span></span><br><span class="line"><span class="string">          return self.__name</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;p= Person（"小甲鱼"）</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; p.__name</span></span><br><span class="line"><span class="string">Traceback（most recent call last）：</span></span><br><span class="line"><span class="string">	File "&lt; pyshell #40&gt;"， line 1， in &lt;module&gt;</span></span><br><span class="line"><span class="string">		p.__name</span></span><br><span class="line"><span class="string">AttributeError： '</span>Person<span class="string">' object has no attribute'</span>__nane<span class="string">'</span></span><br><span class="line"><span class="string">&gt;&gt; p.getName（）</span></span><br><span class="line"><span class="string">'</span>小甲鱼<span class="string">'</span></span><br><span class="line"><span class="string">	但是你认真琢磨一下这个技术的名字name mangling(名字改编),那就不难发现其实Python只是动了一下手脚,把双下横线开头的变量进行了改名而已.实际上在外部你使用</span></span><br><span class="line"><span class="string">"类名 变量名"即可访问双下横线开头的私有变量了:</span></span><br><span class="line"><span class="string">&gt;&gt;p._erson__name</span></span><br><span class="line"><span class="string">'</span>小甲鱼<span class="string">'</span></span><br><span class="line"><span class="string">(注:Python目前的私有机制其实是伪私有,Python的类是没有权限控制的,所有变量都是可以被外部调用的.最后的这部分有些读者(尤其是没有接触过面向对象编程的读者)可能看不懂,想不明白有什么用?没事,先放着,下节讲完继承机制你就会豁然开朗了。)</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">继承</span></span><br><span class="line"><span class="string">	现在需要扩展游戏,对鱼类进行细分,有金鱼(Goldfish)、鲤鱼(Carp)、三文鱼(Salmon),还有鲨鱼(Shark),那么我们就再思考一个问题:能不能不要每次都从头到尾去重新定义一个新的鱼类呢?因为我们知道大部分鱼的属性和方法是相似的,如果有一种机制可以让这些相似的东西得以自动传递,那就方便快捷多了.没错,你猜到了,这种机制就是今天要讲的:继承.</span></span><br><span class="line"><span class="string">语法很简单:</span></span><br><span class="line"><span class="string">class类名(被继承的类):</span></span><br><span class="line"><span class="string">	...</span></span><br><span class="line"><span class="string">	被继承的类称为基类、父类或超类;继承者称为子类,一个子类可以继承它的父类的任何属性和方法.举个例子:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; class Parent:</span></span><br><span class="line"><span class="string">      def hello(self):</span></span><br><span class="line"><span class="string">         print("正在调用父类的方法."))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; class Child(Parent):</span></span><br><span class="line"><span class="string">     pass</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; p = Parent()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; p.hello()</span></span><br><span class="line"><span class="string">正在调用父类的方法…</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; c = Child()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; c.hello()</span></span><br><span class="line"><span class="string">正在调用父类的方法…</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	需要注意的是，如果子类中定义与父类同名的方法或属性，则会自动覆盖父类对应的方法或属性：</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; class Child(Parent):</span></span><br><span class="line"><span class="string">      def hello(self):</span></span><br><span class="line"><span class="string">         print("正在调用子类的方法.")</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; c = Child()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; c.hello()</span></span><br><span class="line"><span class="string">正在调用子类的方法…</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">好,那尝试来写一下刚才提到的金鱼(Goldfish)、鲤鱼(Carp)、三文鱼(Salmon),还有鲨鱼(Shark)的例子:</span></span><br><span class="line"><span class="string">#p11_2.py</span></span><br><span class="line"><span class="string">import random as r</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class Fish:</span></span><br><span class="line"><span class="string">    def __init__(self):</span></span><br><span class="line"><span class="string">        self.x = r.randint(0, 10)</span></span><br><span class="line"><span class="string">        self.y = r.randint(0, 10)</span></span><br><span class="line"><span class="string">    def move(self):</span></span><br><span class="line"><span class="string">        #这里主要演示类的继承机制,就不考虑检查场景边界和移动方向的问题</span></span><br><span class="line"><span class="string">        #假设所有鱼都是一路向西游</span></span><br><span class="line"><span class="string">        self.x -= 1</span></span><br><span class="line"><span class="string">        print("我的位置是:", self.x, self.y)</span></span><br><span class="line"><span class="string">class Goldfish(Fish):</span></span><br><span class="line"><span class="string">    pass</span></span><br><span class="line"><span class="string">class Carp(Fish):</span></span><br><span class="line"><span class="string">    pass</span></span><br><span class="line"><span class="string">class Salmon(Fish):</span></span><br><span class="line"><span class="string">    pass</span></span><br><span class="line"><span class="string">#上边几个都是食物,食物不需要有个性,所以直接继承Fish类的全部属性和方法即可</span></span><br><span class="line"><span class="string">#下边定义鲨鱼类,这个是吃货,除了继承Fish类的属性和方法,还要添加一个吃的方法</span></span><br><span class="line"><span class="string">class Shark(Fish):</span></span><br><span class="line"><span class="string">    def init(self):</span></span><br><span class="line"><span class="string">        self.hungry = True</span></span><br><span class="line"><span class="string">    def eat(self):</span></span><br><span class="line"><span class="string">        if self.hungry:</span></span><br><span class="line"><span class="string">            print("吃货的梦想就是天天有得吃^~")</span></span><br><span class="line"><span class="string">            self.hungry = False</span></span><br><span class="line"><span class="string">        else:</span></span><br><span class="line"><span class="string">            print("太撑了,吃不下!")</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;#先运行p11_2.py</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; fish = Fish()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;# 试试小鱼能不能移动</span></span><br><span class="line"><span class="string">&gt;&gt; fish.move()</span></span><br><span class="line"><span class="string">我的位置是: 5 10</span></span><br><span class="line"><span class="string">&gt; goldfish = Goldfish()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; goldfish.move()</span></span><br><span class="line"><span class="string">我的位置是: 9 10</span></span><br><span class="line"><span class="string">&gt;&gt; goldfish.move()</span></span><br><span class="line"><span class="string">我的位置是: 8 10</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;goldfish.move()</span></span><br><span class="line"><span class="string">我的位置是:7 10</span></span><br><span class="line"><span class="string">&gt;&gt; #可见金鱼确实在一路向西…</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;#下边尝试生成鲨鱼</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; shark = Shark()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;#试试这货能不能吃东西?</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; shark.eat()</span></span><br><span class="line"><span class="string">吃货的梦想就是天天有得吃^_^</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; shark.eat()</span></span><br><span class="line"><span class="string">太撑了,吃不下!</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; shark.move()</span></span><br><span class="line"><span class="string">Traceback (most recent call last);</span></span><br><span class="line"><span class="string">	File "&lt;pyshell#16&gt;", line 1, in &lt;module&gt;</span></span><br><span class="line"><span class="string">		shark. move()</span></span><br><span class="line"><span class="string">	File "E:\p11_2.py", line 13, in move</span></span><br><span class="line"><span class="string">		self.x-= 1</span></span><br><span class="line"><span class="string">AttributeError: '</span>Shark<span class="string">' object has no attribute '</span>x<span class="string">'</span></span><br><span class="line"><span class="string">	奇怪!同样是继承于Fish类,为什么金鱼(goldfish)可以移动,而鲨鱼(shark)一移动就报错呢?</span></span><br><span class="line"><span class="string">	其实这里抛出的异常说得很清楚了:Shark对象没有x属性.原因其实是这样的:在Shark类中,重写了魔法方法__init__,但新的__init__方法里边没有初始化鲨鱼的x坐标和y坐标,因此调用move方法就会出错.那么解决这个问题的方案就很明显了,应该在鲨鱼类中重写__init__方法的时候先调用基类Fish_init_方法。</span></span><br><span class="line"><span class="string">下面介绍两种可以实现的技术:</span></span><br><span class="line"><span class="string">.调用未绑定的父类方法.</span></span><br><span class="line"><span class="string">.使用super函数.</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">调用未绑定的父类方法</span></span><br><span class="line"><span class="string">调用未绑定的父类方法,听起来有些高深,但大家参考下面改写的代码就能心领神会了:</span></span><br><span class="line"><span class="string">class Shark(Fish):</span></span><br><span class="line"><span class="string">    def__init__(self):</span></span><br><span class="line"><span class="string">      Fish.__init__(self)</span></span><br><span class="line"><span class="string">      self.hungry=True</span></span><br><span class="line"><span class="string">再运行下发现鲨鱼也可以成功移动了:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;#先运行修改后的p11-2.py</span></span><br><span class="line"><span class="string">&gt;&gt;shark=Shark()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;shark.move（）</span></span><br><span class="line"><span class="string">我的位置是：7 9</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;shark.move（）</span></span><br><span class="line"><span class="string">我的位置是：6 9</span></span><br><span class="line"><span class="string">	这里需要注意的是这个self并不是父类Fish的实例对象，而是子类Shark的实例对象，</span></span><br><span class="line"><span class="string">所以这里说的未绑定是指并不需要绑定父类的实例对象，使用子类的实例对象代替即可。</span></span><br><span class="line"><span class="string">	有些读者可能不大理解，没关系，这一点都不重要！因为在Python中，有一个更好的方</span></span><br><span class="line"><span class="string">案可以取代它，就是使用super函数。</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">使用super函数</span></span><br><span class="line"><span class="string">super函数能够帮我自动找到基类的方法，而且还为我们传入了self参数，这样就不需要做这些事情了：</span></span><br><span class="line"><span class="string">#将p11-2.py鲨鱼的代码作如下修改</span></span><br><span class="line"><span class="string">class Shark(Fish):</span></span><br><span class="line"><span class="string">     def__init__(self):</span></span><br><span class="line"><span class="string">          super().__init__()</span></span><br><span class="line"><span class="string">          self.hungry=True</span></span><br><span class="line"><span class="string">运行后得到同样的结果:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;#先运行修改后的pl1-2.py</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;shark=Shark()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;shark.move()</span></span><br><span class="line"><span class="string">我的位置是:6 1</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;shark.move()</span></span><br><span class="line"><span class="string">我的位置是:5 1</span></span><br><span class="line"><span class="string">	super函数的“超级”之处在于你不需要明确给出任何基类的名字，它会自动帮您找出所有基类以及对应的方法。由于你不用给出基类的名字，这就意味着如果需要改变类继承关系，只要改变class语句里的父类即可，而不必在大量代码中去修改所有被继承的方法。</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">多重继承</span></span><br><span class="line"><span class="string">除此之外Python还支持多继承,就是可以同时继承多个父类的属性和方法:</span></span><br><span class="line"><span class="string">class 类名(父类1,父类2,父类3,…):</span></span><br><span class="line"><span class="string">       …</span></span><br><span class="line"><span class="string">举个例子:            </span></span><br><span class="line"><span class="string">&gt;&gt;&gt;class Base1:</span></span><br><span class="line"><span class="string">      def foo1(self):</span></span><br><span class="line"><span class="string">            print("我是fool,我在Basel中…")</span></span><br><span class="line"><span class="string">&gt;&gt;class Base2:</span></span><br><span class="line"><span class="string">      def foo2(self):</span></span><br><span class="line"><span class="string">            print("我是foo2,我在Base2中…")</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;class C(Basel,Base2):</span></span><br><span class="line"><span class="string">      pass</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">&gt;&gt;c=C()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;c.foo1()</span></span><br><span class="line"><span class="string">我是foo1,我在Basel中…</span></span><br><span class="line"><span class="string">&gt;&gt;c.foo2()</span></span><br><span class="line"><span class="string">我是foo2,,我在Base2中…</span></span><br><span class="line"><span class="string">	上面就是基本的多重继承语法。但多重继承其实很容易导致代码混乱，所以当你不确定是否真的必须使用多重继承的时候，请尽量避免使用它，因为有些时候会出现不可预见的BUG。</span></span><br><span class="line"><span class="string">【扩展阅读】多重继承的陷阱：钻石继承（菱形继承）问题（http://bbs.fishc.com/thread-48759-1-1.html）。</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">组合</span></span><br><span class="line"><span class="string">	前边先是学习了继承的概念，然后又学习了多重继承，但听到大牛们强调说不到必要的时候不使用多重继承。哎呀，这可让大家烦恼死了，就像上回我们有了乌龟类、鱼类，现在要求定义一个类，叫水池，水池里要有乌龟和鱼。用多重继承就显得很奇怪，因为水池和乌龟、鱼是不同物种，那要怎样才能把它们组合成一个水池的类呢？</span></span><br><span class="line"><span class="string">	在Python里其实很简单，直接把需要的类放进去实例化就可以了，这就叫组合：</span></span><br><span class="line"><span class="string">#p11_3.py</span></span><br><span class="line"><span class="string">class Turtle:</span></span><br><span class="line"><span class="string">      def__init__(self,x):</span></span><br><span class="line"><span class="string">          self.num=x</span></span><br><span class="line"><span class="string">class Fish:</span></span><br><span class="line"><span class="string">     def_init__(self,x):</span></span><br><span class="line"><span class="string">          self.num=x</span></span><br><span class="line"><span class="string">class Pool:</span></span><br><span class="line"><span class="string">     def__init__(self,x,y):</span></span><br><span class="line"><span class="string">          self.turtle=Turtle(x)</span></span><br><span class="line"><span class="string">          self.fish=Fish(y)</span></span><br><span class="line"><span class="string">     def print_num(self):</span></span><br><span class="line"><span class="string">          print("水池里总共有乌龟 %d 只,小鱼%d条!" % (self.turtle.num,self.fish.num))</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;#先运行pl1_3.py</span></span><br><span class="line"><span class="string">&gt;&gt;pool=Pool(1,10)</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;pool.print_num()</span></span><br><span class="line"><span class="string">水池里总共有乌龟1只,小鱼10条!</span></span><br><span class="line"><span class="string">Python的特性其实还支持另外一种很流行的编程模式：Mixin，有兴趣的朋友可以看看【扩展阅读】Mixin 编程机制（http://bbs.fishc.com/thread-48888-1-1.html）。</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">类、类对象和实例对象</span></span><br><span class="line"><span class="string">先来分析一段代码：</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;class C:</span></span><br><span class="line"><span class="string">	count=0</span></span><br><span class="line"><span class="string">&gt;&gt;a = C()</span></span><br><span class="line"><span class="string">&gt;&gt;b = C()</span></span><br><span class="line"><span class="string">&gt;&gt;c = C()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;print(a.count,b.count,c.count)</span></span><br><span class="line"><span class="string">0 0 0</span></span><br><span class="line"><span class="string">&gt;&gt;c.count += 10</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;print(a.count,b.count,c.count)</span></span><br><span class="line"><span class="string">0 0 10</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;C.count += 100</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;print(a.count,b.count,c.count)</span></span><br><span class="line"><span class="string">100 100 10</span></span><br><span class="line"><span class="string">	从上面的例子可以看出，对实例对象c的count属性进行赋值后，就相当于覆盖了类对象C的count属性。如图11-1所示，如果没有赋值覆盖，那么引用的是类对象的count属性。</span></span><br><span class="line"><span class="string">	需要注意的是，类中定义的属性是静态变量，也就是相当于C语言中加上static关键字声明的变量，类的属性是与类对象进行绑定，并不会依赖任何它的实例对象。这点待会儿继续讲解。</span></span><br><span class="line"><span class="string">类、类对象和实例对象</span></span><br><span class="line"><span class="string">类定义			C</span></span><br><span class="line"><span class="string">类对象			C</span></span><br><span class="line"><span class="string">实例对象	a	b	c</span></span><br><span class="line"><span class="string">	另外，如果属性的名字跟方法名相同，属性会覆盖方法：</span></span><br><span class="line"><span class="string">class C;</span></span><br><span class="line"><span class="string">    def x(self):</span></span><br><span class="line"><span class="string">        print('</span>Xman<span class="string">')</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;c = C()</span></span><br><span class="line"><span class="string">&gt;&gt;c.x()</span></span><br><span class="line"><span class="string">Xman</span></span><br><span class="line"><span class="string">&gt;&gt;c.x=1</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;c.x</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;c.x()</span></span><br><span class="line"><span class="string">Traceback(most recent call last):</span></span><br><span class="line"><span class="string">    File"&lt;pyshel1#20&gt;",1ine 1, in&lt;module&gt;</span></span><br><span class="line"><span class="string">        c.x()</span></span><br><span class="line"><span class="string">TypeError:'</span>int<span class="string">' object is not callable</span></span><br><span class="line"><span class="string">为了避免名字上的冲突，大家应该遵守一些约定俗成的规矩：</span></span><br><span class="line"><span class="string">-类的定义要“少吃多餐”，不要试图在一个类里边定义出所有能想到的特性和方法，应该利用继承和组合机制来进行扩展。</span></span><br><span class="line"><span class="string">-用不同的词性命名，如属性名用名词、方法名用动词，并使用骆驼命名法 等。</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">到底什么是绑定</span></span><br><span class="line"><span class="string">	Python严格要求方法需要有实例才能被调用，这种限制其实就是Python所谓的绑定概念。前面也粗略地解释了一下绑定，但有些读者可能会这么尝试，然后发现也可以调用：</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;class BB:</span></span><br><span class="line"><span class="string">      def printBB():</span></span><br><span class="line"><span class="string">            print ("no zuo no die")</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; BB.printBB()</span></span><br><span class="line"><span class="string">no zuo no die</span></span><br><span class="line"><span class="string">但这样做会有一个问题,就是根据类实例化后的对象根本无法调用里边的函数:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;bb=BB()</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;bb.printBB()</span></span><br><span class="line"><span class="string">Traceback (most recent call last):</span></span><br><span class="line"><span class="string">      File "&lt;pyshell#8&gt;", line 1, in &lt;module&gt;</span></span><br><span class="line"><span class="string">            bb.printBB()</span></span><br><span class="line"><span class="string">      TypeError: printBB() takes O positional arguments but 1 was given	</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	实际上由于Python的绑定机制,这里自动把bb对象作为第一个参数传入,所以才会出现TypeError</span></span><br><span class="line"><span class="string">	为了让大家更好地理解,再深入挖一挖:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;class CC:</span></span><br><span class="line"><span class="string">      def setxy(self, x, y)</span></span><br><span class="line"><span class="string">            self.x=x</span></span><br><span class="line"><span class="string">            self. y =y</span></span><br><span class="line"><span class="string">      def printXY(self):</span></span><br><span class="line"><span class="string">            print(self.x, self.y)</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;dd=CC()</span></span><br><span class="line"><span class="string">可以使用__dict__查看对象所拥有的属性:</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;dd.__dict__</span></span><br><span class="line"><span class="string">&#123;&#125;</span></span><br><span class="line"><span class="string">&gt;&gt; CC.__dict__</span></span><br><span class="line"><span class="string">mappingproxy(&#123;'</span><span class="symbol">__dict__:</span>&lt;attribute<span class="string">'__dict__'</span>of <span class="string">'CC'</span> objects&gt;,<span class="string">'printXY'</span><span class="symbol">:&lt;function</span> CC. printxy at <span class="number">0x02D2D2B8</span>&gt;,<span class="string">'__weakref__'</span><span class="symbol">:&lt;attribute</span>, <span class="string">'__weakref__'</span> of <span class="string">'CC'</span> objects&gt;,<span class="string">'setxY'</span>: &lt;function CC.setXY at <span class="number">0x02AC1420</span>&gt;,<span class="string">'__doc__'</span>: None,<span class="string">'__module__'</span><span class="symbol">:<span class="string">'__main__'</span></span>&#125;)</span><br><span class="line">__dict_<span class="number">_</span>属性是由一个字典组成,字典中仅有实例对象的属性,不显示类属性和特殊属性,键表示的是属性名,值表示属性相应的数据值。</span><br><span class="line"><span class="meta">&gt;&gt;</span> dd.setXY(<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; dd.__dict_<span class="number">_</span></span><br><span class="line">&#123;<span class="string">'x'</span><span class="symbol">:</span><span class="number">4</span>,<span class="string">'y'</span><span class="symbol">:</span><span class="number">5</span>&#125;</span><br><span class="line">现在实例对象dd有了两个新属性,而且这两个属性仅属于实例对象的<span class="symbol">:</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>CC.__dict_<span class="number">_</span></span><br><span class="line">mappingproxy(<span class="string">'__doc__:None,'</span>__dict_<span class="number">_</span><span class="string">':&lt;attribute'</span>__dict_<span class="number">_</span><span class="string">' of '</span>CC<span class="string">' objects &gt;, '</span><span class="symbol">__weakref__:</span>&lt;attribute<span class="string">'__weakref__'</span> of <span class="string">'CC'</span> objects&gt;, <span class="string">'printXy'</span>: &lt; function CC.printXY at <span class="number">0x0370D2B8</span>&gt;,<span class="string">'__module__'</span>,<span class="string">'__main__'</span>,<span class="string">'setxy'</span>: &lt;function CC.setxY at <span class="number">0x034A1420</span>&gt;&#125;)</span><br><span class="line">为什么会这样呢?完全是归功于<span class="keyword">self</span>参数<span class="symbol">:</span>当实例对象dd去调用setXY方法的时候,它传入的第一个参数就是dd,那么<span class="keyword">self</span>.x = <span class="number">4</span>, <span class="keyword">self</span>.y=<span class="number">5</span>也就相当于dd.x=<span class="number">4</span>, dd.y=<span class="number">5</span>,所以你在实例对象,甚至类对象中都看不到x和y,因为这两个属性是只属于实例对象dd的.</span><br><span class="line">接着再深入一下,请思考<span class="symbol">:</span>如果我把类实例删除掉,实例对象dd还能否调用printXY方法?</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; del CC</span><br><span class="line">	答案是可以的<span class="symbol">:</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; cc.printXY()</span><br><span class="line"><span class="number">4</span> <span class="number">5</span></span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">一些相关的BIF</span><br><span class="line">下面介绍与类和对象相关的一些BIF（内置函数）。</span><br><span class="line"><span class="number">1</span>.issubclass(<span class="class"><span class="keyword">class</span>,<span class="title">classinfo</span>)</span></span><br><span class="line">如果第一个参数(<span class="class"><span class="keyword">class</span>)是第二个参数(<span class="title">classinfo</span>)的一个子类,则返回<span class="title">True</span>,否则返回<span class="title">False</span>:</span></span><br><span class="line">(<span class="number">1</span>)一个类被认为是其自身的子类.</span><br><span class="line">(<span class="number">2</span>)classinfo可以是类对象组成的元组,只要<span class="class"><span class="keyword">class</span>是其中任何一个候选类的子类,则追回<span class="title">True</span>.</span></span><br><span class="line">(<span class="number">3</span>)在其他情况下,会抛出一个TypeError异常</span><br><span class="line"><span class="meta">&gt;&gt;</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">	pass</span><br><span class="line"><span class="meta">&gt;&gt;</span> <span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="title">A</span>):</span></span><br><span class="line">	pass</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; issubclass(B, A)</span><br><span class="line">True</span><br><span class="line"><span class="meta">&gt;&gt;</span> issubclass(B, B)</span><br><span class="line">True</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; issubclass(B,object) <span class="comment"># object是所有类的基类</span></span><br><span class="line">True</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="class"><span class="keyword">class</span> <span class="title">C</span>: </span></span><br><span class="line">	pass</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; issubclass(B, C)</span><br><span class="line">False</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"><span class="number">2</span>. isinstance(object, classinfo)</span><br><span class="line">如果第一个参数(object)是第二个参数(classinfo)的实例对象,则返回True,否则返回<span class="symbol">False:</span></span><br><span class="line">(<span class="number">1</span>)如果object是classinfo的子类的一个实例,也符合条件.</span><br><span class="line">(<span class="number">2</span>)如果第一个参数不是对象,则永远返回False.</span><br><span class="line">(<span class="number">3</span>) classinfo可以是类对象组成的元组,只要<span class="class"><span class="keyword">class</span>是其中任何一个候选类的子类,则返回<span class="title">True</span>.</span></span><br><span class="line">(<span class="number">4</span>)如果第二个参数不是类或者由类对象组成的元组,会抛出一个TypeError异常.</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; issubclass(B, C)</span><br><span class="line">False</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;b1 = B()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;isinstance(b1, B)</span><br><span class="line">True</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;isinstance(b1, c)</span><br><span class="line">False</span><br><span class="line"><span class="meta">&gt;&gt;</span> isinstance(b1, A)</span><br><span class="line">True</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;isinstance(b1, (A, B, C))</span><br><span class="line">True</span><br><span class="line">Python提供以下几个BIF用于访问对象的属性.</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"><span class="number">3</span>. hasattr(object, name)</span><br><span class="line">attr即attribute的缩写,属性的意思.接下来将要介绍的几个BIF都是跟对象的属性有关系的,例如这个hasattr()的作用就是测试一个对象里是否有指定的属性.</span><br><span class="line">·第一个参数(object)是对象,第二个参数(name)是属性名(属性的字符串名字),举个</span><br><span class="line">例子<span class="symbol">:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">init</span> <span class="params">(<span class="keyword">self</span>, x=<span class="number">0</span>)</span></span><span class="symbol">:</span></span><br><span class="line">          <span class="keyword">self</span>.x =x</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;c1 =C()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;hasattr(c1, <span class="string">'x'</span>) <span class="comment">#注意,属性名要用引号括起来</span></span><br><span class="line">True</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"><span class="number">4</span>.getattr(object,name[,default])</span><br><span class="line">	返回对象指定的属性值,如果指定的属性不存在,则返回default(可选参数)的值;若没有设置 default参数,则抛出ArttributeErrorr异常。</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;getattr(c1,<span class="string">'x'</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;</span> getattr(c1,<span class="string">'y'</span>)</span><br><span class="line">Traceback(most recent call last)<span class="symbol">:</span></span><br><span class="line">	File<span class="string">"&lt;pyshell#7&gt;"</span>,line <span class="number">1</span>,<span class="keyword">in</span> &lt;<span class="class"><span class="keyword">module</span>&gt;</span></span><br><span class="line">		getattr(cl,<span class="string">'y'</span>)</span><br><span class="line"><span class="symbol">AttributeRrror:</span><span class="string">'C'</span>object has no attribute<span class="string">'y'</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; getattr(c1,<span class="string">'y'</span>,<span class="string">'您所访问的属性不存在...'</span>))</span><br><span class="line"><span class="string">'您所访问的属性不存在...'</span></span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"><span class="number">5</span>.setattr(object,name,value)</span><br><span class="line">	与getattr()对应,setattr()可以设置对象中指定属性的值,如果指定的属性不存在,则会新建属性并赋值。</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; setattr(c1,<span class="string">'y'</span>,<span class="string">'FishC'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; getattr(c1,<span class="string">'y'</span>)</span><br><span class="line"><span class="string">'Fishc'</span></span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"><span class="number">6</span>.delattr(object,name)</span><br><span class="line">	与setattr()相反,delattr()用于删除对象中指定的属性,如果属性不存在,则抛出AttributeError异常。</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; delattr(c1,<span class="string">'y'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; delattr(c1,<span class="string">'z'</span>)</span><br><span class="line">Traceback(most recent call last)<span class="symbol">:</span></span><br><span class="line">	File<span class="string">"&lt;pyshell#9&gt;"</span>,line <span class="number">1</span>,<span class="keyword">in</span> &lt;<span class="class"><span class="keyword">module</span>&gt;</span></span><br><span class="line">		delattr(c1,<span class="string">'z'</span>)</span><br><span class="line"><span class="symbol">AttributeError:</span>z</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line"><span class="number">7</span>. property(fget = None, fset = None, fdel = None, doc= None)</span><br><span class="line">俗话说<span class="symbol">:</span>条条大路通罗马.同样是完成一件事, Python其实提供了好几个方式供你选择.property()是一个比较奇葩的BIF,它的作用是通过属性来设置属性.说起来有点绕,看一下例子<span class="symbol">:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>, size =<span class="number">10</span>)</span></span><span class="symbol">:</span></span><br><span class="line">      <span class="keyword">self</span>.size = size</span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">getsize</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">self</span>.size</span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">setSize</span><span class="params">(<span class="keyword">self</span>,value)</span></span><span class="symbol">:</span></span><br><span class="line">      <span class="keyword">self</span>.size = value</span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">delSize</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">      del <span class="keyword">self</span>.size</span><br><span class="line">   x = property(getSize, setSize, delSize)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;c.x</span><br><span class="line"><span class="number">10</span></span><br><span class="line">&gt;c.x=<span class="number">12</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>c.x</span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>c.size</span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="meta">&gt;&gt;</span> del c.x</span><br><span class="line"><span class="meta">&gt;&gt;</span>c.size</span><br><span class="line">Traceback (most recent call last)<span class="symbol">:</span></span><br><span class="line">      File <span class="string">"&lt;pyshell#20&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt; <span class="class"><span class="keyword">module</span>&gt;</span></span><br><span class="line">            c. size</span><br><span class="line"><span class="symbol">AttributeError:</span> <span class="string">'C'</span> object has no attribute <span class="string">' size'</span></span><br><span class="line">	property()返回一个可以设置属性的属性,当然如何设置属性还是需要人为来写代码.第一个参数是获得属性的方法名(例子中是getSize),第二个参数是设置属性的方法名(例子中是setSize),第三个参数是删除属性的方法名(例子中是delSize).</span><br><span class="line">	property()有什么作用呢?举个例子,在上面的例题中,为用户提供setSize方法名来设置size属性,并提供getSize方法名来获取属性.但是有一天你心血来潮,突然想对程序进行大改,就可能需要把setSize和getSize修改为setXSize和getXSize,那就不得不修改用户调用</span><br><span class="line">的接口,这样的体验非常不好</span><br><span class="line">	有了property(),所有问题就迎刃而解了,因为像上边一样,为用户访问size属性只提供了x属性.无论内部怎么改动,只需要相应的修改property()的参数,用户仍然只需要去操作x属性即可,没有任何影响.</span><br><span class="line">	很神奇是吧?想知道它是如何工作的?学完紧接着要讲的魔法方法,你就知道了.</span><br></pre></td></tr></table></figure>

<h1 id="第12章-魔法方法"><a href="#第12章-魔法方法" class="headerlink" title="第12章 魔法方法"></a>第12章 魔法方法</h1><h2 id="12-1-构造和析构"><a href="#12-1-构造和析构" class="headerlink" title="12.1 构造和析构"></a>12.1 构造和析构</h2><p>​    在此之前,已经接触过Python最常用的魔法方法,小甲鱼也把魔法方法说得神乎其神,似乎用了就可以化腐朽为神奇,化干戈为玉帛,化不可能为可能!<br>​    说的这么厉害,那什么是魔法方法呢?</p>
<ul>
<li>魔法方法总是被双下划线包围,例如<strong>init</strong>()</li>
<li>魔法方法是面向对象的Python的一切,如果你不知道魔法方法,说明你还没能意识到面向对象的Python的强大。</li>
<li>魔法方法得而”魔力”体现在它们总能够在适当的时候被调用.</li>
</ul>
<h3 id="12-1-1-init-self"><a href="#12-1-1-init-self" class="headerlink" title="12.1.1 _init_ (self[,..])"></a>12.1.1 _<em>init_</em> (self[,..])</h3><p>​    之前我们讨论过 __init__()方法,说它相当于其他面向对象编程语言的构造方法,也就是类在实例化成对象的时候首先会调用的一个方法.<br>​    有读者可能会问:”有时候在类定义时写_<em>init_</em>()方法,有时候却没有,这是为什么呢?”<br>这是我在论坛中看到的一个问题,我想应该不仅只有一位朋友有疑惑,所以在这里解释下:在现实生活中,有一种东西迫使我们去努力拼搏,使我们获得创造力和生产力,使我们不惜背井离乡来到一个陌生的城市承受孤独和寂寞,这个东西就叫需求….,我想我已经很好地回答了这个问题.举个例子:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#p12_1.py</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span>:</span></span><br><span class="line">	<span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">	定义一个矩形类,</span></span><br><span class="line"><span class="string">	需要长和宽两个参数,</span></span><br><span class="line"><span class="string">	拥有计算周长和面积两个方法.</span></span><br><span class="line"><span class="string">	需要对象在初始化的时候拥有"</span>长<span class="string">"和"</span>宽<span class="string">"两个参数,</span></span><br><span class="line"><span class="string">	因此需要重写__init__()方法,因为我们说过,</span></span><br><span class="line"><span class="string">	__init__()方法是类在实例化成对象的时候首先会调用的一个方法,</span></span><br><span class="line"><span class="string">	大家可以理解吗?</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>,x, y)</span></span><span class="symbol">:</span></span><br><span class="line">     <span class="keyword">self</span>.x= x</span><br><span class="line">     <span class="keyword">self</span>.y = y</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPeri</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">     <span class="keyword">return</span> (<span class="keyword">self</span>.x + <span class="keyword">self</span>.y) * <span class="number">2</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getArea</span><span class="params">(<span class="keyword">self</span>)</span></span>;</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">self</span>.x * <span class="keyword">self</span>.y</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="comment">#先运行p12_1.py</span></span><br><span class="line"><span class="meta">&gt;&gt;</span> rect = Rectangle(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span> rect.getPeri()</span><br><span class="line"><span class="number">14</span></span><br><span class="line"><span class="meta">&gt;&gt;</span> rect.getArea()</span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">这里需要注意的是, __init_<span class="number">_</span>()方法的返回值一定是None,不能是其他<span class="symbol">:</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;<span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"A for A-Cup"</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;cup = A()</span><br><span class="line">Traceback (most recent call last)<span class="symbol">:</span></span><br><span class="line">    File <span class="string">"&lt;pyshell#17&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;<span class="class"><span class="keyword">module</span>&gt;</span></span><br><span class="line">        сup = A()</span><br><span class="line"><span class="symbol">TypeError:</span> _init () should <span class="keyword">return</span> None, <span class="keyword">not</span> <span class="string">'str'</span></span><br><span class="line">所以一般在需要进行初始化的时候才重写__init_<span class="number">_</span>()方法,现在大家应该就可以理解造物者的逻辑了.但是你要知道,神之所以是神,是因为他做什么事都留有一手.其实,这个__init_<span class="number">_</span>()并不是实例化对象时第一个被调用的魔法方法。</span><br></pre></td></tr></table></figure>

<h3 id="12-1-2-new-cls-…"><a href="#12-1-2-new-cls-…" class="headerlink" title="12.1.2 _new_(cls[,…])"></a>12.1.2 _<em>new_</em>(cls[,…])</h3><p>​    __new__()才是在一个对象实例化的时候所调用的第一个方法.它跟其他魔法方法不同,它的第一个参数不是self而是这个类(cls),而其他的参数会直接传递给__init__()方法的.<br>​    __new__()方法需要返回一个实例对象,通常是cls这个类实例化的对象,当然你也可以返回其他对象。<br>​    __new__()方法平时很少去重写它,一般让Python用默认的方案执行就可以了.但是有一种情况需要重写这个魔法方法,就是当继承一个不可变的类型的时候,它的特性就显得尤为重要了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CapStr</span><span class="params">(str)</span>:</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, string)</span>:</span></span><br><span class="line">          string = string.upper()</span><br><span class="line">          <span class="keyword">return</span> str.__new__(cls, string)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = CapStr(<span class="string">"I love FishC.com"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'I LOVE FISHC.COM'</span></span><br></pre></td></tr></table></figure>

<p>​    这里返回str.__new__(cls,string)这种做法是值得推崇的,只需要重写我们关注的那部分内容,然后其他的琐碎东西交给Python的默认机制去完成就可以了,毕竟它们出错的几率要比我们自己写小得多。</p>
<h3 id="12-1-3-del-self"><a href="#12-1-3-del-self" class="headerlink" title="12.1.3 __del__(self)"></a>12.1.3 __del__(self)</h3><p>​    如果说__init__()和__new__() 方法是对象的构造器的话,那么Python也提供了一个析构器,叫作__del__()方法.当对象将要被销毁的时候,这个方法就会被调用.但一定要注意的是,并非del x就相当于自动调用x.__de__(),__del__()方法是当垃圾回收机制回收这个对象的时候调用的.举个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">c</span></span></span><br><span class="line"><span class="class">    <span class="title">def</span>  <span class="title">init</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"我是__init__方法,我被调用了..."</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del_</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"我是__del__方法,我被调用了..."</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;c1 = C()</span><br><span class="line">&gt;&gt;&gt;我是__init__方法,我被调用了…</span><br><span class="line">&gt;&gt;&gt;c2 = c1</span><br><span class="line">&gt;&gt;&gt;c3 = c2</span><br><span class="line">&gt;&gt;&gt;<span class="keyword">del</span> c1</span><br><span class="line">&gt;&gt;&gt;<span class="keyword">del</span> c2</span><br><span class="line">&gt;&gt;&gt;<span class="keyword">del</span> c3</span><br><span class="line">我是__del__方法,我被调用了…</span><br></pre></td></tr></table></figure>

<h3 id="12-2-算数运算"><a href="#12-2-算数运算" class="headerlink" title="12.2 算数运算"></a>12.2 算数运算</h3><p>​    现在来讲一个新的名词:工厂函数,不知道大家还有没有听过?其实在老早就一直在使用它,但由于那时候还没有学习类和对象,我知道那时候说了也是白说。但我知道现在来告诉大家,理解起来就不再是问题了。<br>​    Python2.2以后,对类和类型进行了统一,做法就是将int() 、float() 、str()、list()、 tuple()这些BIF转换为工厂函数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;type(len)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">builtin</span> <span class="title">function</span> <span class="title">or</span> <span class="title">methad</span>'&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt;<span class="title">type</span><span class="params">(int)</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">type</span>'&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt;<span class="title">type</span><span class="params">(dir)</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">builtin</span> <span class="title">function</span> <span class="title">or</span> <span class="title">method</span>'&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt;<span class="title">type</span><span class="params">(list)</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">type</span>'&gt;</span></span><br><span class="line">	看到没有,普通的BIF应该是&lt;class 'builtin-function-or-method'&gt;,而工厂函数则是&lt;class 'type'&gt;。大家有没有觉得这个&lt;class 'type'&gt;很眼熟,在哪里看过?没错啦,如果定义一个类:</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">	<span class="keyword">pass</span></span><br><span class="line">&gt;&gt; type(C)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">type</span>'&gt;</span></span><br><span class="line">	它的类型也是type类型,也就是类对象,其实所谓的工厂函数,其实就是一个类对象.当你调用它们的时候,事实上就是创建一个相应的实例对象:</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = int (<span class="string">'1231'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = int(<span class="string">'3451'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a+b</span><br><span class="line"><span class="number">468</span></span><br><span class="line">	现在你是不是豁然发现:原来对象是可以进行计算的!其实你早该发现这个问题了,Python中无处不对象,当在求a+b等于多少的时候,事实上Python就是在将两个对象进行相加操作.Python的魔法方法还提供了自定义对象的数值处理,通过对下面这些魔法方法的重写,可以自定义任何对象间的算术运算。</span><br></pre></td></tr></table></figure>

<h4 id="12-2-1-算数运算"><a href="#12-2-1-算数运算" class="headerlink" title="12.2.1 算数运算"></a>12.2.1 算数运算</h4><p>表12-1列举了算数运算相关的魔法方法。</p>
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>__add__ (self, other)</td>
<td>定义加法的行为：+</td>
</tr>
<tr>
<td>__sub__(self, other)</td>
<td>定义减法的行为：-</td>
</tr>
<tr>
<td>__mul__(self, other)</td>
<td>定义乘法的行为：*</td>
</tr>
<tr>
<td>__truediv__(self, other)</td>
<td>定义真除法的行为：/</td>
</tr>
<tr>
<td>__floordiv__(self, other)</td>
<td>定义整数除法的行为： //</td>
</tr>
<tr>
<td>__mod__(self, other)</td>
<td>定义取模算法的行为： %</td>
</tr>
<tr>
<td>__divmod__(self, other)</td>
<td>定义当被divmod()调用时的行为</td>
</tr>
<tr>
<td>__pow__(self, other, modulo])</td>
<td>定义当被power()调用或**运算时的行为</td>
</tr>
<tr>
<td>__Ishift__(self, other)</td>
<td>定义按位左移位的行为：&lt;&lt;</td>
</tr>
<tr>
<td>__rshift__(self, other)</td>
<td>定义按位右移位的行为：&gt;&gt;</td>
</tr>
<tr>
<td>__and__(self, other)</td>
<td>定义按位与操作的行为： &amp;</td>
</tr>
<tr>
<td>__xor__(self, other)</td>
<td>定义按位异或操作的行为：^</td>
</tr>
<tr>
<td>__or__(self, other)</td>
<td>定义按位或操作的行为：|</td>
</tr>
</tbody></table>
<p>举个例子,下面定义一个比较特立独行的类:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="class"><span class="keyword">class</span> <span class="title">New</span> <span class="title">int</span><span class="params">(int)</span>:</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">add</span> <span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> int.sub (self, other)</span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">sub</span> <span class="params">(self, other)</span></span></span><br><span class="line"><span class="function">        <span class="title">return</span> <span class="title">int</span>. <span class="title">add</span> <span class="params">(self, other)</span></span></span><br><span class="line">&gt;&gt;&gt;a = New int(3)</span><br><span class="line">&gt;&gt;&gt;b = New int(<span class="number">5</span>)</span><br><span class="line">&gt;&gt;&gt;a + b</span><br><span class="line"><span class="number">-2</span></span><br><span class="line">&gt;&gt;&gt;a - b</span><br><span class="line"><span class="number">8</span></span><br></pre></td></tr></table></figure>

<p>​    那有些读者可能会问:我想自己写代码,不想通过调用Python默认的方案行不行?答案是肯定行,但要格外小心!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Try_int</span><span class="params">( int)</span>:</span></span><br><span class="line">      <span class="function"><span class="keyword">def</span> <span class="title">__add_</span><span class="params">(self, other)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> self + other</span><br><span class="line">      <span class="function"><span class="keyword">def</span> <span class="title">__sub_</span><span class="params">(self, other)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> self - other</span><br><span class="line">&gt;&gt;a = Try_int(<span class="number">1</span>)</span><br><span class="line">&gt;&gt;&gt;b = Try_int(<span class="number">3</span>)</span><br><span class="line">&gt;&gt;a + b</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">	File <span class="string">"&lt;pyshell#9&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">		a + b</span><br><span class="line">	File <span class="string">"&lt;pyshell#6&gt;"</span>, line <span class="number">3</span>, <span class="keyword">in</span> __add__</span><br><span class="line">		<span class="keyword">return</span> self + other</span><br><span class="line">	File <span class="string">"&lt;pyshell#6&gt;"</span>, line <span class="number">3</span>, <span class="keyword">in</span> __add__</span><br><span class="line">		<span class="keyword">return</span> self + other</span><br><span class="line">	<span class="comment">#此处省略很多行…</span></span><br><span class="line">为什么会陷入无限递归呢?问题就出在这里:</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">add_</span><span class="params">(self, other)</span>:</span></span><br><span class="line">		<span class="keyword">return</span> self + other</span><br></pre></td></tr></table></figure>

<p>​    当对象涉及加法操作时,自动调用魔法方法__add__(),但看看上边的魔法方法写的是什么?写的是return self + other,也就是返回对象本身加另外一个对象,这不就又自动触发调用__add__()方法了吗?这样就形成了无限递归。所以,像下面这么写就不会触发无限递归了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="class"><span class="keyword">class</span> <span class="title">New</span> <span class="title">int</span><span class="params">(int)</span>:</span></span><br><span class="line">       <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">              <span class="keyword">return</span> int(self) + int(other)</span><br><span class="line">       <span class="function"><span class="keyword">def</span> <span class="title">__sub__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">              <span class="keyword">return</span> int(self) - int(other)</span><br><span class="line">&gt;&gt;&gt;a = New int(<span class="number">1</span>)</span><br><span class="line">&gt;&gt;&gt;b = New int(<span class="number">3</span>)</span><br><span class="line">&gt;&gt;&gt;a + b</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>

<p>​    上边介绍了很多有关算术运算的魔法方法,意思是当对象进行了相关的算术运算,自然而然就会自动触发对应的魔法方法.嘿,有悟性的读者就会说: “哇,我似乎感觉到拥有了上帝的力量.没错吧?”<br>​    Python正是如此,对于初学者,他们不知道魔法方法,所以默认的魔法方法会让他们以合乎逻辑的形式运行.但当你逐步深入学习,慢慢有了沉淀之后,你突然发现如果有更多的灵活性,就可以把程序写得更好…这时候, Python也可以满足你.通过对指定魔法方法的重写,<br>你完全可以让Python根据你的意愿去执行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="class"><span class="keyword">class</span> <span class="title">int</span><span class="params">(int)</span>:</span></span><br><span class="line">      <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">          <span class="keyword">return</span> int.__sub__(self, other)</span><br><span class="line">&gt;&gt;&gt;a = int(<span class="string">'5'</span>)</span><br><span class="line">&gt;&gt;&gt;b = int(<span class="string">"3')</span></span><br><span class="line"><span class="string">&gt;&gt;a + b</span></span><br><span class="line"><span class="string">2</span></span><br></pre></td></tr></table></figure>

<p>​    当然，我这样做从逻辑上是说不过去的…我只是想跟大家说，随着学习的足够深入，Python允许你做的事情就更多、更灵活！</p>
<h4 id="12-2-2-反运算"><a href="#12-2-2-反运算" class="headerlink" title="12.2.2 反运算"></a>12.2.2 反运算</h4><p>表12-2列举了反运算相关的魔法方法。</p>
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>__radd__ (self, other)</td>
<td>定义加法的行为: +(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rsub__(self, other)</td>
<td>定义减法的行为:-(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rmul__(self, other)</td>
<td>定义乘法的行为: * (当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rtruediv__(self, other)</td>
<td>1定义真除法的行为: /(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rfloordiv__(self, other)</td>
<td>定义整数除法的行为: //(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rmod__(self, other)</td>
<td>定义取模算法的行为: %(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rdivmod__(self, other)</td>
<td>定义当被divmod()调用时的行为(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rpow__(self, other)</td>
<td>定义当被power()调用或**运算时的行为(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rlshift__(self, other)</td>
<td>定义按位左移位的行为:&lt;&lt;(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rrshift__(self, other)</td>
<td>定义按位右移位的行为: &gt;&gt;(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rand__(self, other)</td>
<td>定义按位与操作的行为: &amp;(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__rxor__(self, other)</td>
<td>定义按位异或操作的行为: ^(当左操作数不支持相应的操作时被调用)</td>
</tr>
<tr>
<td>__ror__(self, other)</td>
<td>定义按位或操作的行为: |(当左操作数不支持相应的操作时被调用)</td>
</tr>
</tbody></table>
<p>​    不难发现,这里的反运算魔法方法跟上节介绍的算术运算符保持一一对应,不同之处就是反运算的魔法方法多了一个”r”,例如,__add__()就对应__radd__(),举个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;a + b</span><br><span class="line"><span class="comment">#这里加数是a,被加数是b,请问大家:这里是a主动还是b主动?</span></span><br><span class="line"><span class="comment">#肯定是a主动,对不对?(就像"我请你吃饭"这句话,我肯定是主动,所以应该是由我给钱,但是,如果那天我刚好没带钱,那就叫蹭饭!但饭钱是一定要给的,那应该由谁来给?肯定就只能由b来给了.)</span></span><br><span class="line"><span class="comment">#那反运算是同样一个道理,如果a对象的__add__()方法没有实现或者不支持相应的操作,那么python就会自动调用b的__radd__()方法.</span></span><br><span class="line">试一下:</span><br><span class="line">&gt;&gt;&gt;<span class="class"><span class="keyword">class</span> <span class="title">Nint</span><span class="params">(int)</span>:</span></span><br><span class="line">       <span class="function"><span class="keyword">def</span> <span class="title">__radd__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> int.__sub__(other,self)</span><br><span class="line">&gt;&gt;&gt;a = Nint(<span class="number">5</span>)</span><br><span class="line">&gt;&gt;&gt;b = Nint(<span class="number">3</span>)</span><br><span class="line">&gt;&gt;&gt;a + b</span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="comment">#由于a对象默认有__add__()方法,所以b的__redd__()没有执行</span></span><br><span class="line"><span class="comment">#这样就有了:</span></span><br><span class="line">&gt;&gt;&gt;<span class="number">1</span> + b</span><br><span class="line"><span class="number">-2</span></span><br><span class="line"></span><br><span class="line">	关于反运算,这里还要注意一点:对于a + b,b的__radd__(self, other)的self是b对象,other是a对象.</span><br><span class="line">所以不能这么写:</span><br><span class="line">&gt;&gt;&gt;<span class="class"><span class="keyword">class</span> <span class="title">Nint</span><span class="params">(int)</span>:</span>.</span><br><span class="line">      <span class="function"><span class="keyword">def</span> <span class="title">__rsub__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">          <span class="keyword">return</span> int.__sub__(self, other)</span><br><span class="line">&gt;&gt;&gt;a = Nint(<span class="number">5</span>)</span><br><span class="line">&gt;&gt;&gt;<span class="number">3</span> - a</span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>​    所以对于注重操作数顺序的运算符(例如减法、除法、移位),在重写反运算魔法方法的时候,就一定要注意顺序问题了。</p>
<h4 id="12-2-3-增量赋值运算"><a href="#12-2-3-增量赋值运算" class="headerlink" title="12.2.3 增量赋值运算"></a>12.2.3 增量赋值运算</h4><p>​    Python也有大量的魔术方法可以来定制增量赋值语句,增量赋值其实就是一种偷懒的形式,它将操作符与赋值来结合起来.例如:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt;a =a + b</span><br><span class="line"><span class="comment">#写成增量赋值的形式就是:</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;a +=b</span><br></pre></td></tr></table></figure>

<h4 id="12-2-4一元操作符"><a href="#12-2-4一元操作符" class="headerlink" title="12.2.4一元操作符"></a>12.2.4一元操作符</h4><p>​    一元操作符就是只有一个操作数的意思,像a + b这样,加号左右有a、b两个操作数,叫作二元操作符。只有一个操作数的,例如把减号放在一个操作数的前边,就是取这个操作数的相反数的意思,这时候管它叫负号.<br>​    Python支持的一元操作符主要有__neg__()(表示正号行为),__pos__()(定义负号行为),__abs__() (定义当被abs()调用时的行为,就是取绝对值的意思),还有一个__invert__()(定义按位取反的行为)。</p>
<h3 id="12-3简单定制"><a href="#12-3简单定制" class="headerlink" title="12.3简单定制"></a>12.3简单定制</h3><p>基本要求：</p>
<ul>
<li><p>定制一个计时器的类。</p>
</li>
<li><p>start和stop方法代表启动计时和停止计时。</p>
</li>
<li><p>假设计时器对象t1,print(t1)和直接调用t1均显示结果。</p>
</li>
<li><p>当计时器未启动或已经停止计时,调用stop方法会给予温馨的提示。</p>
</li>
<li><p>两个计时器对象可以进行相加:t1 + t2。</p>
</li>
<li><p>只能使用提供的有限资源完成。</p>
</li>
</ul>
<p>​    这里需要限定你只能使用哪些资源,因为Python的模块是非常多的,你要是直接上网找个写好的模块进来,那就达不到锻炼的目的了.<br>  下边是演示:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;t1 = MyTimer()</span><br><span class="line">&gt;&gt;&gt;t1</span><br><span class="line">未开始计时!</span><br><span class="line">&gt;&gt;&gt;t1.stop()</span><br><span class="line">提示:请先调用start()开始计时!</span><br><span class="line">&gt;&gt; t1.start()</span><br><span class="line">计时开始…</span><br><span class="line">&gt;&gt;t1</span><br><span class="line">提示:请先调用stop()开始计时!</span><br><span class="line">&gt;&gt;&gt;t1.stop()</span><br><span class="line">计时结束!</span><br><span class="line">&gt;&gt;&gt;t1</span><br><span class="line">总共运行了<span class="number">5</span>秒</span><br><span class="line">&gt;&gt;&gt;t2 = Myrimer()</span><br><span class="line">&gt;&gt;&gt;t2.start()</span><br><span class="line">计时开始…</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t2.stop()</span><br><span class="line">计时结束!</span><br><span class="line">&gt;&gt;&gt;t2</span><br><span class="line">总共运行了<span class="number">6</span>秒</span><br><span class="line">&gt;&gt; t1 + t2</span><br><span class="line"><span class="string">'总共运行了11秒'</span></span><br></pre></td></tr></table></figure>

<p>你需要下面的资源:</p>
<ul>
<li><p>使用time模块的localtime方法获取时间(有关time模块可参考:<a href="http://bbs.fishc.com/thread-51326-1-1,html" target="_blank" rel="noopener external nofollow noreferrer">http://bbs.fishc.com/thread-51326-1-1,html</a>).</p>
</li>
<li><p>time.localtime返回struct_time的时间格式.</p>
</li>
<li><p>表现你的类:__str__()和__repr__()魔法方法.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt;<span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span><span class="string">"小甲鱼是帅哥"</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;a =A()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;print(a)</span><br><span class="line">小甲鱼是帅哥</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;a</span><br><span class="line">&lt;__main_<span class="number">_</span>.A object at <span class="number">0x03260F30</span> &gt;</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;<span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span></span><br><span class="line">      def__repr_<span class="number">_</span>(sef)<span class="symbol">:</span></span><br><span class="line">          <span class="keyword">return</span> <span class="string">"小甲鱼是帅哥"</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;b = B()</span><br><span class="line"><span class="meta">&gt;&gt;</span>b</span><br><span class="line">小甲鱼是帅哥</span><br></pre></td></tr></table></figure>

<p>有了这些知识,可以开始来编写代码了:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">import time as t </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Myrimer</span>:</span></span><br><span class="line">     <span class="comment">#开始计时</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.start = t.localtime()</span><br><span class="line">        print(<span class="string">"计时开始..."</span>)</span><br><span class="line">     <span class="comment">#停止计时</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">stop</span><span class="params">(slef)</span></span><span class="symbol">:</span></span><br><span class="line">         <span class="keyword">self</span>.stop = t.localtine()</span><br><span class="line">         print(<span class="string">"计时结束!"</span>)</span><br><span class="line"><span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">好，万丈高楼平地起，把地基写好后，应该考虑怎么进行计算了.localtime（）返回的是一个时间元组的结构，只需要前边6个元素，然后将stop的元素依次减去start对应的元素，将差值存放在一个新的列表里：</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br><span class="line"><span class="comment">#停止计时</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">stop</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">           <span class="keyword">self</span>.stop = t.localtime()</span><br><span class="line">           <span class="keyword">self</span>._calc()</span><br><span class="line">           print(<span class="string">"计时结束!"</span>)</span><br><span class="line">     <span class="comment">#内部方法,计算运行时间</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">         <span class="keyword">self</span>.lasted =[]</span><br><span class="line">         <span class="keyword">self</span>.prompt=<span class="string">"总共运行了"</span></span><br><span class="line">         <span class="keyword">for</span> index <span class="keyword">in</span>  range(<span class="number">6</span>)<span class="symbol">:</span></span><br><span class="line">             <span class="keyword">self</span>.lasted.append(<span class="keyword">self</span>.stop[index] - <span class="keyword">self</span>.start[index])</span><br><span class="line">             <span class="keyword">self</span>.prompt += str(<span class="keyword">self</span>.lasted[index])</span><br><span class="line">         print(<span class="keyword">self</span>.prompt)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;t1 = MyTimer()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;t1.start()</span><br><span class="line">计时开始…</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;t1.stop()</span><br><span class="line">总共运行了<span class="number">000003</span></span><br><span class="line">计时结束!</span><br><span class="line"><span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">已经基本实现计时功能了,接下来需要完成"</span>print(t1)和直接调用t1均显示结果<span class="string">",那就要通过重写__str__()和__repr__()魔法方法来实现:</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">self</span>.prompt</span><br><span class="line">     __repr_<span class="number">_</span> = __str_<span class="number">_</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; t1 = MyTimer()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; t1.start()</span><br><span class="line">计时开始…</span><br><span class="line"><span class="meta">&gt;&gt;</span> t1.stop()</span><br><span class="line">计时结束!</span><br><span class="line"><span class="meta">&gt;&gt;</span> t1</span><br><span class="line">总共运行了<span class="number">000002</span></span><br><span class="line">似乎做得不错了,但这里还有一些问题。假设用户不按常理出牌,问题就会很多<span class="symbol">:</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; t1 = MyTimer()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; t1</span><br><span class="line">Traceback(most recent call last)<span class="symbol">:</span></span><br><span class="line">  File<span class="string">"&lt; pyshell#11&gt;"</span>,line <span class="number">1</span>,<span class="keyword">in</span> &lt;<span class="class"><span class="keyword">module</span>&gt;</span></span><br><span class="line">    t1</span><br><span class="line">  File<span class="string">"c:\Python34\1ib\idlelib\rpc.py"</span>,line <span class="number">614</span>,<span class="keyword">in</span> displayhook </span><br><span class="line">  text = repr(value)</span><br><span class="line">File<span class="string">"C:\Users\Fishco00\Desktop\test.py"</span>,line <span class="number">5</span>,<span class="keyword">in</span> __str_<span class="number">_</span> </span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">self</span>.prompt <span class="symbol">AttributeError:</span><span class="string">"MyTimer'object has no attribute 'prompt'</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">	当直接执行t1的时候,Python会调用__str_<span class="number">_</span>()魔法方法,但它却说这个类没有prompt属性。prompt属性在哪里定义的<span class="string">?在</span>_calc()方法里定义的,对不?但是没有执行stop()方法,_calc()方法就没有被调用到,所以也就没有prompt属性的定义了。</span><br><span class="line">	要解决这个问题也很简单,大家应该还记得在类里边,用得最多的一个魔法方法是什么?</span><br><span class="line">是__init_<span class="number">_</span>()嘛,所有属于实例对象的变量只要在这里边先定义,就不会出现这样的问题了。</span><br><span class="line">...</span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">init</span> <span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">          <span class="keyword">self</span>.prompt = <span class="string">"未开始计时!"</span></span><br><span class="line">          <span class="keyword">self</span>.lasted = []</span><br><span class="line">          <span class="keyword">self</span>.start = <span class="number">0</span></span><br><span class="line">          <span class="keyword">self</span>.stop = <span class="number">0</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;</span>t1 = Myrimer()</span><br><span class="line"><span class="meta">&gt;&gt;</span>t1</span><br><span class="line">未开始计时!</span><br><span class="line"><span class="meta">&gt;&gt;</span> t1. start()</span><br><span class="line">Traceback (most recent call last)<span class="symbol">:</span></span><br><span class="line">	File <span class="string">"&lt; pyshell#2&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;<span class="class"><span class="keyword">module</span>&gt;</span></span><br><span class="line">		t1. start()</span><br><span class="line"><span class="symbol">TypeError:</span> <span class="string">'int'</span> object is <span class="keyword">not</span> callable</span><br><span class="line">	这里又出错了(当然我是故意的),大家先检查一下是什么问题?</span><br><span class="line">	其实会导致这个问题,是因犯了一个微妙的错误,这样的错误通常很容易疏忽,而且很难排查。Python这里抛出了一个异常<span class="symbol">:TypeError</span><span class="symbol">:<span class="string">'int'</span></span> object is <span class="keyword">not</span> callable。</span><br><span class="line">	仔细瞧,在调用start()方法的时候报错,也就是说,Python认为start是一个整型变量,而不是一个方法。为什么呢?大家看__init_<span class="number">_</span>()方法里,是不是也命名了一个叫作<span class="keyword">self</span>.start的变量,如果类中的方法名和属性同名,属性会覆盖方法。</span><br><span class="line">	好了,让把所有的<span class="keyword">self</span>.start和<span class="keyword">self</span>.<span class="keyword">end</span>都改为<span class="keyword">self</span>.<span class="keyword">begin</span>和<span class="keyword">self</span>.<span class="keyword">end</span>吧!</span><br><span class="line">	现在程序没问题了,但显示时间是<span class="number">000003</span>这样不大人性化,还是希望可以按照<span class="string">"年月日小时分钟秒"</span>这么去显示,然后值为<span class="number">0</span>的就不显示啦,这样才是人看的嘛,对不对?!所以这里添加一个列表用来存放对应的单位：</span><br><span class="line">...</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">		<span class="keyword">self</span>.unit =[<span class="string">'年'</span>,<span class="string">'月'</span>,<span class="string">'天'</span>,<span class="string">'小时'</span>,<span class="string">'分钟'</span>,<span class="string">'秒'</span>]</span><br><span class="line">		<span class="keyword">self</span>.prompt =<span class="string">"未开始计时!"</span></span><br><span class="line">		<span class="keyword">self</span>.lasted =[]</span><br><span class="line">		<span class="keyword">self</span>.beginoself.<span class="keyword">end</span> =<span class="number">0</span></span><br><span class="line">	<span class="comment">#计算运行时间</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">_calc</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">		<span class="keyword">self</span>.lasted =[]</span><br><span class="line">		<span class="keyword">self</span>.prompt=<span class="string">"总共运行了"</span></span><br><span class="line">		<span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">6</span>)<span class="symbol">:</span></span><br><span class="line">			<span class="keyword">self</span>.lasted.append(<span class="keyword">self</span>.<span class="keyword">end</span> index]-<span class="keyword">self</span>.<span class="keyword">begin</span>[index])</span><br><span class="line">			<span class="keyword">if</span> <span class="keyword">self</span>.lasted[index]<span class="symbol">:</span></span><br><span class="line">				<span class="keyword">self</span>.prompt +=(str(<span class="keyword">self</span>.lasted[index]) + <span class="keyword">self</span>.unit[index])</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;</span>t1 =Myrimer()</span><br><span class="line"><span class="meta">&gt;&gt;</span>t1.start()</span><br><span class="line">计时k开始...</span><br><span class="line">&gt; t1.stop()</span><br><span class="line">计时结束!</span><br><span class="line"><span class="meta">&gt;&gt;</span>t1</span><br><span class="line">总共运行了<span class="number">2</span>秒</span><br><span class="line"></span><br><span class="line">然后在适当的地方增加温馨提示<span class="symbol">:</span></span><br></pre></td></tr></table></figure>

</li>
</ul>

    </div>

    
    
    
      

        <div class="reward-container">
  <div>赞赏一下吧～</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="tongsiying 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>tongsiying
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://tongsiying.github.io/2008/01/04/python/2008-01-04-python-fishc/" title="python-fishc">https://tongsiying.github.io/2008/01/04/python/2008-01-04-python-fishc/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener external nofollow noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/python-fishc/" rel="tag"># python-fishc</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2008/01/04/collect/collect_English/2007-01-17-English-%E6%96%B0%E6%A6%82%E5%BF%B5%E8%8B%B1%E8%AF%AD/" rel="prev" title="新概念英语">
      <i class="fa fa-chevron-left"></i> 新概念英语
    </a></div>
      <div class="post-nav-item">
    <a href="/2008/01/04/robootframework/2008-01-04-RobootFramework-%E7%8E%AF%E5%A2%83/" rel="next" title="RobootFramework-环境">
      RobootFramework-环境 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#FISHC-note"><span class="nav-text">FISHC-note</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第12章-魔法方法"><span class="nav-text">第12章 魔法方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#12-1-构造和析构"><span class="nav-text">12.1 构造和析构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#12-1-1-init-self"><span class="nav-text">12.1.1 _init_ (self[,..])</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-1-2-new-cls-…"><span class="nav-text">12.1.2 _new_(cls[,…])</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-1-3-del-self"><span class="nav-text">12.1.3 __del__(self)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-2-算数运算"><span class="nav-text">12.2 算数运算</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#12-2-1-算数运算"><span class="nav-text">12.2.1 算数运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-2-2-反运算"><span class="nav-text">12.2.2 反运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-2-3-增量赋值运算"><span class="nav-text">12.2.3 增量赋值运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-2-4一元操作符"><span class="nav-text">12.2.4一元操作符</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-3简单定制"><span class="nav-text">12.3简单定制</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="tongsiying"
      src="/images/gutianle.gif">
  <p class="site-author-name" itemprop="name">tongsiying</p>
  <div class="site-description" itemprop="description">问渠那得清如许？为有源头活水来。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">427</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">46</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/tongsiying" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tongsiying" rel="noopener external nofollow noreferrer" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wxtlucky1015@163.com" title="E-Mail → mailto:wxtlucky1015@163.com" rel="noopener external nofollow noreferrer" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/2964109344" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;2964109344" rel="noopener external nofollow noreferrer" target="_blank"><i class="weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/" title="tongsiying → https:&#x2F;&#x2F;tongsiying.github.io"><i class="wrench fa-fw"></i>tongsiying</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/ReadingNotes/" title="ReadingNotes → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;ReadingNotes&#x2F;"><i class="book fa-fw"></i>ReadingNotes</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/blog/" title="blog → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;blog&#x2F;"><i class="book fa-fw"></i>blog</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/blog/tools/" title="tools → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;blog&#x2F;tools&#x2F;"><i class="wrench fa-fw"></i>tools</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/lanlan/" title="lanlan → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;lanlan&#x2F;"><i class="wrench fa-fw"></i>lanlan</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/Music/" title="note → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;Music&#x2F;"><i class="wrench fa-fw"></i>note</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/sound/" title="Music → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;sound&#x2F;"><i class="wrench fa-fw"></i>Music</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/JSONFormat/" title="JSONFormat → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;JSONFormat&#x2F;"><i class="wrench fa-fw"></i>JSONFormat</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/HTML5-Canvas/" title="Canvas → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;HTML5-Canvas&#x2F;"><i class="wrench fa-fw"></i>Canvas</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/games/" title="games → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;games&#x2F;"><i class="wrench fa-fw"></i>games</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://tongsiying.github.io/love/" title="love → https:&#x2F;&#x2F;tongsiying.github.io&#x2F;love&#x2F;"><i class="wrench fa-fw"></i>love</a>
      </span>
  </div>



		<div style="">
  <canvas id="canvas" style="width:60%;">��ǰ�������֧��canvas������������������</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //����canvas�Ŀ���
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //�洢ʱ������
    var data = [];
    //�洢�˶���С��
    var balls = [];
    //�������Ӱ뾶
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //�洢ʱ�����֣���ʮλСʱ����λСʱ��ð�š�ʮλ���ӡ���λ���ӡ�ð�š�ʮλ���ӡ���λ������7���������
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*���ɵ�������*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*����ʱ��*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //ʱ�䷢���仯
            if(NewData[i] !== data[i]){
                //���仯������ֵ����data�����е������洢��changeNumArray������
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //����С��
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*����С��״̬*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*����Ҫ�˶���С��*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*��Ⱦ*/
    function render(){
        //���û������ȣ��ﵽ��ջ�����Ч��
        canvas.height = 100;
        //��Ⱦʱ��
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //��ȾС��
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //����ʱ��
        updateDigitTime();
        //����С��״̬
        updateBalls();
        //��Ⱦ
        render();
    },50);
}

})();
</script>
      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; Weeny – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tongsiying</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">6.3m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">95:46</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
